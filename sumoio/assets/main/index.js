System.register("chunks:///_virtual/GameRoot.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./audioManager.ts"],(function(e){"use strict";var o,t,n,i,r,a,c,u,s,l,p,d;return{setters:[function(e){o=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.defineProperty,i=e.assertThisInitialized,r=e.initializerDefineProperty},function(e){a=e.cclegacy,c=e._decorator,u=e.AudioSource,s=e.assert,l=e.game,p=e.Component},function(e){d=e.audioManager}],execute:function(){var f,h,y,m,g;a._RF.push({},"03e874h6DpBPomHhbFiHlox","GameRoot",void 0);var _=c.ccclass,v=c.property;e("GameRoot",(f=_("GameRoot"),h=v(u),f((g=o((m=function(e){function o(){for(var o,t=arguments.length,a=new Array(t),c=0;c<t;c++)a[c]=arguments[c];return o=e.call.apply(e,[this].concat(a))||this,n(i(o),"currentMap",""),r(i(o),"_audioSource",g,i(o)),o}t(o,e);var a=o.prototype;return a.onLoad=function(){var e=this.getComponent(u);s(e),this._audioSource=e,l.addPersistRootNode(this.node),d.instance.init(this._audioSource)},a.onEnable=function(){d.instance.playMusic(!0),d.instance.checkSound()},o}(p)).prototype,"_audioSource",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=m))||y));a._RF.pop()}}}));

System.register("chunks:///_virtual/encryption.ts",["cc"],(function(n){"use strict";var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"05d34cw5uBCfKa2HOC2O8hS","encryption",void 0);n("encryption",{jkldjs:[],hgsdg:[],outyou:function(n){return n+100},hiosdhfoe:function(n){return n+79156},dsafger:function(n){return 2*n},eryewry:function(n){return n-50},d:function(n){return 4*n},eijwuioewj:function(n){return n+3681},kryr:function(n){return n+2},rqewrqwe:function(n){return n-3},mnkdshfo:function(n){return n-46218},sedryerw:function(n){return 2*n},kuyto:function(n){return n+15},dsgwer:function(n){return n-6},j:function(n){return n-9},iuyi567:function(n){return n-100},ioeks:function(n){return n+91},qoiwhdksh:function(n){return n-7613},wqterwt:function(n){return n+1575},klilot:function(n){return n-325},ewtrey5er:function(n){return n-3481},utertyur:function(n){return n+6848},sdfyery:function(n){return n-45},ikuyiyt:function(n){return n+26},euwhsdn:function(n){return n-81},sdrfyer:function(n){return 3*n},hduy:function(n){return n+5},jghity:function(n){return n-6515},getInfo:function(n,t,r){this.dfdsfds();var u=this.fdsfdsfnb(n),e=this.lkdsjgd();this.dfdsfds();var i=this.fdsfdsfnb(t),f=this.lkdsjgd();return{number_0:1,number_1:u,number_2:i,number_3:this.fdsfdsfnb(r),number_4:e,number_5:f,number_6:this.lkdsjgd()}},yrw6yery:function(n){return n+1231},kghty:function(n){return n-45356},dsgreger:function(n){return n+35648},uertdfh:function(n){return n-3549},hjkdnfds:function(n){return n-985},beryerw:function(n){return n+8481},ijlhfew:function(n){return n+874},gdfsr3t:function(n){return n-9895},greger:function(n){return 2*n},kgigi:function(n){return n+17},khdfkjsdhfk:function(n){return n+28},dfdsfew:function(n){return n+17},dfger:function(n){return n+14},thrthfgh:function(n){return n+8},etygdg:function(n){return n+13},sdfdsgd:function(){var n=this.kgigi(0);return n=this.khdfkjsdhfk(n),n=this.dfdsfew(n),n=this.dfger(n),n=this.thrthfgh(n),n=this.etygdg(n)},fdsjfhw:function(n,t){var r=t-n,u=Math.random();return n+Math.round(u*r)},ehfjkeshfkds:function(n,t){return 1==t?this.hduy(n):2==t?this.ioeks(n):3==t?this.ijlhfew(n):4==t?this.eijwuioewj(n):5==t?this.hiosdhfoe(n):6==t?this.euwhsdn(n):7==t?this.hjkdnfds(n):8==t?this.qoiwhdksh(n):9==t?this.mnkdshfo(n):void 0},sdhkas:function(){},dfdsfds:function(){this.hgsdg=[],this.hgsdg.push("1");for(var n=1;n<10;n++){var t=this.fdsjfhw(1,9);this.hgsdg.push(t+"")}},encryption:function(n){return n},fdsfdsfnb:function(n){for(var t=1;t<10;t++){var r=parseInt(this.hgsdg[t]);n=this.ehfjkeshfkds(n,r)}return n*this.sdfdsgd()},lkdsjgd:function(){for(var n="",t=9;t>0;t--)n+=this.hgsdg[t];return parseInt(n)}});t._RF.pop()}}}));

System.register("chunks:///_virtual/poolManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,o,n,i,r,a;return{setters:[function(t){e=t.defineProperty,o=t.createClass},function(t){n=t.cclegacy,i=t._decorator,r=t.instantiate,a=t.NodePool}],execute:function(){var c,s,l;n._RF.push({},"07b4eDnPw1IYJCIJkfrfyf/","poolManager",void 0);var u=i.ccclass;i.property,t("poolManager",u("poolManager")((l=s=function(){function t(){e(this,"dictPool",{}),e(this,"dictPrefab",{})}var n=t.prototype;return n.getNode=function(t,e){var o,n=t.data.name;if(this.dictPrefab[n]=t,this.dictPool.hasOwnProperty(n)){var i=this.dictPool[n];o=i.size()>0?i.get():r(t)}else{var c=new a;this.dictPool[n]=c,o=r(t)}return o.parent=e,o},n.putNode=function(t){var e=t.name,o=null;this.dictPool.hasOwnProperty(e)?o=this.dictPool[e]:(o=new a,this.dictPool[e]=o),o.put(t)},n.clearPool=function(t){this.dictPool.hasOwnProperty(t)&&this.dictPool[t].clear()},o(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(),e(s,"_instance",void 0),c=l))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/Sumo.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var o,n,r,e;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,e=t.Component}],execute:function(){var u;n._RF.push({},"0fdf8q6ZkdKKqNd//UiftTG","Sumo",void 0);var c=r.ccclass;r.property,t("Sumo",c("Sumo")(u=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var r=n.prototype;return r.start=function(){},r.touchStart=function(t){},r.getSumoNode=function(){return this.node},n}(e))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,n,s;return{setters:[function(t){e=t.defineProperty,r=t.createClass},function(t){n=t.cclegacy,s=t._decorator}],execute:function(){var a,i,o;n._RF.push({},"14c80WePKxM2pEgOSPVgmyZ","ConfigManager",void 0);var c=s.ccclass;t("ConfigManager",c("ConfigManager")((o=i=function(){function t(){e(this,"_config",null),e(this,"_template",null),e(this,"errorlist",[])}var n=t.prototype;return n.parseObject=function(t,e){var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=t[n],a=e[n];typeof s!=typeof a&&this.errorlist.push({server:t,template:e}),r[n]=s instanceof Array?this.parseArray(s,a):s instanceof Object?this.parseObject(s,a):s}return r},n.parseArray=function(t,e){for(var r=[],n=0;n<t.length;n++){var s=t[n],a=e[n];if(typeof s!=typeof a&&this.errorlist.push({server:t,template:e}),s instanceof Array){var i=this.parseArray(s,a);r.push(i)}else if(s instanceof Object){var o=this.parseObject(s,a);r.push(o)}else r.push(s)}return r},r(t,[{key:"template",get:function(){return this._template},set:function(t){null==t&&null==t||(this._template=JSON.parse(t))}},{key:"config",get:function(){return this._config},set:function(t){try{if(null==this._template)throw new Error("Template config data can not be null call function setTemplate(arg) before");this.errorlist=[],this._config={};var e=JSON.parse(t);for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=e[r],s=this._template[r];typeof n!=typeof s&&this.errorlist.push({server:n,template:s}),this._config[r]=n instanceof Array?this.parseArray(n,s):n instanceof Object?this.parseObject(n,s):n}if(this.errorlist.length>0)throw console.log("\n"),console.log(this.errorlist),new Error("Data type mismatch found in server data and template data")}catch(t){console.log(t)}console.log("Data check complete")}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(),e(i,"_instance",void 0),a=o))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/MenuController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./mxManager.ts","./constant.ts","./audioManager.ts","./GameStateTrigger.ts","./SocketConnection.ts"],(function(e){"use strict";var t,i,n,a,o,r,s,l,u,c,h,m,d,g,p,y,C,N,T,f,M,_,S,A,E,b,B,v,w,P,L,O;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.initializerDefineProperty,n=e.inheritsLoose,a=e.defineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,l=e.Material,u=e.Prefab,c=e.Node,h=e.SpriteFrame,m=e.Label,d=e.director,g=e.macro,p=e.game,y=e.Animation,C=e.instantiate,N=e.Vec3,T=e.MeshRenderer,f=e.randomRange,M=e.SkeletalAnimationComponent,_=e.systemEvent,S=e.SystemEvent,A=e.Sprite,E=e.Color,b=e.Component},function(e){B=e.MxManager},function(e){v=e.constant},function(e){w=e.audioManager},function(e){P=e.GameStateTrigger},function(e){L=e.SocketConnection,O=e.SocketListener}],execute:function(){var k,G,R,D,U,I,z,x,H,F,Y,J,W,X,Z,j,q,V,K,Q,$,ee,te,ie,ne,ae,oe,re,se,le,ue,ce,he,me,de,ge,pe,ye,Ce,Ne,Te;r._RF.push({},"16e06lwqwJFjJauKigdojGv","MenuController",void 0);var fe=s.ccclass,Me=s.property,_e=e("Character",(k=fe("Character"),G=Me(l),k((U=t((D=function(){i(this,"characterMaterial",U,this)}).prototype,"characterMaterial",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=D))||R)),Se=e("food",(I=fe("food"),z=Me(u),I((F=t((H=function(){i(this,"foodNode",F,this)}).prototype,"foodNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=H))||x));e("MenuController",(Y=fe("MenuController"),J=Me(u),W=Me({type:c}),X=Me({type:c}),Z=Me({type:_e}),j=Me({type:Se}),q=Me({type:c}),V=Me({type:c}),K=Me({type:c}),Q=Me({type:c}),$=Me({type:h}),ee=Me({type:h}),te=Me({type:l}),ie=Me({type:l}),ne=Me({type:m}),Y((re=t((oe=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,a(o(t),"startLoc",void 0),a(o(t),"startX",void 0),a(o(t),"startY",void 0),a(o(t),"startZ",void 0),i(o(t),"characterNode",re,o(t)),i(o(t),"playerNode",se,o(t)),i(o(t),"foodNode",le,o(t)),i(o(t),"character",ue,o(t)),i(o(t),"food",ce,o(t)),i(o(t),"shopNode",he,o(t)),i(o(t),"threedNode",me,o(t)),i(o(t),"missionNode",de,o(t)),i(o(t),"soundNode",ge,o(t)),i(o(t),"soundOff",pe,o(t)),i(o(t),"soundOn",ye,o(t)),i(o(t),"menuMaterial",Ce,o(t)),i(o(t),"shopMaterial",Ne,o(t)),a(o(t),"sumo",null),a(o(t),"playerData",{character:-1,bag:-1,headPhone:-1,goggles:-1,target:0,food:-1}),a(o(t),"ShopMenu",null),i(o(t),"waitingText",Te,o(t)),a(o(t),"previousAnimation",0),a(o(t),"animationTimeOut",null),a(o(t),"showLogoTimeOut",null),a(o(t),"showLogoAnimationTimeOut",null),t}n(t,e);var r=t.prototype;return r.onLoad=function(){var e=this;P.sendGameState(P.EventType.Game_Play_Launched.key,P.EventType.Game_Play_Launched.reason),B.instance.isMiloApp?(L.instance.send({command:"CLIENT_LOADED",data:{msg:"Client loaded sucessfully"}}),this.waitingText.string="Waiting for other users",L.instance.on(O.ON_WAIT_TIME,(function(t){e.waitingText.string="Game Starts in "+t}),this),L.instance.on(O.GAME_STARTED,(function(t){P.sendGameState(P.EventType.Game_Play_Ready_To_Launch.key,P.EventType.Game_Play_Ready_To_Launch.reason),clearTimeout(e.animationTimeOut),d.loadScene("GameScene")}),this)):this.waitingText.string="",g.ENABLE_MULTI_TOUCH=!1,d.preloadScene("GameScene"),this.checkSounds(),this.ShopMenu=this.shopNode.getComponent("ShopMenu"),this.ShopMenu.initialise(this),this.addMenuCharacter(),v.CURRENTSTATE=v.GAMESTATE.MAINMENU,p.on("commonEventInterface",(function(t){B.instance.isMiloApp||"backPressed"==t&&(v.CURRENTSTATE==v.GAMESTATE.MAINMENU?e.showExitPopup():v.CURRENTSTATE==v.GAMESTATE.MAINMENUSHOP?e.ShopMenu.onSopBackButtonClick():v.CURRENTSTATE==v.GAMESTATE.MAINMENUSHOPBUY&&e.ShopMenu.onBuyClosed())}),this),this.showLogoTimeOut=setTimeout((function(){e.node.getComponent(y).play("showLogo"),e.showLogoAnimationTimeOut=setTimeout((function(){e.node.getComponent(y).play("animateLogo")}),1e4)}),1e3),null!=window.localStorage.getItem("currentLevel")&&null!=window.localStorage.getItem("currentLevel")||window.localStorage.setItem("currentLevel","0")},r.addMenuCharacter=function(){var e=JSON.stringify(this.playerData);window.localStorage.setItem("playerData",e),this.playerData=JSON.parse(e);var t=-1==this.playerData.character?0:this.playerData.character,i=C(this.characterNode);this.playerNode.addChild(i),i.setPosition(new N(0,0,0)),i.getChildByName("Penguine_Anim").getChildByName("penguin_body01").getComponent(T).setMaterial(this.character[t].characterMaterial,0),this.sumo=i,this.setPlayerUI()},r.startAnimation=function(){for(var e=this,t=Math.floor(f(0,4));t==this.previousAnimation;)t=Math.floor(f(0,4));this.previousAnimation=t;var i=0,n=this.sumo.getChildByName("Penguine_Anim").getComponent(M);switch(this.previousAnimation){case 0:n.play("idle"),i=n.getState("idle").duration;break;case 1:n.play("win"),i=n.getState("win").duration;break;case 2:n.play("powerLose"),i=n.getState("powerLose").duration;break;case 3:n.play("push"),i=n.getState("push").duration}clearTimeout(this.animationTimeOut),this.animationTimeOut=setTimeout((function(){e.startAnimation()}),1e3*i)},r.setPlayerUI=function(){this.startAnimation(),this.playerData.bag>=0?(this.sumo.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").active=!0,this.sumo.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").getComponent(T).setMaterial(this.ShopMenu.bagAcceesories[this.playerData.bag].material,0)):this.sumo.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").active=!1,this.playerData.headPhone>=0?(this.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").active=!0,this.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").getComponent(T).setMaterial(this.ShopMenu.headPhoneAcceesories[this.playerData.headPhone].material,0)):this.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").active=!1,this.playerData.goggles>=0?(this.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").active=!0,this.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").getComponent(T).setMaterial(this.ShopMenu.gogglesAcceesories[this.playerData.goggles].material,0)):this.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").active=!1,this.playerData.target>=0?(this.sumo.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").active=!0,this.sumo.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").getComponent(T).setMaterial(this.ShopMenu.targetAcceesories[this.playerData.target].material,0)):this.sumo.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").active=!1},r.start=function(){P.sendGameState(P.EventType.Game_Waiting_In_Lobby.key,P.EventType.Game_Waiting_In_Lobby.reason),_.on(S.EventType.TOUCH_START,this.touchStart,this),_.on(S.EventType.TOUCH_MOVE,this.touchMove,this)},r.touchStart=function(e){this.startLoc=e.getLocation(),this.startX=this.sumo.rotation.getEulerAngles(new N).x,this.startY=this.sumo.rotation.getEulerAngles(new N).y,this.startZ=this.sumo.rotation.getEulerAngles(new N).z},r.touchMove=function(e){var t=e.getLocationX(),i=e.getLocationY(),n=this.startLoc.x+t,a=this.startLoc.y+i;this.sumo.setRotationFromEuler(this.sumo.eulerAngles.x,this.startZ+n,this.sumo.eulerAngles.z),this.foodNode.setRotationFromEuler(this.startY+a,this.startZ+n,0)},r.startGame=function(){this.node.getChildByName("MainButton").getChildByName("playButton").active=!1,this.node.getChildByName("MainButton").getChildByName("shopButton").active=!1,this.node.getChildByName("MainButton").getChildByName("missionButton").active=!1,this.node.getChildByName("MainButton").getChildByName("loadingNode").active=!0,this.node.getChildByName("MainButton").getChildByName("loadingNode").getComponent(y).play("penquRun"),w.instance.playSound(v.AUDIO_SOUND.buttonClick),clearTimeout(this.animationTimeOut),clearTimeout(this.showLogoTimeOut),clearTimeout(this.showLogoAnimationTimeOut),B.instance.isMiloApp?L.instance.send({command:"CLIENT_READY",data:this.playerData}):(P.sendGameState(P.EventType.Game_Play_Ready_To_Launch.key,P.EventType.Game_Play_Ready_To_Launch.reason),d.loadScene("GameScene"))},r.onShopClick=function(){v.CURRENTSTATE=v.GAMESTATE.MAINMENUSHOP,clearTimeout(this.showLogoAnimationTimeOut),w.instance.playSound(v.AUDIO_SOUND.buttonClick),this.threedNode.getChildByName("bg").getComponent(T).setMaterial(this.shopMaterial,0),this.node.getComponent(y).play("shopOpen"),this.ShopMenu.addCharacterScrollContent(),clearTimeout(this.animationTimeOut);var e=this.sumo.getChildByName("Penguine_Anim").getComponent(M);e.play("walk"),setTimeout((function(){e.play("idle")}),500)},r.checkSounds=function(){v.CheckSoundEnabled()?(this.soundNode.getComponent(A).spriteFrame=this.soundOn,this.missionNode.getComponent(A).color=E.GREEN):(this.soundNode.getComponent(A).spriteFrame=this.soundOff,this.missionNode.getComponent(A).color=E.RED)},r.onMissionClicked=function(){w.instance.toggleGameSound(),this.checkSounds()},r.showExitPopup=function(){v.CURRENTSTATE=v.GAMESTATE.MAINMENUEXIT,this.node.getChildByName("exitPopup").active=!0},r.onExitYesClicked=function(){v.callGameOver(0,!0,!1),B.instance.isMiloApp&&L.instance.quitGame()},r.onExitNoClicked=function(){v.CURRENTSTATE=v.GAMESTATE.MAINMENU,this.node.getChildByName("exitPopup").active=!1},r.onSideClicked=function(){},r.onDestroy=function(){_.off(S.EventType.TOUCH_START,this.touchStart,this),_.off(S.EventType.TOUCH_MOVE,this.touchMove,this)},r.botMinSizeEnded=function(e){console.log("onTextChanged"),window.localStorage.setItem(e.node.name,e.string)},t}(b)).prototype,"characterNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(oe.prototype,"playerNode",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(oe.prototype,"foodNode",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(oe.prototype,"character",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ce=t(oe.prototype,"food",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),he=t(oe.prototype,"shopNode",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=t(oe.prototype,"threedNode",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(oe.prototype,"missionNode",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=t(oe.prototype,"soundNode",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=t(oe.prototype,"soundOff",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(oe.prototype,"soundOn",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(oe.prototype,"menuMaterial",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ne=t(oe.prototype,"shopMaterial",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=t(oe.prototype,"waitingText",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=oe))||ae));r._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,n,s;return{setters:[function(e){t=e.defineProperty},function(e){n=e.cclegacy,s=e._decorator}],execute:function(){var i;n._RF.push({},"2680bDo3khI/pPRcB0pUuIo","EventManager",void 0);var r=s.ccclass;e("EventManager",r("EventManager")(i=function(){function e(){t(this,"events",{})}var n=e.prototype;return n.addListener=function(e,t){return"function"!=typeof t?(console.error("The listener callback must be a function, the given type is "+typeof t),!1):"string"!=typeof e?(console.error("The event name must be a string, the given type is "+typeof e),!1):(void 0===this.events[e]&&(this.events[e]={listeners:[]}),void this.events[e].listeners.push(t))},n.removeListener=function(e,t){if(void 0===this.events[e])return console.warn("This event: "+e+" does not exist"),!1;this.events[e].listeners=this.events[e].listeners.filter((function(e){return e.toString()!==t.toString()}))},n.dispatch=function(e,t){if(void 0===this.events[e])return console.warn("This event: "+e+" does not exist"),!1;this.events[e].listeners.forEach((function(e){e(t)}))},e}())||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/Gummy.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var r,e,n,o,i,u,c;return{setters:[function(t){r=t.inheritsLoose,e=t.defineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,i=t._decorator,u=t.Quat,c=t.Component}],execute:function(){var s;o._RF.push({},"2be5eRvXYVF0LgrrJn5x1sj","Gummy",void 0);var a=i.ccclass;i.property,t("Gummy",a("Gummy")(s=function(t){function o(){for(var r,o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return r=t.call.apply(t,[this].concat(i))||this,e(n(r),"currAngle",1),r}r(o,t);var i=o.prototype;return i.start=function(){},i.update=function(t){var r=u.rotateY(new u(0,0,0,0),this.node.rotation,this.currAngle*Math.PI/180);this.node.rotation=r},o}(c))||s);o._RF.pop()}}}));

System.register("chunks:///_virtual/foodSkins.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./constant.ts","./audioManager.ts"],(function(e){"use strict";var t,o,i,r,n,s,l,a,h,d,p,u,c,m,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,n=e.defineProperty},function(e){s=e.cclegacy,l=e._decorator,a=e.SpriteFrame,h=e.Sprite,d=e.Label,p=e.instantiate,u=e.Vec3,c=e.Component},function(e){m=e.constant},function(e){C=e.audioManager}],execute:function(){var f,y,N,g,v,F,k;s._RF.push({},"34c0a1tj5NCc5aFkjL+L1vl","foodSkins",void 0);var S=l.ccclass,E=l.property;e("FoodSkins",(f=S("FoodSkins"),y=E({type:a}),N=E({type:a}),f((F=t((v=function(e){function t(){for(var t,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return t=e.call.apply(e,[this].concat(s))||this,i(r(t),"defaultFrame",F,r(t)),i(r(t),"normalFrame",k,r(t)),n(r(t),"skinName",null),n(r(t),"count",null),n(r(t),"isActive",!0),n(r(t),"isEquipped",!1),n(r(t),"shopController",null),n(r(t),"type",null),n(r(t),"currentIndex",0),t}o(t,e);var s=t.prototype;return s.start=function(){},s.initialiseData=function(e,t,o){this.shopController=o;var i=this.shopController.menuController.playerData;if(this.currentIndex=t,this.type=m.ACCESSORIESTYPE.FOOD,t==m.getFood().length)return this.isActive=!1,this.count=t,this.node.getChildByName("image").getComponent(h).spriteFrame=this.defaultFrame,void(this.node.getChildByName("commingSoon").active=!0);this.isEquipped=!1,this.isActive=e.unlocked,this.count=t,this.skinName=e.name,-1==i.food&&0==this.count&&(this.isEquipped=!0),e.unlocked||(this.node.getChildByName("lockIcon").active=!0),this.node.getChildByName("name").getComponent(d).string=this.skinName;var r=p(this.shopController.menuController.food[this.count].foodNode);if(this.node.getChildByName("Plane").getChildByName("characterNode").addChild(r),r.setPosition(new u(0,0,0)),"Snapper"==this.skinName&&r.setRotationFromEuler(90,0,0),i.food==this.count&&(this.isEquipped=!0),this.node.getChildByName("equipped").active=this.isEquipped,this.isEquipped){var n=p(this.shopController.menuController.food[this.count].foodNode);this.shopController.menuController.playerNode.getChildByName("foodNode").addChild(n),"Snapper"==this.skinName&&this.shopController.menuController.playerNode.getChildByName("foodNode").setRotationFromEuler(90,0,0)}},s.onEquipClicked=function(){if(this.isActive){if(this.isEquipped)return;C.instance.playSound(m.AUDIO_SOUND.buttonClick),this.shopController.updatePlayerAccessoriesData(5,this.count),this.node.getChildByName("equipped").active=!0,this.shopController.menuController.playerNode.getChildByName("foodNode").removeAllChildren();var e=p(this.shopController.menuController.food[this.count].foodNode);this.shopController.menuController.playerNode.getChildByName("foodNode").addChild(e);for(var t=0;t<this.shopController.characterFoodArray.length;t++){var o=this.shopController.characterFoodArray[t].getComponent("FoodSkins");this.shopController.characterFoodArray[t]!=this.node&&(o.isEquipped=!1,this.shopController.characterFoodArray[t].getChildByName("equipped").active=!1)}this.isEquipped=!this.isEquipped}else this.shopController.onShowBuyPopup(this)},t}(c)).prototype,"defaultFrame",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(v.prototype,"normalFrame",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=v))||g));s._RF.pop()}}}));

System.register("chunks:///_virtual/csvManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,r,n;return{setters:[function(e){t=e.defineProperty},function(e){r=e.cclegacy,n=e._decorator}],execute:function(){var i;r._RF.push({},"3681eWu0OFKpLrMuVi+8FnM","csvManager",void 0);var s=n.ccclass,u=[",",";","\t","|","^"],a=["\r\n","\r","\n"],o=function(e,t,r,n){return r instanceof Array?"number"===r[t]?Number(n[t]):"boolean"===r[t]?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:isNaN(Number(e))?"false"==e||"true"==e||"t"==e||"f"==e?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:Number(n[t])},l={STANDARD_DECODE_OPTS:{skip:0,limit:!1,header:!1,cast:!1,comment:""},STANDARD_ENCODE_OPTS:{delimiter:u[0],newline:a[0],skip:0,limit:!1,header:!1},quoteMark:'"',doubleQuoteMark:'""',quoteRegex:/"/g,opts:{},assign:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Array.prototype.slice.call(arguments);for(var n=t[0],i=t.slice(1),s=0,u=i.length;s<u;s++)for(var a in i[s])n[a]=i[s][a];return n},map:function(e,t){for(var r=[],n=0,i=e.length;n<i;n++)r[n]=t(e[n],n);return r},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},getLimit:function(e,t){return!1===e?t:1},buildObjectConstructor:function(e,t,r){return function(n){var i={},s=function(e,t){return i[e]=t};return r?e.forEach((function(e,i){s(e,o(t[i],i,r,n))})):e.forEach((function(e,r){s(e,o(t[r],r,null,n))})),i}},buildArrayConstructor:function(e,t,r){return function(n){var i=new Array(t.length),s=function(e,t){return i[e]=t};return r?e.forEach((function(e,i){s(e,o(t[i],i,r,n))})):e.forEach((function(e,r){s(e,o(t[r],r,null,n))})),i}},frequency:function(e,t,r){void 0===r&&(r=!1);for(var n=0,i=0,s=this.getLimit(r,e.length);i<s&&-1!==(i=e.indexOf(t,i));)i+=1,n++;return n},mostFrequent:function(e,t,r){for(var n="",i=t.length-1;i>=0;i--)this.frequency(e,t[i],r)>0&&(n=t[i]);return n||t[0]},unsafeParse:function(e,t,r){var n,i,s=e.split(t.newline);function u(e){var r=e.shift();if(r.indexOf('"')>=0){for(var n=0,i=0,s=0;e.length>0&&(-1!==(n=r.indexOf('"',i))||s%2!=0);)-1!==n?(i=n+1,s++):r=r+t.newline+e.shift();var u,a=[],o=0,l=0,c=0,h=r.length;for(var f in r)if(r.hasOwnProperty(f)){var d=parseInt(f),p=r[f];0===d&&'"'===p&&(o++,l=1),'"'===p&&(o++,r[d-1]===t.delimiter&&l===d&&l++),'"'===p&&o%2==0&&(r[d+1]!==t.delimiter&&d+1!==h||(c=d,u=r.substring(l,c),a.push(u),c=l=c+2)),p===t.delimiter&&o%2==0&&((c=d)>l?(u=r.substring(l,c),a.push(u),c=l=c+1):c===l&&(a.push(""),c=l=c+1))}return(c=h)>=l&&(u=r.substring(l,c),a.push(u)),a}return r.split(t.delimiter)}for(t.skip>0&&s.splice(t.skip),t.header?(!0===t.header?(t.comment=u(s),t.cast=u(s),n=u(s)):"Array"===this.getType(t.header)&&(n=t.header),i=this.buildObjectConstructor(n,s[0].split(t.delimiter),t.cast)):i=this.buildArrayConstructor(n,s[0].split(t.delimiter),t.cast);s.length>0;){var a=u(s);a.length>1&&r(i(a),n[0])}return!0},safeParse:function(e,t){var r=t.newline,n=e.split(r);return t.skip>0&&n.splice(t.skip),!0},encodeCells:function(e,t,r){for(var n=e.slice(0),i=0,s=n.length;i<s;i++)-1!==n[i].indexOf(this.quoteMark)&&(n[i]=n[i].replace(this.quoteRegex,this.doubleQuoteMark)),-1===n[i].indexOf(t)&&-1===n[i].indexOf(r)||(n[i]=this.quoteMark+n[i]+this.quoteMark);return n.join(t)},encodeArrays:function(e,t,r){var n=t.delimiter,i=t.newline;t.header&&"Array"===this.getType(t.header)&&r(this.encodeCells(t.header,n,i));for(var s=0,u=this.getLimit(t.limit,e.length);s<u;s++)r(this.encodeCells(e[s],n,i));return!0},encodeObjects:function(e,t,r){var n=t.delimiter,i=t.newline,s=[],u=[];for(var a in e[0])s.push(a),u.push(e[0][a]);!0===t.header?r(this.encodeCells(s,n,i)):"Array"===this.getType(t.header)&&r(this.encodeCells(t.header,n,i)),r(this.encodeCells(u,n,"\n"));for(var o=1,l=this.getLimit(t.limit,e.length);o<l;o++){u=[];for(var c=0,h=s.length;c<h;c++)u.push(e[o][s[c]]);r(this.encodeCells(u,n,i))}return!0},parse:function(e,t,r){var n=[];if("Function"===this.getType(t)?(r=t,t={}):"Function"!==this.getType(r)&&(r=n.push.bind(n)),t=this.assign({},this.STANDARD_DECODE_OPTS,t),this.opts=t,!t.delimiter||!t.newline){var i=Math.min(48,Math.floor(e.length/20),e.length);t.delimiter=t.delimiter||this.mostFrequent(e,u,0!==i),t.newline=t.newline||this.mostFrequent(e,a,0!==i)}return this.unsafeParse(e,t,r)&&(!(n.length>0)||n)},encode:function(e,t,r){var n=[];return"Function"===this.getType(t)?r=t:"Function"!==this.getType(r)&&(r=(n=[]).push.bind(n)),(t=this.assign({},this.STANDARD_ENCODE_OPTS,t)).skip>0&&(e=e.slice(t.skip)),("Array"===this.getType(e[0])?this.encodeArrays:this.encodeObjects)(e,t,r)&&(!(n.length>0)||n.join(t.newline))}};e("csvManager",s("csvManager")(i=function(){function e(){t(this,"csvTables",{}),t(this,"csvTableForArr",{}),t(this,"tableCast",{}),t(this,"tableComment",{})}var r=e.prototype;return r.addTable=function(e,t,r){if(!this.csvTables[e]||r){var n={},i=[];l.parse(t,{header:!0},(function(e,t){n[e[t]]=e,i.push(e)})),this.tableCast[e]=l.opts.cast,this.tableComment[e]=l.opts.comment,this.csvTables[e]=n,this.csvTableForArr[e]=i}},r.getTableArr=function(e){return this.csvTableForArr[e]},r.getTable=function(e){return this.csvTables[e]},r.queryOne=function(e,t,r){var n=this.getTable(e);if(!n)return null;if(!t)return n[r];for(var i in n)if(n.hasOwnProperty(i)&&n[i][t]===r)return n[i]},r.queryByID=function(e,t){return this.queryOne(e,null,t)},r.queryAll=function(e,t,r){var n=this.getTable(e);if(!n||!t)return null;var i={};for(var s in n)n.hasOwnProperty(s)&&n[s][t]===r&&(i[s]=n[s]);return i},r.queryIn=function(e,t,r){var n=this.getTable(e);if(!n||!t)return null;for(var i={},s=Object.keys(n),u=s.length,a=0;a<u;a++){var o=n[s[a]];r.indexOf(o[t])>-1&&(i[s[a]]=o)}return i},r.queryByCondition=function(e,t){if(t.constructor!==Object)return null;var r=this.getTable(e);if(!r)return null;for(var n={},i=Object.keys(r),s=i.length,u=Object.keys(t),a=u.length,o=0;o<s;o++){for(var l=r[i[o]],c=!0,h=0;h<a;h++){var f=u[h];c=c&&t[f].indexOf(l[f])>-1&&!n[i[o]]}c&&(n[i[o]]=l)}return n},e}())||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/configuration.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var a,s,i,n,e,o;return{setters:[function(t){a=t.defineProperty,s=t.createClass},function(t){i=t.cclegacy,n=t._decorator,e=t.sys,o=t.log}],execute:function(){var r,c,u;i._RF.push({},"3847d/eUQRHv70w/7Q0rfwv","configuration",void 0);var h=n.ccclass;t("configuration",h("configuration")((u=c=function(){function t(){a(this,"jsonData",null),a(this,"path",null),a(this,"KEY_CONFIG","CarConfig"),a(this,"markSave",!1),a(this,"saveTimer",-1)}var i=t.prototype;return i.start=function(){var t,a=this;(this.jsonData={userId:""},this.path=this.getConfigPath(),e.isNative)?t=jsb.fileUtils.getValueMapFromFile(this.path)[this.KEY_CONFIG]:t=e.localStorage.getItem(this.KEY_CONFIG);if(t&&t.length){t.startsWith("@")&&(t=t.substring(1));try{var s=JSON.parse(t);this.jsonData=s}catch(t){}}this.saveTimer=setInterval((function(){a.scheduleSave()}),500)},i.setConfigDataWithoutSave=function(t,a){var s=this.jsonData.userId;this.jsonData[s]?this.jsonData[s][t]=a:console.error("no account can not save")},i.setConfigData=function(t,a){this.setConfigDataWithoutSave(t,a),this.markSave=!0},i.getConfigData=function(t){var a=this.jsonData.userId;if(this.jsonData[a]){var s=this.jsonData[a][t];return s||""}return o("no account can not load"),""},i.setGlobalData=function(t,a){this.jsonData[t]=a,this.save()},i.getGlobalData=function(t){return this.jsonData[t]},i.setUserId=function(t){this.jsonData.userId=t,this.jsonData[t]||(this.jsonData[t]={}),this.save()},i.getUserId=function(){return this.jsonData.userId},i.scheduleSave=function(){this.markSave&&this.save()},i.markModified=function(){this.markSave=!0},i.save=function(){var t=JSON.stringify(this.jsonData);if(this.markSave=!1,e.isNative){var a={};a[this.KEY_CONFIG]=t,jsb.fileUtils.writeToFile(a,this.path)}else{e.localStorage.setItem(this.KEY_CONFIG,t)}},i.getConfigPath=function(){e.platform;var t="";return e.isNative?(t=jsb.fileUtils.getWritablePath(),t+="conf"):t="src/conf",t},i.parseUrl=function(t){if(t&&!("string"==typeof t&&t.length<=0)){var a={};if("string"==typeof t)(t=t.split("?")[1]).split("&").forEach((function(t){var s=t.indexOf("=");if(-1!==s){var i=t.substring(0,s);a[i]=t.substring(s+1)}}));else a=t;a.action&&this.setGlobalData("urlParams",a),a.source&&this.setGlobalData("source",a.source),a.adchannelid&&this.setGlobalData("adchannelid",a.adchannelid)}},t.generateGuestAccount=function(){return""+Date.now()+10},s(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t,this._instance.start()),this._instance}}]),t}(),a(c,"_instance",void 0),r=u))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/BotController.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,a,o,r,i,s,n,l;return{setters:[function(e){t=e.inheritsLoose,a=e.defineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,i=e._decorator,s=e.instantiate,n=e.MeshRenderer,l=e.Component}],execute:function(){var g;r._RF.push({},"405c9cWsTlBYZLDhu8Tavvx","BotController",void 0);var m=i.ccclass;i.property,e("BotController",m("BotController")(g=function(e){function r(t){var r;return r=e.call(this)||this,a(o(r),"_totalPlayerArrayList",[]),a(o(r),"playerCamera",void 0),a(o(r),"_gameController",void 0),r._gameController=t,r}t(r,e);var i=r.prototype;return i.start=function(){},i.addBots=function(e,t,a,o){for(var r=this._gameController.gameData.totalBotPresent,i=this._gameController.gameData.easyBot,l=this._gameController.gameData.mediumBot,g=this._gameController.gameData.hardBot,m=0;m<r;m++){var h={character:this.generateRandomNumber(0,t.length-1),bag:this.generateRandomNumber(-1,this._gameController.bagAcceesories.length-1),headPhone:this.generateRandomNumber(-1,this._gameController.headPhoneAcceesories.length-1),goggles:this.generateRandomNumber(-1,this._gameController.gogglesAcceesories.length-1),target:this.generateRandomNumber(0,this._gameController.targetAcceesories.length-1)},c=s(e);c.getComponent("Bot")._playerList=this._totalPlayerArrayList,c.getComponent("Bot").playerCamera=this.playerCamera,c.getComponent("Bot").addName(a,this._gameController.getWorld(),this._gameController),this._gameController.addToWorld(c),c.setPosition(this._gameController.gameData.position[m]),c.eulerAngles=this._gameController.gameData.angle[m],this._totalPlayerArrayList.push(c),c.getChildByName("Penguine_Anim").getChildByName("penguin_body01").getComponent(n).setMaterial(t[h.character].characterMaterial,0),i>0?(i--,c.getComponent("Bot").setProperties("easy")):l>0?(l--,c.getComponent("Bot").setProperties("medium")):g>0&&(g--,c.getComponent("Bot").setProperties("hard")),this.initialiseAccessoriesData(c,h)}this._totalPlayerArrayList.push(o)},i.initialiseAccessoriesData=function(e,t){-1==t.bag?e.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").getComponent(n).setMaterial(this._gameController.bagAcceesories[t.bag].material,0),-1==t.headPhone?e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").getComponent(n).setMaterial(this._gameController.headPhoneAcceesories[t.headPhone].material,0),-1==t.goggles?e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").getComponent(n).setMaterial(this._gameController.gogglesAcceesories[t.goggles].material,0),-1==t.target?e.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").getComponent(n).setMaterial(this._gameController.targetAcceesories[t.target].material,0)},i.generateRandomNumber=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},r}(l))||g);r._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerMovement.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./Helper.ts"],(function(e){"use strict";var t,s,i,n,o,a,r,l;return{setters:[function(e){t=e.inheritsLoose,s=e.defineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,o=e._decorator,a=e.Vec3,r=e.Component},function(e){l=e.Helper}],execute:function(){var h;n._RF.push({},"465f28KiQZEUqz7f7nOJuR+","PlayerMovement",void 0);var d=o.ccclass;o.property,e("PlayerMovement",d("PlayerMovement")(h=function(e){function n(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,s(i(t),"sessionId",void 0),s(i(t),"userId",void 0),s(i(t),"isSelfUpdateAllowed",!1),s(i(t),"characterHud",null),s(i(t),"positonStack",[]),s(i(t),"startPos",void 0),s(i(t),"startAngle",new a),s(i(t),"startScale",new a),s(i(t),"endPos",void 0),s(i(t),"endAngle",void 0),s(i(t),"endScale",void 0),s(i(t),"maxFrames",2),s(i(t),"networkSpeed",60),s(i(t),"frames",t.maxFrames+1),s(i(t),"gameFps",t.maxFrames*t.networkSpeed),s(i(t),"lastCalledTime",0),s(i(t),"delta",0),s(i(t),"fps",0),t}t(n,e);var o=n.prototype;return o.showFps=function(){if(!this.lastCalledTime)return this.lastCalledTime=Date.now(),void(this.fps=0);this.delta=(Date.now()-this.lastCalledTime)/1e3,this.lastCalledTime=Date.now(),this.fps=1/this.delta,console.log(Math.round(this.fps))},o.setPropertiesFromServer=function(e,t){this.sessionId=e,this.userId=t.userId},o.startUpdateFromServer=function(){l.setFixedInterval(this.updatePositionFromServer.bind(this),1e3/this.gameFps)},o.onPositionUpdate=function(e){this.positonStack.push({pos:new a(e.x,this.node.position.y,e.z),angle:new a(e.eulerAngles.x,e.eulerAngles.y,e.eulerAngles.z),scale:new a(e._currentScale,e._currentScale,e._currentScale)}),this.positonStack.length>5&&this.positonStack.splice(0,this.positonStack.length-5)},o.startSelfUpdate=function(){this.isSelfUpdateAllowed=!0},o.updatePositionFromServer=function(e){if(this.frames>this.maxFrames&&this.positonStack.length){this.startPos=new a(this.node.position.x,this.node.position.y,this.node.position.z),this.startAngle=new a(this.node.eulerAngles.x,this.node.eulerAngles.y,this.node.eulerAngles.z),this.startScale=new a(this.node.scale.x,this.node.scale.y,this.node.scale.z);var t=this.positonStack.shift();this.endPos=t.pos,this.endAngle=t.angle,this.endScale=t.scale,this.frames=1}this.frames<=this.maxFrames&&(this.node.position=a.lerp(new a,this.startPos,this.endPos,this.frames/this.maxFrames),this.node.eulerAngles=a.lerp(new a,this.startAngle,this.endAngle,this.frames/this.maxFrames),this.node.scale=a.lerp(new a,this.startScale,this.endScale,this.frames/this.maxFrames),this.characterHud.setHudPosFromServer(this.node.scale)),++this.frames},n}(r))||h);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./commonFun.ts","./mxManager.ts","./GameConfig.ts","./constant.ts","./audioManager.ts","./GameStateTrigger.ts","./SocketConnection.ts","./BotController.ts","./Helper.ts","./PowerUpController.ts"],(function(e){"use strict";var t,a,r,i,n,o,s,l,p,h,c,u,m,g,d,y,C,f,P,w,S,v,b,B,D,A,N,_,U,O,I,M,z,L,G,T,E,R,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.initializerDefineProperty,r=e.inheritsLoose,i=e.assertThisInitialized,n=e.defineProperty},function(e){o=e.cclegacy,s=e._decorator,l=e.Material,p=e.SpriteFrame,h=e.Mesh,c=e.Prefab,u=e.Node,m=e.RichText,g=e.Vec2,d=e.randomRange,y=e.instantiate,C=e.Vec3,f=e.CapsuleCollider,P=e.tween,w=e.MeshRenderer,S=e.Sprite,v=e.ProgressBar,b=e.Label,B=e.Animation,D=e.RigidBody,A=e.PhysicsSystem,N=e.log,_=e.Component},function(e){U=e.CommonFun},function(e){O=e.MxManager},function(e){I=e.GameConfig},function(e){M=e.constant},function(e){z=e.audioManager},function(e){L=e.GameStateTrigger},function(e){G=e.SocketConnection,T=e.SocketListener},function(e){E=e.BotController},function(e){R=e.STATE},function(e){F=e.PowerUpController}],execute:function(){var k,H,x,W,V,j,q,Y,K,Q,J,X,Z,$,ee,te,ae,re,ie,ne,oe,se,le,pe,he,ce,ue,me,ge,de,ye,Ce,fe,Pe,we,Se,ve,be,Be,De,Ae,Ne,_e,Ue,Oe,Ie,Me,ze,Le,Ge,Te,Ee,Re,Fe,ke,He,xe,We,Ve,je,qe,Ye,Ke,Qe,Je,Xe,Ze,$e,et,tt,at,rt,it,nt,ot,st,lt;o._RF.push({},"48d51HOjkBIObFppQAdshF3","GameController",void 0);var pt=s.ccclass,ht=s.property,ct=e("CharacterGame",(k=pt("CharacterGame"),H=ht(l),k((V=t((W=function(){a(this,"characterMaterial",V,this)}).prototype,"characterMaterial",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=W))||x)),ut=e("CharacterItem",(j=pt("CharacterItem"),q=ht(p),Y=ht(l),K=ht(h),j((X=t((J=function(){a(this,"frame",X,this),a(this,"material",Z,this),a(this,"mesh",$,this)}).prototype,"frame",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(J.prototype,"material",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(J.prototype,"mesh",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=J))||Q));e("GameController",(ee=pt("GameController"),te=ht({type:ct}),ae=ht({type:ct}),re=ht({type:c}),ie=ht({type:ut}),ne=ht({type:ut}),oe=ht({type:ut}),se=ht({type:ut}),le=ht({type:u}),pe=ht({type:c}),he=ht({type:c}),ce=ht({type:c}),ue=ht({type:c}),me=ht({type:c}),ge=ht({type:c}),de=ht({type:c}),ye=ht({type:c}),Ce=ht({type:u}),fe=ht({type:u}),Pe=ht({type:u}),we=ht({type:u}),Se=ht({type:u}),ve=ht({type:u}),be=ht({type:m}),Be=ht({type:m}),De=ht({type:u}),Ae=ht({type:u}),Ne=ht({type:p}),_e=ht({type:p}),Ue=ht({type:p}),Oe=ht({type:c}),ee((ze=t((Me=function(e){function t(){for(var t,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,a(i(t),"botPrefabList",ze,i(t)),a(i(t),"playerPrefabList",Le,i(t)),a(i(t),"foodPrefabList",Ge,i(t)),a(i(t),"bagAcceesories",Te,i(t)),a(i(t),"headPhoneAcceesories",Ee,i(t)),a(i(t),"gogglesAcceesories",Re,i(t)),a(i(t),"targetAcceesories",Fe,i(t)),a(i(t),"directionalLight",ke,i(t)),a(i(t),"player",He,i(t)),a(i(t),"bot",xe,i(t)),a(i(t),"gummyBear",We,i(t)),a(i(t),"PoisionSize",Ve,i(t)),a(i(t),"PoisionSpeed",je,i(t)),a(i(t),"GainSpeed",qe,i(t)),a(i(t),"Sheild",Ye,i(t)),a(i(t),"characterHud",Ke,i(t)),a(i(t),"playerCamera",Qe,i(t)),a(i(t),"TrianglePlatform",Je,i(t)),a(i(t),"CircularPlatform",Xe,i(t)),a(i(t),"InfinePlatform",Ze,i(t)),a(i(t),"StarPlatform",$e,i(t)),a(i(t),"SquarelPatform",et,i(t)),a(i(t),"gameTimer",tt,i(t)),a(i(t),"gameScore",at,i(t)),a(i(t),"gameOver",rt,i(t)),n(i(t),"gameTimerCount",0),n(i(t),"platformVertices",[]),n(i(t),"isReady",!1),n(i(t),"playerMap",{}),n(i(t),"playerClass",void 0),n(i(t),"botController",void 0),n(i(t),"powerupController",void 0),n(i(t),"world",void 0),n(i(t),"gameData",{}),n(i(t),"playerBoardData",[]),a(i(t),"powerUpProgress",it,i(t)),a(i(t),"SheildImg",nt,i(t)),a(i(t),"GainSpeedImg",ot,i(t)),a(i(t),"PoisionSpeedImg",st,i(t)),n(i(t),"_currentDuration",void 0),n(i(t),"platform",null),n(i(t),"currentTime",null),n(i(t),"gameUiController",null),n(i(t),"commonFun",null),n(i(t),"totalPlayers",0),n(i(t),"gameOverCalled",!1),n(i(t),"gameOverList",[]),n(i(t),"gameStarted",!1),n(i(t),"locationInterval",null),a(i(t),"pedestal",lt,i(t)),n(i(t),"deathSpawnPosition",[]),t}r(t,e);var o=t.prototype;return o.onLoad=function(){if(L.sendGameState(L.EventType.Game_Play_Launched.key,L.EventType.Game_Play_Launched.reason),this.powerupController=new F(this),this.gameUiController=this.node.parent.getChildByName("Canvas").getComponent("GameUIController"),this.gameData={},O.instance.isMiloApp&&(G.instance.send({command:"GAME_LOADED",data:{msg:"Client game loaded"}}),this.registerListeners()),this.commonFun=new U,this.world=this.node.getParent(),O.instance.isMiloApp){this.powerupController.setEatables([this.gummyBear,this.PoisionSize,this.PoisionSpeed,this.GainSpeed,this.Sheild]),this.setGameData(G.instance.room.state.gameData),this.activatePlatform(this.gameData.currentMap);for(var e=0,t=0;t<G.instance.onlinePlayers.length;t++){var a=G.instance.onlinePlayers[t];this.addPlayerToWorld(a,a.sessionId),a.isDead||(e+=1),G.instance.sessionId==a.sessionId&&1==a.isDead&&this.playerDeadListener(a)}this.updatePlayerCount(e)}else{var r=parseInt(window.localStorage.getItem("currentLevel")),i=null,n=(i=r<I.gameplay.levels.length?I.gameplay.levels[r]:I.gameplay.default).noOfBotsInGame,o=this.getPercentage(100*i.botsProbabilty.easy,n),s=this.getPercentage(100*i.botsProbabilty.medium,n),l=this.getPercentage(100*i.botsProbabilty.hard,n);if(n>0)for(;o+s+l!=n;)o>0?o-=1:s>0?s-=1:l>0&&(l-=1);else n=0;var p=this.DrawCirclePointsForPlayers(n+1,10,new g(0,0)),h=this.getAngleForPlayer(360,n+1);this.totalPlayers=n+1;var c={currentLevel:r,levelDetail:i,actualPlayerCount:1,totalBotPresent:n,easyBot:o,mediumBot:s,hardBot:l,position:p,angle:h,currentMap:i.map.currentMap};this.gameData=Object.assign({},c),this.generatePlatform(),this.isReady=!0;var u=I.debug.playerPos;-1==u?u=Math.floor(d(0,n)):u>=n+1&&(u=0);var m=this.gameData.position,w=m.splice(u,1);this.gameData.position=m;var S=this.gameData.angle,v=S.splice(u,1);this.gameData.angle=S;var b=y(this.player);this.addToWorld(b),this.initialiseAccessoriesData(b);var B=v[0];b.setPosition(w[0]),b.eulerAngles=B,this.playerClass=b.getComponent("Player"),this.playerClass.setCamera(this.playerCamera,this,B),this.playerClass.addName(this.characterHud,this.world),this.playerClass.isReady=!0,I.debug.camera.angleChange&&(this.directionalLight.eulerAngles=new C(-35,b.eulerAngles.y+180,0)),this.generateBot(b),this.powerupController.setEatables([this.gummyBear,this.PoisionSize,this.PoisionSpeed,this.GainSpeed,this.Sheild]),this.powerupController.spawnPowerup("GummyBear"),b.getComponent(f).on("onCollisionEnter",this.onCollision,this);var D=this.totalPlayers;D%2!=0&&(D+=1);for(var A=D/2,N=1.5,_=0;_<D;_++)_==A&&(this.deathSpawnPosition.reverse(),N=1.5),_<A?this.deathSpawnPosition.push(new C(-1*N,0,-37)):this.deathSpawnPosition.push(new C(N,0,-37)),N+=3;for(var M=-10,z=0;z<this.deathSpawnPosition.length;z++){this.deathSpawnPosition[z].y=M,M+=.5}}P(this.node.getParent().getChildByName("water")).to(5,{position:new C(this.node.getParent().getChildByName("water").position.x,this.node.getParent().getChildByName("water").position.y+.5,this.node.getParent().getChildByName("water").position.z)},{easing:"sineIn"}).to(5,{position:new C(this.node.getParent().getChildByName("water").position.x,this.node.getParent().getChildByName("water").position.y-.5,this.node.getParent().getChildByName("water").position.z)},{easing:"sineOut"}).union().repeatForever().start(),P(this.node.getParent().getChildByName("waterTerrain")).by(2,{eulerAngles:new C(this.node.getParent().getChildByName("waterTerrain").eulerAngles.x,this.node.getParent().getChildByName("waterTerrain").eulerAngles.y+20,this.node.getParent().getChildByName("waterTerrain").eulerAngles.z)}).repeatForever().start()},o.createPedestal=function(e){var t=y(this.pedestal);t.position.set(new C(e.x,-20,e.z)),this.addToWorld(t),P(t).to(1,{position:new C(e.x,e.y,e.z)},{easing:"sineIn"}).start()},o.initialiseGameUIController=function(e){e.gameController=this},o.initialiseAccessoriesData=function(e){var t;t=O.instance.isMiloApp?e.getComponent("Player").playerData:window.localStorage.getItem("playerData");var a=JSON.parse(t),r=-1==a.character?0:a.character;e.getChildByName("Penguine_Anim").getChildByName("penguin_body01").getComponent(w).setMaterial(this.playerPrefabList[r].characterMaterial,0),-1==a.bag?e.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").getComponent(w).setMaterial(this.bagAcceesories[a.bag].material,0),-1==a.headPhone?e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").getComponent(w).setMaterial(this.headPhoneAcceesories[a.headPhone].material,0),-1==a.goggles?e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").getComponent(w).setMaterial(this.gogglesAcceesories[a.goggles].material,0),-1==a.target?e.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").active=!1:e.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").getComponent(w).setMaterial(this.targetAcceesories[a.target].material,0)},o.generateBot=function(e){this.botController=new E(this),this.botController.playerCamera=this.playerClass.playerCamera,this.botController.addBots(this.bot,this.botPrefabList,this.characterHud,e)},o.setGameData=function(e){this.gameData.actualPlayerCount=G.instance.room.state.gameData.actualPlayerCount,this.gameData.currentLevel=G.instance.room.state.gameData.currentLevel,this.gameData.currentMap=G.instance.room.state.gameData.currentMap,this.gameData.easyBot=G.instance.room.state.gameData.easyBot,this.gameData.mediumBot=G.instance.room.state.gameData.mediumBot,this.gameData.hardBot=G.instance.room.state.gameData.hardBot,this.gameData.totalBotPresent=G.instance.room.state.gameData.totalBotPresent},o.activatePlatform=function(e){switch(e){case"triangle":var t=[new C(29,.5,18),new C(-29,.5,18),new C(0,.5,-28)];this.platform=this.TrianglePlatform,this.platformVertices=t;break;case"circular":var a=this.DrawCirclePoints(10,25,new g(0,0));this.platform=this.CircularPlatform,this.platformVertices=a;break;case"infinite":var r=this.DrawCirclePoints(10,24,new g(17,0)),i=this.DrawCirclePoints(10,24,new g(-17,0));i.splice(0,1);for(var n=[],o=0;o<r.length;o++)5!=o?n.push(r[o]):n=n.concat(i);var s=this.splitInteger(this.gameData.totalBotPresent+1,2),l=this.DrawCirclePointsForPlayers(s[0],10,new g(17,0)),p=this.DrawCirclePointsForPlayers(s[1],10,new g(-17,0));l=l.concat(p);var h=this.getAngleForPlayer(360,s[0]),c=this.getAngleForPlayer(360,s[1]);h=h.concat(c),this.gameData.position=l,this.gameData.angle=h,this.platform=this.InfinePlatform,this.platformVertices=n;break;case"star":var u=[new C(0,.5,-25),new C(10,.5,-11),new C(27,.5,-6),new C(16,.5,8),new C(17,.5,26),new C(0,.5,19),new C(-17,.5,26),new C(-16,.5,8),new C(-27,.5,-6),new C(-10,.5,-11)];this.platform=this.StarPlatform,this.platformVertices=u;break;case"square":var m=[new C(25,.5,-25),new C(25,.5,25),new C(-25,.5,25),new C(-25,.5,-25)];this.platform=this.SquarelPatform,this.platformVertices=m}this.platform.active=!0},o.generatePlatform=function(){if("isRandom"==this.gameData.currentMap){var e=Math.floor(d(0,I.debug.mapList.length-1));this.gameData.currentMap=I.debug.mapList[e]}this.activatePlatform(this.gameData.currentMap)},o.splitInteger=function(e,t){var a,r,i=e%t;if(0==i)a=e/t,r=Array(t).fill(a);else{a=(e-i)/t,r=Array(t).fill(a);for(var n=0;n<i;n++)r[n]=r[n]+1;r.reverse()}return r},o.getRangeVal=function(e,t,a,r,i){return(e-(t=t))/((a=a)-t)*((i=i)-(r=r))+r},o.startPowerupProgress=function(e,t){this.powerUpProgress.active=!0,"sheild"==t&&(this.powerUpProgress.getChildByName("powerUpImage").getChildByName("image").getComponent(S).spriteFrame=this.SheildImg),"GainSpeed"==t&&(this.powerUpProgress.getChildByName("powerUpImage").getChildByName("image").getComponent(S).spriteFrame=this.GainSpeedImg),"PoisionSpeed"==t&&(this.powerUpProgress.getChildByName("powerUpImage").getChildByName("image").getComponent(S).spriteFrame=this.PoisionSpeedImg),this._currentDuration=e;var a=this.getRangeVal(e,0,this._currentDuration,0,1);this.powerUpProgress.getChildByName("ProgressBar").getComponent(v).progress=a;var r=this.getRangeVal(e-1,0,this._currentDuration,0,1);P(this.powerUpProgress.getChildByName("ProgressBar").getComponent(v)).to(1,{progress:r}).start(),this.powerUpProgress.getChildByName("powerUpImage").getChildByName("counter").getComponent(b).string=e},o.updatePowerProgress=function(e){var t=this.getRangeVal(e-1,0,this._currentDuration,0,1);P(this.powerUpProgress.getChildByName("ProgressBar").getComponent(v)).to(1,{progress:t}).start(),this.powerUpProgress.getChildByName("powerUpImage").getChildByName("counter").getComponent(b).string=e,0==e&&(this.powerUpProgress.active=!1)},o.gameTimerUpdate=function(){this.gameTimerCount--,this.gameTimer.string="<color=#000000><size=56>Time  : </size><color=#449b9a><size=56>"+this.commonFun.fancyTimeFormat(this.gameTimerCount)+"</size>",this.gameTimerCount==this.gameData.levelDetail.time-this.gameData.levelDetail.powerUp.initialiseDuration&&this.powerupController.startSpawningNewPowerups(),this.checkIfOnlyOnePlayerRemaining()||(parseInt(window.localStorage.getItem("isStopped"))||(this.checkCharacterWithHighScore(),this.updatePlayerCount(this.botController._totalPlayerArrayList.length)),this.gameTimerCount<=0&&this.onTimerRunsOut())},o.checkIfOnlyOnePlayerRemaining=function(){return 1==this.botController._totalPlayerArrayList.length&&(this.unschedule(this.gameTimerUpdate),this.gameOverCalled=!0,this.gameUiController.exitPopupShown&&this.gameUiController.hideExitPopup(),this.gameUiController.node.getChildByName("exitPopup").active=!1,this.gameOver.getComponent("GameOver").showWinPopup(this),!0)},o.onTimerRunsOut=function(){this.unschedule(this.gameTimerUpdate),this.gameOverList=[];var e=[];for(window.localStorage.setItem("isStopped","1");this.botController._totalPlayerArrayList.length>0;){var t=this.checkCharacterWithHighScore();this.commonFun.removeObjectFromArray(this.botController._totalPlayerArrayList,t),this.gameOverList.push(t);var a=null==t.getComponent("Bot")?t.getComponent("Player"):t.getComponent("Bot"),r=new Date,i={name:a._charName,time:r.getTime(),isSelf:null==t.getComponent("Bot")};e.push(i)}for(var n=e.length-1;n>=0;n--)this.playerBoardData.push(e[n]);this.showGameOver()},o.checkCharacterWithHighScore=function(){var e=this.getPlayerCrown(0),t=null;1==e.length?t=e[0]:t=1==(e=this.getPlayerCrown(1)).length||1==(e=this.getPlayerCrown(2)).length?e[0]:e[Math.floor(d(0,e.length-1))];return t&&(t.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("crown_01").active=!0),t},o.getPlayerCrown=function(e){for(var t=0,a=0,r=0;r<this.botController._totalPlayerArrayList.length;r++){var i=this.botController._totalPlayerArrayList[r],n=null==i.getComponent("Bot")?i.getComponent("Player"):i.getComponent("Bot");i.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("crown_01").active=!1,0==e?n.getCurrentScale()>a&&(a=n.getCurrentScale(),t=n.getCurrentScale()):1==e?n._totalSumoPushed>a&&(a=n._totalSumoPushed,t=n._totalSumoPushed):n._score>a&&(a=n._score,t=n._score)}for(var o=[],s=0;s<this.botController._totalPlayerArrayList.length;s++){var l=this.botController._totalPlayerArrayList[s],p=null==l.getComponent("Bot")?l.getComponent("Player"):l.getComponent("Bot");0==e?p.getCurrentScale()==t&&o.push(l):1==e?p._totalSumoPushed==t&&o.push(l):p._score==t&&o.push(l)}return o},o.updatePlayerCount=function(e){this.gameUiController.node.getChildByName("Hud").getChildByName("hudbar").getChildByName("totalPlayer").getChildByName("playerCount").getComponent(m).string="<color=#ffffff><size=60>"+e+"</size>"},o.start=function(){(L.sendGameState(L.EventType.Game_Tutorial_Finished.key,"Not Skipped"),O.instance.isMiloApp&&G.instance.room.state.readyGoCount<=0)&&this.gameUiController.node.getChildByName("Hud").getComponent(B).play("showHud")},o.onGameStart=function(){if(window.localStorage.setItem("isStopped","0"),this.gameScore.string="<color=#000000><size=56>Score : </size><color=#449b9a><size=56>0</size>",this.gameUiController.node.getChildByName("Hud").getComponent(B).play("showHud"),O.instance.isMiloApp){for(var e in this.playerMap)if(Object.prototype.hasOwnProperty.call(this.playerMap,e)){var t=this.playerMap[e];G.instance.sessionId!=e&&t.setAnimationState(R.WALK)}}else this.gameTimerCount=this.gameData.levelDetail.time,this.gameTimerUpdate(),this.schedule(this.gameTimerUpdate,1),this.gameStarted=!0;var a=new Date;this.currentTime=a.getTime()},o.update=function(e){if(this.gameStarted)for(var t=0;t<this.botController._totalPlayerArrayList.length;t++)for(var a=0;a<this.botController._totalPlayerArrayList.length&&0!=t;a++){var r=this.botController._totalPlayerArrayList[t],i=this.botController._totalPlayerArrayList[a];if(r.uuid!=i.uuid){var n=null==r.getComponent("Bot")?r.getComponent("Player"):r.getComponent("Bot"),o=null==i.getComponent("Bot")?i.getComponent("Player"):i.getComponent("Bot"),s=this.commonFun.checkIsCollided(r.position.x,r.position.z,i.position.x,i.position.z,n.getCurrentScale()+I.commonData.collisionSizeValue,o.getCurrentScale()+I.commonData.collisionSizeValue);1==s||s<0||(n.OnUpdateCollision(i),o.OnUpdateCollision(r))}}},o.addToWorld=function(e){this.world.addChild(e)},o.getWorld=function(){return this.world},o.showGameOver=function(){this.gameUiController.exitPopupShown&&this.gameUiController.hideExitPopup(),this.gameUiController.node.getChildByName("exitPopup").active=!1,this.gameOverCalled=!0,this.gameOver.getComponent("GameOver").showGameOverPopup(this)},o.onCollisionTrigger=function(e){for(var t=e.otherCollider,a=!1,r=0;r<10;r++){var i="Player",n="bot";if(r>0&&(i+=r,n+=r),t.node.name==i){a=!0;break}if(t.node.name==n){a=!0;break}}a&&this.playerClass._onCollisionEnter(e)},o.onCollision=function(e){var t=e.otherCollider;if("platform"!=t.node.name){if("GummyBear"==t.node.name){z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.gainPowerUp),this.powerupController.removeGummy(t);var a=I.powerup[t.node.name].gainPercentage;this.playerClass.resize(a,!0),this.playerClass.updateScore(I.powerup[t.node.name].score)}if(!(this.playerClass.checkSheildActive()||this.playerClass.checkGainSpeedActive()||this.playerClass.checkPoisionSpeedActive())){if("PoisionSize"==t.node.name){z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.poisonPowerUp),this.powerupController.removeGummy(t);var r=I.powerup[t.node.name].lossPercentage;this.playerClass.resize(r,!1),this.playerClass.updateScore(I.powerup[t.node.name].score)}if("PoisionSpeed"==t.node.name){z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.slowPowerUp),this.powerupController.removeGummy(t);var i=I.powerup[t.node.name].lossSpeedPercentage,n=I.powerup[t.node.name].duration;this.playerClass.reEvaluateSpeed(i,n,!1),this.playerClass.updateScore(I.powerup[t.node.name].score)}if("GainSpeed"==t.node.name){z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.speedPowerUp),this.powerupController.removeGummy(t);var o=I.powerup[t.node.name].increaseSpeedPercentage,s=I.powerup[t.node.name].duration;this.playerClass.reEvaluateSpeed(o,s,!0),this.playerClass.updateScore(I.powerup[t.node.name].score)}if("Sheild"==t.node.name){z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.sheildPowerUp),this.powerupController.removeGummy(t);var l=I.powerup[t.node.name].duration;this.playerClass.startSheild(l),this.playerClass.updateScore(I.powerup[t.node.name].score)}}}},o.touchCallBack=function(e,t){this.isReady&&this.playerClass.touchCallBack(e,t)},o.sliderCallBack=function(e,t){this.playerClass.sliderCallBack(e,t)},o.touchAngleCallBack=function(e,t){this.isReady&&this.playerClass.touchAngleCallBack(e,t)},o.getPercentage=function(e,t){return Math.ceil(e/100*t)},o.DrawCirclePoints=function(e,t,a){for(var r=[],i=2*Math.PI/e,n=0;n<e;n++){var o=i*n,s=Number(a.x+t*Math.cos(o)),l=Number(a.y+t*Math.sin(o)),p=new C(s,.5,l);r.push(p)}return r},o.DrawCirclePointsForPlayers=function(e,t,a){for(var r=[],i=2*Math.PI/e,n=0;n<e;n++){var o=i*n,s=Number(a.x+t*Math.sin(o)),l=Number(a.y+t*Math.cos(o)),p=new C(s,.5,l);r.push(p)}return r},o.getAngleForPlayer=function(e,t){for(var a=this.getsplitRange(e,t),r=[],i=0,n=0;n<a.length;n++){var o=new C(0,i,0);i+=a[n],o.y=o.y+180,r.push(o)}return r},o.rotateRight=function(e){var t=e.pop();return e.unshift(t),e},o.getsplitRange=function(e,t){var a=[];if(t<=0)return a;for(var r=Math.floor(e/t),i=0;i<t;i++)a.push(r);if(a.reduce((function(e,t){return e+t}),0)===e)return a;for(var n=0;n<t;n++)if(a[n]++,a.reduce((function(e,t){return e+t}),0)===e)return a},o.onNewPlayerAdd=function(){for(var e=0;e<G.instance.onlinePlayers.length;e++){var t=G.instance.onlinePlayers[e];if(!this.playerMap[t.sessionId]){var a=this.serarchPlayer(t.userId);this.removeFromWorld(this.playerMap[a].node),delete this.playerMap[a],this.addPlayerToWorld(t,t.sessionId)}}},o.serarchPlayer=function(e){var t="";for(var a in this.playerMap){if(Object.prototype.hasOwnProperty.call(this.playerMap,a))this.playerMap[a].userId==e&&(t=a)}return t},o.addPlayerToWorld=function(e,t){var a=y(this.player);a.position.set(new C(e.x,e.y,e.z)),this.addToWorld(a),a.getComponent(D).setGroup(A.PhysicsGroup.nonCollidingPlayer);var r=a.getComponent("Player");r.setPropertiesFromServer(t,e),null==e.playerData||e.playerData,r.playerData=e.playerData,this.initialiseAccessoriesData(a),r.node.eulerAngles.set(new C(e.eulerAngles.x,e.eulerAngles.y,e.eulerAngles.z)),G.instance.sessionId!=t?r.setMiloCamera(this.playerCamera,this,new C(e.eulerAngles.x,e.eulerAngles.y,e.eulerAngles.z)):r.setCamera(this.playerCamera,this,new C(e.eulerAngles.x,e.eulerAngles.y,e.eulerAngles.z)),r.addName(this.characterHud,this.world),r.updateName(e),this.playerMap[t]=r,e.isDead&&r.hideSelf(),G.instance.sessionId!=t?r.startUpdateFromServer():(this.playerClass=this.playerMap[t],r.startSelfUpdate(),r.setCurrentScale(e.currentScale),r.node.scale.set(new C(e.currentScale,e.currentScale,e.currentScale)),r.characterHud.setHudPosFromServer(r.node.scale),this.setGameReady())},o.setGameReady=function(){this.playerClass.isReady=!0,this.isReady=!0,this.sendPlayerLocation()},o.sendPlayerLocation=function(){this.isReady&&(this.locationInterval=setInterval(this.sendPlayerUpdate.bind(this),1e3/G.dataRate))},o.stopSendingLocation=function(){this.locationInterval&&clearInterval(this.locationInterval)},o.sendPlayerUpdate=function(){if(G.instance.isConnected){var e=this.playerClass.node.position,t=this.playerClass.node.eulerAngles;G.instance.send({command:"PLAYER_POS",data:{x:e.x,y:e.y,z:e.z,angle:{x:t.x,y:t.y,z:t.z}}})}},o.onHitFromServerListener=function(e){var t=this.playerMap[e.collider];this.playerMap[G.instance.sessionId].collisionReceivedFromServer(e,t)},o.onPowerUpBumpListener=function(e){"GummyBear"==e.name?(z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.gainPowerUp)):"PoisionSize"==e.name?(z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.poisonPowerUp)):"PoisionSpeed"==e.name?(z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.slowPowerUp)):"GainSpeed"==e.name?(z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.speedPowerUp)):"Sheild"==e.name&&(z.instance.playSound(M.AUDIO_SOUND.foodEat),z.instance.playSound(M.AUDIO_SOUND.sheildPowerUp)),this.playerMap[G.instance.sessionId].powerUpBumpListener(e)},o.onPlayerPosChange=function(e){e.sessionId!=G.instance.room.sessionId&&this.playerMap[e.sessionId]&&(this.playerMap[e.sessionId].onPositionUpdate(e),this.playerMap[e.sessionId]._currentState!=e.currentState&&this.playerMap[e.sessionId].setAnimationState(e.currentState))},o.getStateName=function(e){switch(e){case R.IDLE:return"IDLE";case R.WALK:return"WALK";case R.BUMP:return"BUMP";case R.EAT:return"EAT";case R.WIN:return"WIN"}},o.removeFromWorld=function(e){this.world.removeChild(e)},o.updateServerGameTime=function(e){this.gameTimer.string="<color=#000000><size=56>Time  : </size><color=#449b9a><size=56>"+e+"</size>"},o.registerListeners=function(){var e=this;G.instance.on(T.READY_GO_COUNT,(function(t){e.gameUiController.checkReadyGoTimer(t)}),this),G.instance.on(T.SERVER_GAME_TIME,(function(t){e.updateServerGameTime(t)}),this),G.instance.on(T.ON_POWERUP_CHANGE,(function(t){e.powerupController.onChangeListener(t)}),this),G.instance.on(T.ON_ADD,this.onNewPlayerAdd,this),G.instance.on(T.ON_PLAYER_CHANGE,this.onPlayerPosChange,this),G.instance.on(T.ON_PLAYER_DEAD,this.playerDeadListener,this),G.instance.on(T.ON_BUMP,this.onHitFromServerListener,this),G.instance.on(T.ON_POWERUP_BUMP,this.onPowerUpBumpListener,this),G.instance.on(T.ON_GAME_OVER,this.onGameOverListener,this),G.instance.on(T.ON_CROWN,this.onCrownActiveListener,this),G.instance.on(T.ON_SCORE_CHANGE,this.onScoreChangeListener,this)},o.stopAllPlayers=function(){for(var e in this.playerMap)if(Object.prototype.hasOwnProperty.call(this.playerMap,e)){var t=this.playerMap[e];t.setAnimState("Idle"),t.isSelfUpdateAllowed=!1}},o.onGameOverListener=function(e){console.log("Game Over"),this.stopAllPlayers(),this.gameOverCalled=!0,this.playerMap[G.instance.sessionId].setSpeed(0);var t,a=this.gameOver.getComponent("GameOver");this.playerBoardData=[],t="TimeUp"==e.status?e.list:G.instance.room.state.playerBoardList;for(var r=0;r<t.length;r++){var i=t[r],n={name:i.name,time:i.time,startTime:i.startTime,isSelf:i.sId==G.instance.sessionId};this.playerBoardData.push(n)}this.stopSendingLocation(),a.showGameOverFromServer(this,e.status)},o.playerDeadListener=function(e){console.log("Player dead",e.sessionId);var t=0;G.instance.room.state.playerMap.forEach((function(e,a){e.isDead||(t+=1)})),this.updatePlayerCount(t),this.playerBoardData=[];for(var a=G.instance.room.state.playerBoardList,r=0;r<a.length;r++){var i=a[r],n={name:i.name,time:i.time,startTime:i.startTime,isSelf:i.sId==G.instance.sessionId};this.playerBoardData.push(n)}if(e.sessionId==G.instance.sessionId){N("My game is over"),n.isSelf=!0;var o=this.playerMap[e.sessionId];o.updateScoreFromServer(e.score,!0),o.setSpeed(0),o.hideSelf(),this.gameOverCalled=!0,this.stopSendingLocation(),this.gameOver.getComponent("GameOver").showGameOverFromServer(this)}else{N("Hiding player -",e.sessionId),this.playerMap[e.sessionId].hideSelf()}},o.getTotalPlayers=function(){var e=0;for(var t in this.playerMap)Object.prototype.hasOwnProperty.call(this.playerMap,t)&&++e;return e},o.onCrownActiveListener=function(e){this.playerMap[e.sessionId]&&(this.playerMap[e.sessionId].node.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("crown_01").active=e.crownActive)},o.onScoreChangeListener=function(e){this.playerMap[e.sessionId]&&this.playerMap[e.sessionId].updateScoreFromServer(e.score,e.sessionId==G.instance.sessionId)},o.playerCountListener=function(e){this.gameUiController.node.getChildByName("Hud").getChildByName("hudbar").getChildByName("totalPlayer").getChildByName("playerCount").getComponent(m).string="<color=#ffffff><size=60>"+e+"</size>"},o.onGameQuitListener=function(e){M.callGameOver(this.playerClass._score,!0,!1)},t}(_)).prototype,"botPrefabList",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Le=t(Me.prototype,"playerPrefabList",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ge=t(Me.prototype,"foodPrefabList",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Te=t(Me.prototype,"bagAcceesories",[ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ee=t(Me.prototype,"headPhoneAcceesories",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Re=t(Me.prototype,"gogglesAcceesories",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Fe=t(Me.prototype,"targetAcceesories",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ke=t(Me.prototype,"directionalLight",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=t(Me.prototype,"player",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe=t(Me.prototype,"bot",[he],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=t(Me.prototype,"gummyBear",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ve=t(Me.prototype,"PoisionSize",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(Me.prototype,"PoisionSpeed",[me],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=t(Me.prototype,"GainSpeed",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=t(Me.prototype,"Sheild",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=t(Me.prototype,"characterHud",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qe=t(Me.prototype,"playerCamera",[Ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(Me.prototype,"TrianglePlatform",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=t(Me.prototype,"CircularPlatform",[Pe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=t(Me.prototype,"InfinePlatform",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$e=t(Me.prototype,"StarPlatform",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),et=t(Me.prototype,"SquarelPatform",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=t(Me.prototype,"gameTimer",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),at=t(Me.prototype,"gameScore",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=t(Me.prototype,"gameOver",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=t(Me.prototype,"powerUpProgress",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nt=t(Me.prototype,"SheildImg",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ot=t(Me.prototype,"GainSpeedImg",[_e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st=t(Me.prototype,"PoisionSpeedImg",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=t(Me.prototype,"pedestal",[Oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=Me))||Ie));o._RF.pop()}}}));

System.register("chunks:///_virtual/characterSkins.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./constant.ts","./audioManager.ts"],(function(e){"use strict";var t,i,o,n,r,a,l,s,h,c,u,p,d,C,m,g,y,N;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized,r=e.defineProperty},function(e){a=e.cclegacy,l=e._decorator,s=e.SpriteFrame,h=e.Sprite,c=e.Label,u=e.instantiate,p=e.Vec3,d=e.MeshRenderer,C=e.tween,m=e.SkeletalAnimationComponent,g=e.Component},function(e){y=e.constant},function(e){N=e.audioManager}],execute:function(){var B,v,f,k,A,S,_;a._RF.push({},"4a1da0Kc4RA/7TNtW1pXQcd","characterSkins",void 0);var b=l.ccclass,P=l.property;e("CharacterSkins",(B=b("CharacterSkins"),v=P({type:s}),f=P({type:s}),B((S=t((A=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return t=e.call.apply(e,[this].concat(a))||this,o(n(t),"defaultFrame",S,n(t)),o(n(t),"normalFrame",_,n(t)),r(n(t),"skinName",null),r(n(t),"count",null),r(n(t),"isActive",!0),r(n(t),"isEquipped",!1),r(n(t),"shopController",null),r(n(t),"type",null),r(n(t),"currentIndex",0),t}i(t,e);var a=t.prototype;return a.start=function(){},a.initialiseData=function(e,t,i){this.shopController=i;var o=this.shopController.menuController.playerData;if(this.currentIndex=t,this.type=y.ACCESSORIESTYPE.SKIN,t==y.getSkin().length)return this.isActive=!1,this.count=t,this.node.getChildByName("image").getComponent(h).spriteFrame=this.defaultFrame,void(this.node.getChildByName("commingSoon").active=!0);this.isEquipped=!1,this.isActive=e.unlocked,this.count=t,this.skinName=e.name,-1==o.character&&0==this.count&&(this.isEquipped=!0),e.unlocked||(this.node.getChildByName("lockIcon").active=!0),this.node.getChildByName("name").getComponent(c).string=this.skinName;var n=u(this.shopController.menuController.characterNode);this.node.getChildByName("Plane").getChildByName("characterNode").addChild(n),n.setPosition(new p(0,0,0)),n.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").active=!1,n.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").active=!1,n.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").active=!1,n.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").active=!1,n.getChildByName("Penguine_Anim").getChildByName("penguin_body01").getComponent(d).setMaterial(this.shopController.menuController.character[this.count].characterMaterial,0),o.character==this.count&&(this.isEquipped=!0),this.node.getChildByName("equipped").active=this.isEquipped},a.onEquipClicked=function(){var e=this;if(!this.shopController.buttonBlocked)if(this.isActive){if(this.isEquipped)return;N.instance.playSound(y.AUDIO_SOUND.buttonClick),this.shopController.buttonBlocked=!0,this.shopController.updatePlayerAccessoriesData(0,this.count),this.node.getChildByName("equipped").active=!0,this.shopController.node.getChildByName("disableLayer").active=!0,this.shopController.menuController.sumo.setRotationFromEuler(this.shopController.menuController.sumo.eulerAngles.x,0,this.shopController.menuController.sumo.eulerAngles.z);var t=new p(this.shopController.menuController.playerNode.position);C(this.shopController.menuController.playerNode).to(.35,{eulerAngles:new p(0,-90,0)}).to(1,{position:new p(t.x-600,t.y,t.z)}).call((function(){e.updateCharacter(t)})).start();this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getComponent(m).play("walk");for(var i=0;i<this.shopController.characterSkinArray.length;i++){var o=this.shopController.characterSkinArray[i].getComponent("CharacterSkins");this.shopController.characterSkinArray[i]!=this.node&&(o.isEquipped=!1,this.shopController.characterSkinArray[i].getChildByName("equipped").active=!1)}this.isEquipped=!this.isEquipped}else this.shopController.onShowBuyPopup(this)},a.updateCharacter=function(e){var t=this;this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("penguin_body01").getComponent(d).setMaterial(this.shopController.menuController.character[this.count].characterMaterial,0);C(this.shopController.menuController.playerNode).to(.01,{eulerAngles:new p(0,90,0)}).to(1.5,{position:e}).to(.25,{eulerAngles:new p(0,0,0)}).call((function(){t.shopController.buttonBlocked=!1,t.shopController.node.getChildByName("disableLayer").active=!1,t.shopController.menuController.startAnimation()})).start()},t}(g)).prototype,"defaultFrame",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(A.prototype,"normalFrame",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=A))||k));a._RF.pop()}}}));

System.register("chunks:///_virtual/GameStateTrigger.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./mxManager.ts"],(function(e){"use strict";var a,t,n;return{setters:[function(e){a=e.defineProperty},function(e){t=e.cclegacy},function(e){n=e.MxManager}],execute:function(){t._RF.push({},"4d2damnuB1IxodPlz593A5N","GameStateTrigger",void 0);var r=e("GameStateTrigger",function(){function e(){}return e.sendGameState=function(e,a){var t={eventType:"Update_Game_State",payload:{currentState:e,currentStateInfo:{Reason:a},userId:this.userId}},r=JSON.stringify(t);console.log("GAMESSTATE : "+e+"   payload - "+r),n.instance.pushFromGameToAndroid(r)},e}());a(r,"userId",""),a(r,"EventType",{Game_App_Layer_Loaded:{key:"Game_App_Layer_Loaded",reason:"Game Window is ready to be shown",hint:"empty"},Game_Tutorial_Launched:{key:"Game_Tutorial_Launched",reason:"Tutorial Page is active",hint:"empty"},Game_Tutorial_Finished:{key:"Game_Tutorial_Finished",reason:"empty",hint:"Skipped / Not Skipped"},Game_Waiting_In_Lobby:{key:"Game_Waiting_In_Lobby",reason:"Waiting for all players to be connected to the game-server",hint:"empty"},Game_Play_Ready_To_Launch:{key:"Game_Play_Ready_To_Launch",reason:"All the players have joined",hint:"empty"},Game_Play_Launched:{key:"Game_Play_Launched",reason:"Actual game-play section is started where users start playing the game",hint:"empty"},Game_Play_Round_Start:{key:"Game_Play_Round_Start",reason:"Game is started",hint:"empty"},Game_Play_Turn_Active_For_User:{key:"Game_Play_Turn_Active_For_User",reason:"empty",hint:"Current Player Turn"},Game_Play_Turn_End_For_User:{key:"Game_Play_Turn_End_For_User",reason:"empty",hint:"Current Player Turn"},Game_Play_Round_End:{key:"Game_Play_Round_End",reason:"empty",hint:"empty"},Game_Play_End:{key:"Game_Play_End",reason:"empty",hint:"Completed, Quit, Users did not join"},Game_Result_Shown:{key:"Game_Result_Shown",reason:"empty",hint:"empty"},Game_App_Layer_Closed:{key:"Game_App_Layer_Closed",reason:"empty",hint:"empty"}}),t._RF.pop()}}}));

System.register("chunks:///_virtual/gameOver.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./commonFun.ts","./mxManager.ts","./GameConfig.ts","./constant.ts","./audioManager.ts","./GameStateTrigger.ts"],(function(e){"use strict";var t,r,o,n,i,l,a,s,h,m,g,c,C,u,p,d,y,v,f,S,T,w,A,B,b;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,o=e.defineProperty,n=e.assertThisInitialized,i=e.initializerDefineProperty},function(e){l=e.cclegacy,a=e._decorator,s=e.SpriteFrame,h=e.Prefab,m=e.Vec3,g=e.tween,c=e.ScrollViewComponent,C=e.instantiate,u=e.UITransform,p=e.Animation,d=e.Sprite,y=e.Label,v=e.director,f=e.Component},function(e){S=e.CommonFun},function(e){T=e.MxManager},function(e){w=e.GameConfig},function(e){A=e.constant},function(e){B=e.audioManager},function(e){b=e.GameStateTrigger}],execute:function(){var _,N,P,G,F,O,L,E,k;l._RF.push({},"607a6e7tMFM2o0KKgjUTxNF","gameOver",void 0);var M=a.ccclass,R=a.property;e("GameOver",(_=M("GameOver"),N=R({type:s}),P=R({type:s}),G=R({type:h}),_((L=t((O=function(e){function t(){for(var t,r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return t=e.call.apply(e,[this].concat(l))||this,o(n(t),"gameController",null),o(n(t),"commonFun",null),i(n(t),"goldenTrophy",L,n(t)),i(n(t),"normalTrophy",E,n(t)),i(n(t),"banner",k,n(t)),o(n(t),"scrollView",null),o(n(t),"scrollViewContent",null),o(n(t),"redirectingTimer",0),o(n(t),"isWon",!1),o(n(t),"gameStatus",""),o(n(t),"currentList",[]),t}r(t,e);var l=t.prototype;return l.start=function(){this.commonFun=new S},l.showWinPopup=function(e){var t=this;A.CURRENTSTATE=A.GAMESTATE.GAMEOVER,B.instance.playSound(A.AUDIO_SOUND.win),null==this.commonFun&&(this.commonFun=new S),this.gameController=e,this.gameController.playerClass.node.eulerAngles=new m(0,this.gameController.playerClass.playerCamera.eulerAngles.y,0),this.gameController.playerClass.node.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("crown_01").active=!0;var r=this.gameController.playerClass.playerCamera.getChildByName("playerCamera");g(r).to(1,{position:new m(r.position.x,r.position.y-11,r.position.z),eulerAngles:new m(1,r.eulerAngles.y,r.eulerAngles.z)}).start(),this.commonFun.setWinStateAnimation(this.gameController.playerClass);var o=5;T.instance.isMiloApp&&(o=2),setTimeout((function(){T.instance.isMiloApp?t.showGameOverPopupFromServer(t.gameController):t.gameController.onTimerRunsOut()}),1e3*o),b.sendGameState(b.EventType.Game_Result_Shown.key,"Result Shown")},l.showGameOverPopup=function(e){A.CURRENTSTATE=A.GAMESTATE.GAMEOVER,null==this.commonFun&&(this.commonFun=new S),this.scrollView=this.node.getChildByName("leaderBoard").getComponent(c),this.scrollViewContent=this.scrollView.content,this.gameController=e,this.gameController.unscheduleAllCallbacks(),this.gameController.powerupController.unscheduleAllCallbacks(),this.gameController.gameUiController.disableTouches(),this.node.active=!0,this.scrollViewContent.removeAllChildren();for(var t=[],r={name:"-----",isSelf:!1},o=0;o<=this.gameController.totalPlayers-1;o++)t.push(r);for(var n=0,i=this.gameController.totalPlayers-1;i>=0;i--)n<this.gameController.playerBoardData.length&&(t[i]=this.gameController.playerBoardData[n]),n++;for(var l=0;l<this.gameController.totalPlayers;l++){var a=C(this.banner);this.scrollViewContent.addChild(a),a.getComponent("LeaderBoardBanner").initialiseData(l,(this.gameController.totalPlayers-l)/this.gameController.totalPlayers,t[l],this)}var s=C(this.banner).getComponent(u).height*this.gameController.totalPlayers+10*this.gameController.totalPlayers;this.scrollViewContent.getComponent(u).height=s;for(var h=0,m=0;m<t.length;m++){t[m].isSelf&&(h=m+1)}1==h?(this.node.getChildByName("hud").getComponent(p).play("rayRotate"),this.node.getChildByName("hud").getChildByName("trophy").getComponent(d).spriteFrame=this.goldenTrophy,this.isWon=!0):(this.node.getChildByName("hud").getChildByName("trophy").getComponent(d).spriteFrame=this.normalTrophy,this.isWon=!1);this.node.getChildByName("hud").getChildByName("score").getComponent(y).string=this.gameController.playerClass._score.toString(),this.redirectingTimer=w.redirectingTimeout,this.schedule(this.startGameOverTimer,1),T.instance.updateHighScore(this.gameController.playerClass._score),b.sendGameState(b.EventType.Game_Result_Shown.key,"Result Shown")},l.startGameOverTimer=function(){if(B.instance.playSound(A.AUDIO_SOUND.buttonClick),this.redirectingTimer--,this.redirectingTimer<=0)return this.redirectingTimer=0,this.unschedule(this.startGameOverTimer),b.sendGameState(b.EventType.Game_App_Layer_Closed.key,"App Closed"),void A.callGameOver(this.gameController.playerClass._score,!1,this.isWon);if(T.instance.isMiloApp&&this.redirectingTimer==w.redirectingTimeout-2){var e=window.localStorage.getItem("SumouserId");T.instance.showXpEffect(e)}T.instance.isMiloApp?this.node.getChildByName("popup").getChildByName("redirectingLabel").getComponent(y).string="Redirecting to App in "+this.redirectingTimer:this.node.getChildByName("popup").getChildByName("redirectingLabel").getComponent(y).string="Redirecting to leaderBoard in "+this.redirectingTimer},l.onHomeClicked=function(){for(this.gameController.powerupController.unscheduleAllCallbacks();this.gameController.botController._totalPlayerArrayList.length>0;){var e=this.gameController.botController._totalPlayerArrayList[0];this.gameController.getWorld().removeChild(e),this.commonFun.removeObjectFromArray(this.gameController.botController._totalPlayerArrayList,e)}for(;this.gameController.gameOverList.length>0;){e=this.gameController.gameOverList[0];this.gameController.getWorld().removeChild(e),this.commonFun.removeObjectFromArray(this.gameController.gameOverList,e)}v.loadScene("MenuScene")},l.showGameOverFromServer=function(e,t){void 0===t&&(t="knockout"),this.gameStatus=t,b.sendGameState(b.EventType.Game_Play_End.key,"Completed"),this.gameController=e,this.gameController.unscheduleAllCallbacks(),this.currentList=[];var r={name:"-----",isSelf:!1};this.gameController.totalPlayers=this.gameController.getTotalPlayers();for(var o=0;o<=this.gameController.totalPlayers-1;o++)this.currentList.push(r);if("knockout"==this.gameStatus||"Eliminated"==this.gameStatus)for(var n=0,i=this.gameController.totalPlayers-1;i>=0;i--)n<this.gameController.playerBoardData.length&&(this.currentList[i]=this.gameController.playerBoardData[n]),n++;else for(var l=0;l<this.gameController.playerBoardData.length;l++)this.currentList[l]=this.gameController.playerBoardData[l];this.node.getChildByName("hud").getChildByName("score").getComponent(y).string=this.gameController.playerClass._score.toString(),T.instance.updateHighScore(this.gameController.playerClass._score),this.currentList[0].isSelf?this.showWinPopup(e):this.showGameOverPopupFromServer(e)},l.showGameOverPopupFromServer=function(e){null==this.commonFun&&(this.commonFun=new S),B.instance.playSound(A.AUDIO_SOUND.win),this.scrollView=this.node.getChildByName("leaderBoard").getComponent(c),this.scrollViewContent=this.scrollView.content,this.gameController=e,this.gameController.unscheduleAllCallbacks(),this.gameController.gameUiController.disableTouches(),this.node.active=!0,this.scrollViewContent.removeAllChildren();for(var t=0;t<this.gameController.totalPlayers;t++){var r=C(this.banner);this.scrollViewContent.addChild(r),r.getComponent("LeaderBoardBanner").initialiseData(t,(this.gameController.totalPlayers-t)/this.gameController.totalPlayers,this.currentList[t],this)}var o=C(this.banner).getComponent(u).height*this.gameController.totalPlayers+10*this.gameController.totalPlayers;this.scrollViewContent.getComponent(u).height=o;var n=0;this.currentList[0].isSelf&&(n=1),1==n?(this.node.getChildByName("hud").getChildByName("trophy").getComponent(d).spriteFrame=this.goldenTrophy,this.isWon=!0):(this.node.getChildByName("hud").getChildByName("trophy").getComponent(d).spriteFrame=this.normalTrophy,this.isWon=!1),this.node.getChildByName("hud").getChildByName("score").getComponent(y).string=this.gameController.playerClass._score.toString(),this.redirectingTimer=w.redirectingTimeout,this.schedule(this.startGameOverTimer,1),T.instance.updateHighScore(this.gameController.playerClass._score),b.sendGameState(b.EventType.Game_Result_Shown.key,"Result Shown")},t}(f)).prototype,"goldenTrophy",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=t(O.prototype,"normalTrophy",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=t(O.prototype,"banner",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=O))||F));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameUIController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./mxManager.ts","./GameConfig.ts","./constant.ts","./audioManager.ts","./SocketConnection.ts"],(function(e){"use strict";var t,i,n,o,a,r,l,s,d,c,u,h,p,g,m,y,C,f,S,b,E,v,w,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.defineProperty,o=e.assertThisInitialized,a=e.initializerDefineProperty},function(e){r=e.cclegacy,l=e._decorator,s=e.EventHandler,d=e.Node,c=e.Slider,u=e.SpriteFrame,h=e.LabelComponent,p=e.game,g=e.Animation,m=e.Vec3,y=e.macro,C=e.director,f=e.Sprite,S=e.Component},function(e){b=e.MxManager},function(e){E=e.GameConfig},function(e){v=e.constant},function(e){w=e.audioManager},function(e){T=e.SocketConnection}],execute:function(){var A,B,N,k,x,R,L,D,P,Y,M,O,G,I,X,U,Z,z,_,V,F,H,q,J,K,j,Q,W,$,ee,te,ie,ne;r._RF.push({},"62ee6KEwbpJNKAJo5TmXRgo","GameUIController",void 0);var oe=l.ccclass,ae=l.property;e("GameUIController",(A=oe("GameUIController"),B=ae({type:[s],tooltip:"Touch Drag"}),N=ae({type:[s],tooltip:"Slider Drag"}),k=ae({type:[s],tooltip:"gameStart"}),x=ae({type:[s],tooltip:"gameInitialise"}),R=ae({type:d}),L=ae({type:c}),D=ae({type:c}),P=ae({type:c}),Y=ae({type:c}),M=ae({type:c}),O=ae({type:c}),G=ae({type:d}),I=ae({type:d}),X=ae({type:u}),U=ae({type:u}),A((_=t((z=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,n(o(t),"startLoc",void 0),a(o(t),"touchEventCallBack",_,o(t)),a(o(t),"sliderEventCallBack",V,o(t)),a(o(t),"gameStartEventCallBack",F,o(t)),a(o(t),"gameInitialiseEventCallBack",H,o(t)),a(o(t),"cameraDebug",q,o(t)),a(o(t),"Yslider",J,o(t)),a(o(t),"Zslider",K,o(t)),a(o(t),"Xslider",j,o(t)),a(o(t),"RYslider",Q,o(t)),a(o(t),"RXslider",W,o(t)),a(o(t),"RZslider",$,o(t)),a(o(t),"initialLayer",ee,o(t)),a(o(t),"soundNode",te,o(t)),a(o(t),"soundOff",ie,o(t)),a(o(t),"soundOn",ne,o(t)),n(o(t),"animationTimer",0),n(o(t),"isPaused",void 0),n(o(t),"exitPopupShown",!1),n(o(t),"gameController",void 0),t}i(t,e);var r=t.prototype;return r.onLoad=function(){var e=this;v.CURRENTSTATE=v.GAMESTATE.GAMEPLAY,this.node.on(d.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(d.EventType.TOUCH_START,this.touchStart,this),this.node.on(d.EventType.TOUCH_END,this.touchEnded,this),window.localStorage.setItem("isStopped","1"),this.gameInitialiseEventCallBack.forEach((function(t){return t.emit([e])})),this.checkSounds(),E.debug.camera.isdebugEnabled&&(this.cameraDebug.active=!0),this.Yslider.node.on("slide",this.onslide,this),this.Yslider.progress=this.getSliderVal(E.debug.camera.YAxis,0,1,0,100),this.Yslider.node.getChildByName(this.Yslider.node.name).getComponent(h).string=E.debug.camera.YAxis.toString(),this.sliderEventCallBack.forEach((function(e){return e.emit(["YSlider",E.debug.camera.YAxis])})),this.Zslider.node.on("slide",this.onslide,this),this.Zslider.progress=this.getSliderVal(E.debug.camera.ZAxis,0,1,0,100),this.Zslider.node.getChildByName(this.Zslider.node.name).getComponent(h).string=E.debug.camera.ZAxis.toString(),this.sliderEventCallBack.forEach((function(e){return e.emit(["ZSlider",E.debug.camera.ZAxis])})),this.Xslider.node.on("slide",this.onslide,this),this.Xslider.progress=this.getSliderVal(E.debug.camera.XAxis,0,1,-100,100),this.Xslider.node.getChildByName(this.Xslider.node.name).getComponent(h).string=E.debug.camera.XAxis.toString(),this.sliderEventCallBack.forEach((function(e){return e.emit(["XSlider",E.debug.camera.XAxis])})),this.RYslider.node.on("slide",this.onslide,this),this.RYslider.progress=this.getSliderVal(E.debug.camera.Yangle,0,1,-360,360),this.RYslider.node.getChildByName(this.RYslider.node.name).getComponent(h).string=E.debug.camera.Yangle.toString(),this.sliderEventCallBack.forEach((function(e){return e.emit(["RYSlider",E.debug.camera.Yangle])})),this.RXslider.node.on("slide",this.onslide,this),this.RXslider.progress=this.getSliderVal(E.debug.camera.Xangle,0,1,-360,360),this.RXslider.node.getChildByName(this.RXslider.node.name).getComponent(h).string=E.debug.camera.Xangle.toString(),this.sliderEventCallBack.forEach((function(e){return e.emit(["RXSlider",E.debug.camera.Xangle])})),this.RZslider.node.on("slide",this.onslide,this),this.RZslider.progress=this.getSliderVal(E.debug.camera.Zangle,0,1,-360,360),this.RZslider.node.getChildByName(this.RZslider.node.name).getComponent(h).string=E.debug.camera.Zangle.toString(),this.sliderEventCallBack.forEach((function(e){return e.emit(["RZSlider",E.debug.camera.Zangle])})),window.localStorage.setItem("isStopped","1"),this.initialLayer.active=!0,b.instance.isMiloApp?T.instance.room.state.readyGoCount<=0&&(this.disableTutorial(),window.localStorage.setItem("isStopped","0")):(this.animationTimer=5,this.schedule(this.updateStartTimer,1)),p.on("commonEventInterface",(function(t){b.instance.isMiloApp||"backPressed"==t&&(v.CURRENTSTATE==v.GAMESTATE.GAMEPLAY?e.onCloseClicked():v.CURRENTSTATE==v.GAMESTATE.GAMEPLAYEXIT&&e.hideExitPopup())}),this)},r.checkReadyGoTimer=function(e){switch(e){case 4:w.instance.playSound(v.AUDIO_SOUND.countDown),this.initialLayer.getChildByName("countDown").getChildByName("3").active=!0;break;case 3:this.initialLayer.getChildByName("countDown").getChildByName("3").active=!1,this.initialLayer.getChildByName("countDown").getChildByName("2").active=!0;break;case 2:this.initialLayer.getChildByName("countDown").getChildByName("2").active=!1,this.initialLayer.getChildByName("countDown").getChildByName("1").active=!0;break;case 1:this.initialLayer.getChildByName("countDown").getChildByName("1").active=!1,this.initialLayer.getChildByName("countDown").getChildByName("go").active=!0;break;case 0:this.disableTutorial()}},r.disableTutorial=function(){var e=this;this.initialLayer.getChildByName("countDown").getChildByName("go").active=!1,b.instance.isMiloApp||this.unschedule(this.updateStartTimer),this.initialLayer.getComponent(g).stop(),this.initialLayer.active=!1,this.gameStartEventCallBack.forEach((function(t){return t.emit([e.node])}))},r.updateStartTimer=function(){this.animationTimer--,this.checkReadyGoTimer(this.animationTimer)},r.onslide=function(e){var t=0;t="YSlider"==e.node.name||"ZSlider"==e.node.name?this.getSliderVal(e.progress,0,100,0,1):"XSlider"==e.node.name?this.getSliderVal(e.progress,-100,100,0,1):("RZSlider"==e.node.name||e.node.name,this.getSliderVal(e.progress,-360,360,0,1)),e.node.getChildByName(e.node.name).getComponent(h).string=t,this.sliderEventCallBack.forEach((function(i){return i.emit([e.node.name,t])}))},r.getSliderVal=function(e,t,i,n,o){return(e-(n=n))/((o=o)-n)*((i=i)-(t=t))+t},r.onConnect=function(){},r.touchMove=function(e){if(!this.exitPopupShown&&!this.gameController.gameOverCalled){var t=e.getLocation(),i=new m(t.x-this.startLoc.x,t.y-this.startLoc.y);Math.sqrt(i.x*i.x+i.y*i.y)>200&&(this.startLoc=this.startLoc.lerp(t,.9),i=new m(t.x-this.startLoc.x,t.y-this.startLoc.y));var n=this.get_angle(this.startLoc.x,this.startLoc.y,t.x,t.y);this.touchEventCallBack.forEach((function(e){return e.emit([i,n])}))}},r.touchEnded=function(e){this.exitPopupShown||this.gameController.gameOverCalled||this.touchEventCallBack.forEach((function(e){return e.emit([new m(0,0,0)])}))},r.touchStart=function(e){this.exitPopupShown||this.gameController.gameOverCalled||(this.startLoc=e.getLocation(),this.touchMove(e))},r.get_angle=function(e,t,i,n){var o=n-t,a=i-e;return Math.atan2(o,a)*y.DEG},r.restartGame=function(){C.loadScene("GameScene")},r.pauseScreen=function(){this.isPaused?C.resume():C.pause(),this.isPaused=!this.isPaused},r.stopBotScreen=function(){parseInt(window.localStorage.getItem("isStopped"))?window.localStorage.setItem("isStopped","0"):window.localStorage.setItem("isStopped","1")},r.disableTouches=function(){this.exitPopupShown=!0},r.onCloseClicked=function(){this.exitPopupShown||(w.instance.playSound(v.AUDIO_SOUND.buttonClick),this.exitPopupShown=!0,this.showExitPopup())},r.checkSounds=function(){v.CheckSoundEnabled()?this.soundNode.getComponent(f).spriteFrame=this.soundOn:this.soundNode.getComponent(f).spriteFrame=this.soundOff},r.onSoundClicked=function(){w.instance.toggleGameSound()?(this.soundNode.getComponent(f).spriteFrame=this.soundOn,w.instance.playSound(v.AUDIO_SOUND.buttonClick)):this.soundNode.getComponent(f).spriteFrame=this.soundOff},r.showExitPopup=function(){v.CURRENTSTATE=v.GAMESTATE.GAMEPLAYEXIT;var e=this.node.getChildByName("exitPopup").getComponent(g);e.play("showExit");var t=e.getState("showExit").duration;setTimeout((function(){e.play("exitPopupAnimation")}),3e3*t)},r.hideExitPopup=function(){v.CURRENTSTATE=v.GAMESTATE.GAMEPLAY,w.instance.playSound(v.AUDIO_SOUND.buttonClick),this.exitPopupShown=!1,this.node.getChildByName("exitPopup").getComponent(g).play("hideExit")},r.onExitYesClicked=function(){w.instance.playSound(v.AUDIO_SOUND.buttonClick),v.callGameOver(this.gameController.playerClass._score,!0,!1),b.instance.isMiloApp&&T.instance.quitGame()},t}(S)).prototype,"touchEventCallBack",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=t(z.prototype,"sliderEventCallBack",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=t(z.prototype,"gameStartEventCallBack",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=t(z.prototype,"gameInitialiseEventCallBack",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=t(z.prototype,"cameraDebug",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=t(z.prototype,"Yslider",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=t(z.prototype,"Zslider",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=t(z.prototype,"Xslider",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=t(z.prototype,"RYslider",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=t(z.prototype,"RXslider",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=t(z.prototype,"RZslider",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=t(z.prototype,"initialLayer",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),te=t(z.prototype,"soundNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(z.prototype,"soundOff",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(z.prototype,"soundOn",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=z))||Z));r._RF.pop()}}}));

System.register("chunks:///_virtual/skin.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./constant.ts","./audioManager.ts"],(function(e){"use strict";var t,i,s,o,n,r,a,l,h,c,d,p,u,m,C,g,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,s=e.initializerDefineProperty,o=e.assertThisInitialized,n=e.defineProperty},function(e){r=e.cclegacy,a=e._decorator,l=e.SpriteFrame,h=e.Sprite,c=e.Label,d=e.instantiate,p=e.Vec3,u=e.MeshRenderer,m=e.SkeletalAnimationComponent,C=e.Component},function(e){g=e.constant},function(e){y=e.audioManager}],execute:function(){var N,B,k,v,A,_,f;r._RF.push({},"6600e5OvP9NWrjDLoyv1uoe","skin",void 0);var P=a.ccclass,b=a.property;e("Skin",(N=P("Skin"),B=b({type:l}),k=b({type:l}),N((_=t((A=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,s(o(t),"defaultFrame",_,o(t)),s(o(t),"accessoriesFrame",f,o(t)),n(o(t),"skinName",null),n(o(t),"skinType",null),n(o(t),"count",null),n(o(t),"isActive",!0),n(o(t),"isEquipped",!1),n(o(t),"shopController",null),n(o(t),"type",null),n(o(t),"currentIndex",0),t}i(t,e);var r=t.prototype;return r.start=function(){},r.initialiseData=function(e,t,i){this.shopController=i;var s=this.shopController.menuController.playerData;if(this.currentIndex=t,this.type=g.ACCESSORIESTYPE.OTHER,t==g.getAccessories().length)return this.isActive=!1,this.count=t,this.node.getChildByName("image").getComponent(h).spriteFrame=this.defaultFrame,void(this.node.getChildByName("commingSoon").active=!0);switch(this.isEquipped=!1,this.isActive=e.unlocked,this.skinType=e.type,this.count=e.count,this.skinName=e.name,-1==s.bag&&-1==s.headPhone&&-1==s.goggles&&-1==s.target&&0==e.type&&(this.isEquipped=!0),this.node.getChildByName("name").getComponent(c).string=this.skinName,e.type){case 0:this.node.getChildByName("image").getComponent(h).spriteFrame=this.defaultFrame,this.node.getChildByName("disableIcon").active=!0;break;default:this.node.getChildByName("image").getComponent(h).spriteFrame=this.accessoriesFrame}switch(e.unlocked||(this.node.getChildByName("lockIcon").active=!0),e.type){case 1:var o=d(this.shopController.bagAcceesories[e.count].model);this.node.getChildByName("Plane").getChildByName("characterNode").addChild(o),o.setPosition(new p(0,0,0)),s.bag==e.count&&(this.isEquipped=!0);break;case 2:var n=d(this.shopController.headPhoneAcceesories[e.count].model);this.node.getChildByName("Plane").getChildByName("characterNode").addChild(n),n.setPosition(new p(0,0,0)),s.headPhone==e.count&&(this.isEquipped=!0);break;case 3:var r=d(this.shopController.gogglesAcceesories[e.count].model);this.node.getChildByName("Plane").getChildByName("characterNode").addChild(r),r.setPosition(new p(0,0,0)),s.goggles==e.count&&(this.isEquipped=!0);break;case 4:var a=d(this.shopController.targetAcceesories[e.count].model);this.node.getChildByName("Plane").getChildByName("characterNode").addChild(a),a.setPosition(new p(0,0,0)),s.target==e.count&&(this.isEquipped=!0);break;default:this.node.getChildByName("costumes").getComponent(h).spriteFrame}this.node.getChildByName("equipped").active=this.isEquipped},r.onEquipClicked=function(){if(this.isActive){if(y.instance.playSound(g.AUDIO_SOUND.buttonClick),0==this.skinType){for(this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01").active=!1,this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01").active=!1,this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01").active=!1,this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("accessories_target_01").active=!1,e=1;e<5;e++)this.shopController.updatePlayerAccessoriesData(e,-1);for(var e=0;e<this.shopController.accessoriesArray.length;e++){if(this.shopController.accessoriesArray[e]!=this.node)(s=this.shopController.accessoriesArray[e].getComponent("Skin")).isEquipped=!1,this.shopController.accessoriesArray[e].getChildByName("equipped").active=!1}return}var t=null,i=null;switch(this.skinType){case 1:t=this.shopController.bagAcceesories[this.count],i=this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("Chest_M Socket").getChildByName("accessories_schoolbag_01");break;case 2:t=this.shopController.headPhoneAcceesories[this.count],i=this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_headset01");break;case 3:t=this.shopController.gogglesAcceesories[this.count],i=this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("Head_M Socket").getChildByName("accessories_glasses_01");break;case 4:t=this.shopController.targetAcceesories[this.count],i=this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getChildByName("accessories_target_01")}if(this.isEquipped)this.shopController.updatePlayerAccessoriesData(this.skinType,-1),i.active=!1,this.node.getChildByName("equipped").active=!1;else{this.shopController.updatePlayerAccessoriesData(this.skinType,this.count),i.getComponent(u).setMaterial(t.material,0),i.active=!0,this.node.getChildByName("equipped").active=!0;for(e=0;e<this.shopController.accessoriesArray.length;e++){var s;(s=this.shopController.accessoriesArray[e].getComponent("Skin")).skinType!=this.skinType&&0!=s.skinType||this.shopController.accessoriesArray[e]!=this.node&&(s.isEquipped=!1,this.shopController.accessoriesArray[e].getChildByName("equipped").active=!1)}var o=this.shopController.menuController.sumo.getChildByName("Penguine_Anim").getComponent(m);o.play("push"),setTimeout((function(){o.play("idle")}),1e3*o.getState("push").duration)}this.isEquipped=!this.isEquipped}else this.shopController.onShowBuyPopup(this)},t}(C)).prototype,"defaultFrame",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=t(A.prototype,"accessoriesFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=A))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/resourceUtil.ts",["cc"],(function(e){"use strict";var t,a,r,n,i,o,s,c,u,f,l;return{setters:[function(e){t=e.cclegacy,a=e._decorator,r=e.resources,n=e.error,i=e.Prefab,o=e.instantiate,s=e.find,c=e.SpriteFrame,u=e.isValid,f=e.assetManager,l=e.Texture2D}],execute:function(){var d;t._RF.push({},"72d81EUKidGMoH83ElFuppM","resourceUtil",void 0);var g=a.ccclass;e("resourceUtil",g("resourceUtil")(d=function(){function e(){}return e.loadRes=function(e,t,a){t?r.load(e,t,(function(e,t){if(e)return n(e.message||e),void(a&&a(e,t));a&&a(e,t)})):r.load(e,(function(e,t){if(e)return n(e.message||e),void(a&&a(e,t));a&&a(e,t)}))},e.getMap=function(e,t){var a="map";a+=e>=100?e:e>=10?"0"+e:"00"+e,this.loadRes("gamePackage/map/config/"+a,null,(function(e,a){if(e)t(e,a);else{var r=a,n="";if(r._file){window.LZString&&(n=window.LZString.decompressFromEncodedURIComponent(r._file));var i=JSON.parse(n);t(null,i)}else if(r.text){window.LZString&&(n=window.LZString.decompressFromEncodedURIComponent(r.text));var o=JSON.parse(n);t(null,o)}else if(r.json)t(null,r.json);else{var s=new Error("failed");t(s,null)}}}))},e.getMapObjs=function(e,t,a,n){for(var o=[],s=0;s<t.length;s++)o.push("gamePackage/map/"+e+"/"+t[s]);r.load(o,i,a,n)},e.getUIPrefabRes=function(e,t){this.loadRes("prefab/ui/"+e,i,t)},e.createUI=function(e,t,a){this.getUIPrefabRes(e,(function(e,r){if(!e){var n=o(r);n.setPosition(0,0,0),a||(a=s("Canvas")),a.addChild(n),t&&t(null,n)}}))},e.getCarsBatch=function(e,t,a){for(var n=[],o=0;o<e.length;o++)n.push("prefab/car/car"+e[o]);for(var s=0;s<n.length;s++){var c=n[s];t?r.load(c,i,t,a):r.load(c,i,a)}},e.getUICar=function(e,t){this.loadRes("prefab/ui/car/uiCar"+e,i,t)},e.getCar=function(e,t){this.loadRes("prefab/car/car"+e,i,t)},e.setCarIcon=function(e,t,a,r){var n="gamePackage/texture/car/car"+e;a&&(n+="Black"),this.setSpriteFrame(n,t,r)},e.getJsonData=function(e,t){r.load("datas/"+e,(function(e,a){if(e)n(e.message||e);else{var r=a;if(r.json)t(e,r.json);else{var i=new Error("failed!!!");t(i,null)}}}))},e.getData=function(e,t){r.load("datas/"+e,(function(e,a){if(e)n(e.message||e);else{var i=a.text;i?t(e,i):r.load(a.nativeUrl,(function(e,a){t(e,i=a)}))}}))},e.setSpriteFrame=function(e,t,a){this.loadRes(e+"/spriteFrame",c,(function(r,n){if(r)return console.error("set sprite frame failed! err:",e,r),void a(r,n);t&&u(t)&&(t.spriteFrame=n,a(null,n))}))},e.setRemoteImage=function(e,t,a){if(e&&e.startsWith("http")){f.loadAny([{url:e,type:"png"}],null,(function(t,r){if(t)return console.error("set avatar failed! err:",e,t),void a(t,r);var n=new l;n.image=r;var i=new c;i.texture=n,a&&a(null,i)}))}},e.setGameIcon=function(e,t,a){e.startsWith("http")?this.setRemoteImage(e,t,a):this.setSpriteFrame("gamePackage/textures/icons/games/"+e,t,a)},e.getCustomer=function(e,t){this.loadRes("gamePackage/map/customer/customer"+e,i,t)},e.setCustomerIcon=function(e,t,a){var r="gamePackage/texture/head/head"+e;this.setSpriteFrame(r,t,a)},e.getEffect=function(e,t){this.loadRes("prefab/effect/"+e,i,t)},e}())||d);t._RF.pop()}}}));

System.register("chunks:///_virtual/oneToMultiListener.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(r){"use strict";var t,e,n,o;return{setters:[function(r){t=r.defineProperty},function(r){e=r.cclegacy,n=r._decorator,o=r.error}],execute:function(){var i,a,s;e._RF.push({},"74771reetNC7orLrC+JqiYw","oneToMultiListener",void 0);var u=n.ccclass;r("oneToMultiListener",u("oneToMultiListener")((s=a=function(){function r(){}return r.on=function(r,t,e){var n={handler:t,target:e},o=this.handlers[r];o||(o=[],this.handlers[r]=o);for(var i=0;i<o.length;i++)if(!o[i])return o[i]=n,i;return o.push(n),o.length},r.off=function(r,t,e){var n=this.handlers[r];if(n)for(var o=0;o<n.length;o++){var i=n[o];if(i.handler===t&&(!e||e===i.target)){n.splice(o,1);break}}},r.dispatchEvent=function(r){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];var o,i=this.handlers[r];for(o=1;o<arguments.length;o++);if(i)for(o=0;o<i.length;o++){var a=i[o];a.handler&&a.handler.apply(a.target,e)}},r.setSupportEventList=function(r){if(!(r instanceof Array))return o("supportEvent was not array"),!1;for(var t in this.supportEvent={},r){var e=r[t];this.supportEvent[e]=t}return!0},r}(),t(a,"handlers",void 0),t(a,"supportEvent",void 0),i=s))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/constant.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./commonFun.ts","./encryption.ts","./mxManager.ts","./GameConfig.ts"],(function(n){"use strict";var e,o,t,a,i,c;return{setters:[function(n){e=n.defineProperty},function(n){o=n.cclegacy},function(n){t=n.CommonFun},function(n){a=n.encryption},function(n){i=n.MxManager},function(n){c=n.GameConfig}],execute:function(){o._RF.push({},"75aa7MrT7lGP5RLq0y7jGcP","constant",void 0);var r=[{type:0,unlocked:!0,name:"none",count:-1},{type:1,unlocked:!0,name:"Bee Pack",count:0},{type:2,unlocked:!0,name:"Groover",count:0},{type:3,unlocked:!0,name:"Shades",count:0},{type:4,unlocked:!0,name:"Aim Pack",count:0}],l=[{unlocked:!0,name:"penguin"},{unlocked:!0,name:"The Butler"},{unlocked:!0,name:"Mr Clean"}],u=[{unlocked:!0,name:"Snapper"},{unlocked:!0,name:"Shrooms"}],d=n("constant",function(){function n(){}return n.getAccessories=function(){return r},n.getSkin=function(){return l},n.getFood=function(){return u},n.updateAccessories=function(n,e){n==this.ACCESSORIESTYPE.OTHER&&(r[e].unlocked=!0),n==this.ACCESSORIESTYPE.SKIN&&(l[e].unlocked=!0),n==this.ACCESSORIESTYPE.FOOD&&(u[e].unlocked=!0)},n.isMiloEnabled=function(){return i.instance.isMiloApp},n.setCoinBalance=function(n){window.localStorage.setItem("coinBalance",n)},n.getCoinBalance=function(){return null!=window.localStorage.getItem("coinBalance")&&null!=window.localStorage.getItem("coinBalance")||window.localStorage.setItem("coinBalance","0"),parseInt(window.localStorage.getItem("coinBalance"))},n.CheckSoundEnabled=function(){return null!=window.localStorage.getItem("soundEnabled")&&null!=window.localStorage.getItem("soundEnabled")||window.localStorage.setItem("soundEnabled","1"),parseInt(window.localStorage.getItem("soundEnabled"))},n.ToggleSound=function(){return parseInt(window.localStorage.getItem("soundEnabled"))?window.localStorage.setItem("soundEnabled","0"):window.localStorage.setItem("soundEnabled","1"),this.CheckSoundEnabled()},n.callGameOver=function(n,e,o){var r=new t,l=c.scoringMultiplayer.winningPoint,u=i.instance.getHighScore()+c.scoringMultiplayer.winningPoint;e?(l=c.scoringMultiplayer.quittingPoint,u=i.instance.getHighScore()+c.scoringMultiplayer.quittingPoint):o?(l=c.scoringMultiplayer.winningPoint,u=i.instance.getHighScore()+c.scoringMultiplayer.winningPoint):(l=c.scoringMultiplayer.losingPoint,u=i.instance.getHighScore()+c.scoringMultiplayer.losingPoint);var d=(new Date).getTime(),s={currentScore:l,highScore:u,playTime:Math.floor(r.convertMiliToSecond(d-i.instance.playTime)),adGameStartOpportunity:i.instance.adGameStartOpportunity,adGameStartShown:i.instance.adGameStartShown,adGameStartClaimed:i.instance.adGameStartClaimed,adGameEndOpportunity:i.instance.adGameEndOpportunity,adGameEndShown:i.instance.adGameEndShown,adGameEndClaimed:i.instance.adGameEndClaimed,adGamePowerupClaimed:i.instance.adGamePowerupClaimed};i.instance.onTrack(s,"gameExit");var g={score:l,highScore:u,info:a.getInfo(l,Math.floor(r.convertMiliToSecond(d-i.instance.playTime)),0)};i.instance.onGameOver(g)},n}());e(d,"ACCESSORIESTYPE",{FOOD:"food",SKIN:"skin",OTHER:"other"}),e(d,"AUDIO_SOUND",{BACKGROUND:"background",buttonClick:"click",countDown:"countDown",gainPowerUp:"gainPowerUp",poisonPowerUp:"poisonPowerUp",speedPowerUp:"speedPowerUp",slowPowerUp:"slowPowerUp",sheildPowerUp:"sheildPowerUp",myDeath:"myDeath",otherDeath:"otherDeath",foodEat:"foodEat",push:"push",win:"win"}),e(d,"GAMESTATE",{MAINMENU:0,MAINMENUEXIT:1,MAINMENUSHOP:2,MAINMENUSHOPBUY:3,GAMEPLAY:4,GAMEPLAYEXIT:5,GAMEOVER:6}),e(d,"CURRENTSTATE",d.GAMESTATE.MAINMENU),e(d,"TEXT",{WATCHAD:"Watch ad to unlock @ for next Play?",BUYCOIN:"Use # coins to unlock @ for next Play?"}),o._RF.pop()}}}));

System.register("chunks:///_virtual/Bot.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./commonFun.ts","./GameConfig.ts","./Helper.ts"],(function(e){"use strict";var t,i,n,o,s,r,a,h,l,c,u,m,d,p,g,S,C,P;return{setters:[function(e){t=e.inheritsLoose,i=e.defineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,r=e.geometry,a=e.Vec3,h=e.instantiate,l=e.SkeletalAnimationComponent,c=e.CapsuleCollider,u=e.RigidBodyComponent,m=e.tween,d=e.Vec2,p=e.randomRange,g=e.Component},function(e){S=e.CommonFun},function(e){C=e.GameConfig},function(e){P=e.STATE}],execute:function(){var v;o._RF.push({},"77e533EezxA/6Pf2Q54j4sW","Bot",void 0);var _=s.ccclass,f=(s.property,.016);r.Ray,e("Bot",_("Bot")(v=function(e){function o(){for(var t,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,i(n(t),"_charName","sush"),i(n(t),"_isPlayer",!1),i(n(t),"_now_time",0),i(n(t),"_movement",a.ZERO),i(n(t),"_skeletal",void 0),i(n(t),"_currentState",P.IDLE),i(n(t),"player",null),i(n(t),"_playerList",[]),i(n(t),"playerName",void 0),i(n(t),"playerCamera",void 0),i(n(t),"_vector",a.ZERO),i(n(t),"gameController",void 0),i(n(t),"powerUpController",void 0),i(n(t),"eatTimeout",null),i(n(t),"currentDistance",0),i(n(t),"_maxWallDistance",3),i(n(t),"_currentFollowingNode",null),i(n(t),"_isPoisionSpeedActive",!1),i(n(t),"_isGainSpeedActive",!1),i(n(t),"_isSheildActive",!1),i(n(t),"_poisionSpeedActiveCount",0),i(n(t),"_gainSpeedActiveCount",0),i(n(t),"_sheildActiveCount",0),i(n(t),"_poisionSpeedActivePercentage",0),i(n(t),"_gainSpeedActivePercentage",0),i(n(t),"botType",""),i(n(t),"initialSize",0),i(n(t),"maxSize",0),i(n(t),"startSpeed",0),i(n(t),"endspeed",0),i(n(t),"criticalMass",0),i(n(t),"maxScale",0),i(n(t),"currentScale",0),i(n(t),"speed",0),i(n(t),"bumpTween",null),i(n(t),"bumptimeTween",null),i(n(t),"characterHud",null),i(n(t),"_collidedOpponentPlayer",null),i(n(t),"_score",0),i(n(t),"_totalSumoPushed",0),i(n(t),"_newBumpPosition",a.ZERO),i(n(t),"commonFun",null),i(n(t),"_currentAngle",0),i(n(t),"outsideCount",0),i(n(t),"_currentRangeAngle",null),t}t(o,e);var s=o.prototype;return s.addName=function(e,t,i){this.commonFun=new S,this.playerName=h(e),t.addChild(this.playerName),this.gameController=i,this._charName=this.commonFun.getNames(),this.characterHud=this.playerName.getComponent("CharacterHud"),this.characterHud.updateNameData(this._charName),this.schedule(this.powerUpUpdates,1)},s.updateNamePos=function(){var e=this.node.getPosition();this.characterHud.updateHudPos(e,this.playerCamera)},s.setProperties=function(e){this._isPlayer=!1,this.botType=e,this.initialSize=C.bot.initialSize,this.maxSize=C.bot.botMaxSize,this.startSpeed=C.bot.botConfig[this.botType].botStartSpeed,this.endspeed=C.bot.botConfig[this.botType].botEndSpeed,this.criticalMass=C.bot.botConfig[this.botType].criticalMass,this._skeletal=this.node.getChildByName("Penguine_Anim").getComponent(l),this.commonFun.setIdleStateAnimation(this),this.setCurrentScale(this.initialSize),this.node.scale.set(this.currentScale,this.currentScale,this.currentScale),this.maxScale=this.maxSize,this.updateSpeed(),this.updateNamePos()},s.updateSpeed=function(){this.speed=this.commonFun.getNewModifiedSpeed(this.getCurrentScale(),this),this.commonFun.changeWalkAnimationSpeed(this.speed,this)},s.getSpeed=function(){return this.speed},s.start=function(){this.node.getComponent(c).on("onCollisionEnter",this._onCollisionEnter,this)},s.removeAllHud=function(){this.gameController.getWorld().removeChild(this.playerName)},s.onCollisioncapsuleCollider=function(){if(null!=this._collidedOpponentPlayer){var e=null==this._collidedOpponentPlayer.getComponent("Bot")?this._collidedOpponentPlayer.getComponent("Player"):this._collidedOpponentPlayer.getComponent("Bot"),t=this.getCurrentScale(),i=e.getCurrentScale(),n=i;if(t<i)n=this.commonFun.harmonicMean([t,i])-t;else if(t>i)n=2*(this.commonFun.harmonicMean([t,i])-i);else{n=0;var o=C.powerup.GummyBear.gainPercentage;e.resize(o,!0)}n>0&&e.increasePlayerScaleOnOpponentDeath(n),e.updateScore(C.commonData.deathScore),e._totalSumoPushed++}this.commonFun.removeObjectFromArray(this._playerList,this.node),this.commonFun.removeObjectFromArray(this.gameController.botController._totalPlayerArrayList,this.node),this._currentState=P.BUMP,this.gameController.getWorld().removeChild(this.node);var s=new Date,r={name:this._charName,time:s.getTime(),isSelf:!1};this.gameController.playerBoardData.push(r)},s.OnUpdateCollision=function(e){var t=this;if(null==this._collidedOpponentPlayer||this._collidedOpponentPlayer.uuid!=e.uuid){var i=e;if("Player"==i.name||"Bot"==i.name||"player"==i.name||"bot"==i.name){this._currentRangeAngle=null,this.commonFun.setBumpStateAnimation(this),this._collidedOpponentPlayer=i,this.getComponent(u).clearVelocity();var n=new a(this.node.getPosition().x-i.getPosition().x,0,this.node.getPosition().z-i.getPosition().z).normalize(),o=this.getBumpValue(i),s=new a(this.node.getPosition().x+o*n.x,this.node.getPosition().z+o*n.z);this._newBumpPosition=new a(s.x,this.node.getPosition().y,s.y),null!=this.bumpTween&&(this.bumpTween.stop(),clearTimeout(this.bumptimeTween)),this.bumpTween=m(this.node).to(C.commonData.bumpTime,{position:this._newBumpPosition}).start(),this.bumptimeTween=setTimeout((function(){t.getComponent(u).clearVelocity(),t.bumptimeTween=null,t.commonFun.setWalkStateAnimation(t),t.bumptimeTween=setTimeout((function(){t._collidedOpponentPlayer=null}),1e3*C.commonData.bumpTime)}),1e3*C.commonData.bumpTime)}}},s.onCollisionTrigger=function(e){var t=this,i=e.otherCollider;if("Player"==i.node.name||"Bot"==i.node.name||"player"==i.node.name||"bot"==i.node.name){this.commonFun.setBumpStateAnimation(this),this._collidedOpponentPlayer=i.node,this.getComponent(u).clearVelocity();var n=new a(this.node.getPosition().x-i.node.getPosition().x,0,this.node.getPosition().z-i.node.getPosition().z).normalize(),o=this.getBumpValue(i.node),s=new a(this.node.getPosition().x+o*n.x,this.node.getPosition().z+o*n.z);this._newBumpPosition=new a(s.x,this.node.getPosition().y,s.y),null!=this.bumpTween&&(this.bumpTween.stop(),clearTimeout(this.bumptimeTween)),this.bumpTween=m(this.node).to(C.commonData.bumpTime,{position:this._newBumpPosition}).start(),this.bumptimeTween=setTimeout((function(){t.getComponent(u).clearVelocity(),t.bumptimeTween=null,t.commonFun.setWalkStateAnimation(t),t.bumptimeTween=setTimeout((function(){t._collidedOpponentPlayer=null}),1e3*C.commonData.bumpTime)}),1e3*C.commonData.bumpTime)}},s._onCollisionEnter=function(e){var t=e.otherCollider;if("platform"!=t.node.name){if("GummyBear"==t.node.name){this.gameController.powerupController.removeGummy(t);var i=C.powerup[t.node.name].gainPercentage;this.resize(i,!0),this.updateScore(C.powerup[t.node.name].score)}if(!(this.checkSheildActive()||this.checkGainSpeedActive()||this.checkPoisionSpeedActive())){if("PoisionSize"==t.node.name){this.gameController.powerupController.removeGummy(t);var n=C.powerup[t.node.name].lossPercentage;this.resize(n,!1),this.updateScore(C.powerup[t.node.name].score)}if("PoisionSpeed"==t.node.name){this.gameController.powerupController.removeGummy(t);var o=C.powerup[t.node.name].lossSpeedPercentage,s=C.powerup[t.node.name].duration;this.reEvaluateSpeed(o,s,!1),this.updateScore(C.powerup[t.node.name].score)}if("GainSpeed"==t.node.name){this.gameController.powerupController.removeGummy(t);var r=C.powerup[t.node.name].increaseSpeedPercentage,a=C.powerup[t.node.name].duration;this.reEvaluateSpeed(r,a,!0),this.updateScore(C.powerup[t.node.name].score)}if("Sheild"==t.node.name){this.gameController.powerupController.removeGummy(t);var h=C.powerup[t.node.name].duration;this.startSheild(h),this.updateScore(C.powerup[t.node.name].score)}}}},s.updateScore=function(e){this._score=this._score+e,this._score<0&&(this._score=0)},s.increasePlayerScaleOnOpponentDeath=function(e){var t=this;this.getCurrentScale()<=this.maxScale&&(this.setCurrentScale(this.getCurrentScale()+e),this.getCurrentScale()>this.maxScale&&this.setCurrentScale(this.maxScale),m(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){t.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale()))},s.startSheild=function(e){this.commonFun.setPowerGainAnimation(this),this._sheildActiveCount+=e,this._isSheildActive=!0},s.checkGainSpeedActive=function(){return this._isGainSpeedActive},s.checkPoisionSpeedActive=function(){return this._isPoisionSpeedActive},s.checkSheildActive=function(){return this._isSheildActive},s.reEvaluateSpeed=function(e,t,i){if(i){if(this._isGainSpeedActive)return this._isPoisionSpeedActive=!1,this._isGainSpeedActive=!1,this._poisionSpeedActiveCount=0,void(this._gainSpeedActiveCount=0);this._poisionSpeedActivePercentage=e,this._poisionSpeedActiveCount+=t,this._isPoisionSpeedActive=!0,this.speed=this.speed+this.commonFun.getPercentage(100*e,this.speed),this.commonFun.setPowerGainAnimation(this),this.commonFun.changeWalkAnimationSpeed(this.speed,this)}else{if(this._isPoisionSpeedActive)return this._isPoisionSpeedActive=!1,this._isGainSpeedActive=!1,this._poisionSpeedActiveCount=0,void(this._gainSpeedActiveCount=0);this._gainSpeedActivePercentage=e,this._gainSpeedActiveCount+=t,this._isGainSpeedActive=!0,this.speed=this.speed-this.commonFun.getPercentage(100*e,this.speed),this.commonFun.setPowerLoseAnimation(this),this.commonFun.changeWalkAnimationSpeed(this.speed,this)}},s.powerUpUpdates=function(){this._isPoisionSpeedActive&&this._poisionSpeedActiveCount>0&&(this._poisionSpeedActiveCount--,this._poisionSpeedActiveCount<=0&&(this._poisionSpeedActiveCount=0,this._isPoisionSpeedActive=!1)),this._isGainSpeedActive&&this._gainSpeedActiveCount>0&&(this._gainSpeedActiveCount--,this._gainSpeedActiveCount<=0&&(this._gainSpeedActiveCount=0,this._isGainSpeedActive=!1)),this._isSheildActive&&this._sheildActiveCount>0&&(this._sheildActiveCount--,this._sheildActiveCount<=0&&(this._sheildActiveCount=0,this._isSheildActive=!1))},s.resize=function(e,t){var i=this;t?this.getCurrentScale()<=this.maxScale&&(this.setCurrentScale(this.getCurrentScale()+this.commonFun.getPercentage(100*e,this.currentScale)),this.getCurrentScale()>this.maxScale&&this.setCurrentScale(this.maxScale),m(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){i.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale()),this.commonFun.setPowerGainAnimation(this)):this.getCurrentScale()>this.initialSize&&(this.setCurrentScale(this.getCurrentScale()-this.commonFun.getPercentage(100*e,this.currentScale)),this.getCurrentScale()<this.initialSize&&this.setCurrentScale(this.initialSize),m(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){i.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale()),this.commonFun.setPowerLoseAnimation(this))},s.getBumpValue=function(e){var t=this;if(this.checkSheildActive())return 0;var i=null==e.getComponent("Bot")?e.getComponent("Player"):e.getComponent("Bot"),n=this.getCurrentScale();n=this.getBumpSize(),this.getCurrentScale()>this.initialSize&&(this.setCurrentScale(this.getCurrentScale()-n),this.getCurrentScale()<this.initialSize&&this.setCurrentScale(this.initialSize),m(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){t.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale())),this.updateSpeed();var o=(this.getCurrentScale()+this.getSpeed())*i.getCurrentScale()-this.getCurrentScale();return this.getCurrentScale()<i.getCurrentScale()&&(o*=1.5),this.checkDidBumpedOnBck(e)&&(o=(this.getCurrentScale()+this.getSpeed())*i.getCurrentScale(),o*=C.commonData.playerBumpMe),this.isPlayerBumpedOnOtherBack(e)&&(o=(this.getCurrentScale()+this.getSpeed())*i.getCurrentScale(),o*=C.commonData.meBumpPlayer),o},s.getBumpSize=function(){return this.commonFun.getPercentage(C.commonData.bumpSizeDecreasePercentage,this.getCurrentScale())},s.getCurrentScale=function(){return this.currentScale},s.setCurrentScale=function(e){this.currentScale=e},s.getMaxScale=function(){return this.maxScale},s.update=function(e){if(!parseInt(window.localStorage.getItem("isStopped")))for(this._now_time+=e;this._now_time>=f;)this.fix_update(f),this._now_time-=f},s.getDistance=function(e,t,i,n){var o=e-i,s=t-n;return Math.sqrt(Math.pow(o,2)+Math.pow(s,2))},s.inside=function(e,t){for(var i=e.x,n=e.y,o=!1,s=0,r=t.length-1;s<t.length;r=s++){var a=t[s].x,h=t[s].z,l=t[r].x,c=t[r].z;h>n!=c>n&&i<(l-a)*(n-h)/(c-h)+a&&(o=!o)}return o},s.fix_update=function(e){if(this.updateNamePos(),!this.gameController.gameOverCalled&&this._currentState!=P.BUMP){if(this.inside(new d(this.node.position.x,this.node.position.z),this.gameController.platformVertices))this.outsideCount=0;else if(this.outsideCount++,this.outsideCount>=10)return this.onCollisioncapsuleCollider(),this.node.scale.set(.5,.5,.5),void this._skeletal.play("idle");if(this._vector=this.checkBotLogic(),null!=this._vector){var t=new a(this._vector.x-this.node.getPosition().x,this._vector.y-this.node.getPosition().y,this._vector.z-this.node.getPosition().z),i=180*Math.atan2(t.x,t.z)/Math.PI;this.node.eulerAngles=new a(0,i,0),this.getDistance(this._vector.x,this._vector.z,this.node.getPosition().x,this.node.getPosition().z)>0?(t.normalize(),this._movement=t,this._currentState==P.IDLE&&this.commonFun.setWalkStateAnimation(this)):(this._movement=a.ZERO,this._currentState==P.WALK&&this.commonFun.setIdleStateAnimation(this));var n=this.getSpeed();this._isPoisionSpeedActive&&this._poisionSpeedActiveCount>0&&(n+=this.commonFun.getPercentage(100*this._poisionSpeedActivePercentage,this.speed)),this._isGainSpeedActive&&this._gainSpeedActiveCount>0&&(n+=this.commonFun.getPercentage(100*this._gainSpeedActivePercentage,this.speed)),this.node.setPosition(this.node.position.add3f(this._movement.x*n*e,0,this._movement.z*n*e))}}},s.checkBotLogic=function(){if(null!=this._currentFollowingNode){if((this._currentFollowingNode.getComponent("Bot")||this._currentFollowingNode.getComponent("Player"))&&this.getCurrentScale()>this.criticalMass){for(var e=!1,t=0;t<this._playerList.length;t++)this._playerList[t]==this._currentFollowingNode&&(e=!0);if(e){var i=(null==this._currentFollowingNode.getComponent("Bot")?this._currentFollowingNode.getComponent("Player"):this._currentFollowingNode.getComponent("Bot")).getCurrentScale();if(this.getCurrentScale()>=i)return this._currentFollowingNode.getPosition()}}if("GummyBear"==this._currentFollowingNode.name&&this._currentFollowingNode.active)return this._currentFollowingNode.getPosition()}var n=this.checkPowerUpDistance("GummyBear"),o=(this.checkPowerUpDistance("PoisionSize"),this.checkPowerUpDistance("PoisionSpeed"),this.checkPowerUpDistance("GainSpeed")),s=this.checkPowerUpDistance("Sheild"),r=this.checkOtherPlayerPosition();if(null!=s&&"hard"==this.botType&&!this._isSheildActive)return this._currentFollowingNode=s,s.getPosition();if(null!=n&&null==r&&"easy"!=this.botType)return this._currentFollowingNode=n,n.getPosition();if(null==n&&null!=r&&"easy"!=this.botType)return this._currentFollowingNode=r,r.getPosition();if(null!=o&&this.getCurrentScale()>=this.criticalMass&&"easy"!=this.botType)return this._currentFollowingNode=o,o.getPosition();if(null!=n&&null!=r&&"easy"!=this.botType){var a=this.getDistance(n.getPosition().x,n.getPosition().z,this.node.getPosition().x,this.node.getPosition().z),h=this.getDistance(r.getPosition().x,r.getPosition().z,this.node.getPosition().x,this.node.getPosition().z),l=null==r.getComponent("Bot")?r.getComponent("Player"):r.getComponent("Bot");return this.getCurrentScale()<=this.criticalMass?(this._currentFollowingNode=n,n.getPosition()):this.getCurrentScale()>=this.maxScale?(this._currentFollowingNode=r,r.getPosition()):l.getCurrentScale()>=this.getCurrentScale()?this.getCurrentScale()<this.getMaxScale()||p(0,10)<5?(this._currentFollowingNode=n,n.getPosition()):(this._currentFollowingNode=r,r.getPosition()):(this._currentFollowingNode=a>h?r:n,this._currentFollowingNode.getPosition())}return this._currentFollowingNode=null,this.check(),this._vector},s.checkPowerUpDistance=function(e){if(null==this.gameController.powerupController)return null;for(var t=this.gameController.powerupController.getPowerUpArrayList(),i=0,n=-1,o=!0,s=0;s<t.length;s++)if(t[s].active&&t[s].name==e){var r=this.getDistance(t[s].getPosition().x,t[s].getPosition().z,this.node.getPosition().x,this.node.getPosition().z);o&&(o=!1,i=r),(r<=i&&"medium"!=this.botType||r>=i&&"medium"==this.botType)&&(i=r,n=s)}return-1!=n?t[n]:null},s.checkOtherPlayerPosition=function(){for(var e=[],t=0;t<this._playerList.length;t++)this._playerList[t]!=this.node&&e.push(this._playerList[t]);for(var i=[],n=0;n<e.length;n++){var o=(null==e[n].getComponent("Bot")?e[n].getComponent("Player"):e[n].getComponent("Bot")).getCurrentScale();this.getCurrentScale()>=o&&i.push(e[n])}(i=this.commonFun.shuffleArr(i)).sort((function(e,t){return(null==e.getComponent("Bot")?e.getComponent("Player"):e.getComponent("Bot")).getCurrentScale()-(null==t.getComponent("Bot")?t.getComponent("Player"):t.getComponent("Bot")).getCurrentScale()}));var s=999999,r=-1;if(Math.floor(10*Math.random())>5)i.length>0&&(r=0);else for(var a=0;a<i.length;a++){null==i[a].getComponent("Bot")?i[a].getComponent("Player"):i[a].getComponent("Bot");var h=this.getDistance(i[a].getPosition().x,i[a].getPosition().z,this.node.getPosition().x,this.node.getPosition().z);h<s&&(s=h,r=a)}return i.length>0?-1!=r?i[r]:i[Math.floor(Math.random()*i.length)]:null},s.checkRandomPoints=function(){var e=new d(this.node.getPosition().x,this.node.getPosition().z),t=Math.floor(p(0,360)),i=Math.ceil(t),n=(i=90-i)*(Math.PI/180),o=Number(e.x+500*Math.cos(n)),s=Number(e.y+500*Math.sin(n)),r=new d(o,s);this.sendRayCast(new a(r.x,1,r.y))},s.check=function(){var e=this.getSemiCirclePoint(0,500,new d(this.node.getPosition().x,this.node.getPosition().z),30,this.node.eulerAngles.y);null==this._currentRangeAngle&&(null==this._currentRangeAngle?this._currentRangeAngle=Math.floor(p(0,360)):this._currentRangeAngle,e=this.getSemiCirclePoint(0,500,new d(this.node.getPosition().x,this.node.getPosition().z),30,this.node.eulerAngles.y+this._currentRangeAngle));for(var t=0;t<e.length;t++)this.sendRayCast(new a(e[t].x,1,e[t].y))},s.getSemiCirclePoint=function(e,t,i,n,o){var s=[],r=this.split(n,e),a=Math.ceil(o);if(a=90-a,e<=0){var h=a*(Math.PI/180),l=Number(i.x+t*Math.cos(h)),c=Number(i.y+t*Math.sin(h)),u=new d(l,c);return s.push(u),s}for(var m=[],p=0,g=0;g<r.length;g++){var S=p+r[g],C=a+S;p=S,m.push(C)}p=0;for(var P=0;P<r.length;P++){var v=p+r[P],_=a-v;p=v,m.push(_)}for(var f=0;f<m.length;f++){var y=m[f]*(Math.PI/180),w=Number(i.x+t*Math.cos(y)),A=Number(i.y+t*Math.sin(y)),x=new d(w,A);s.push(x)}return s},s.split=function(e,t){var i=[];if(e<t)return i;if(e%t==0)for(var n=0;n<t;n++)i.push(e/t);else for(var o=t-e%t,s=Math.floor(e/t),r=0;r<t;r++)r>=o?i.push(s+1):i.push(s);return i},s.sendRayCast=function(e){for(var t=!1,i=!1,n=0;n<this.gameController.platformVertices.length;n++){var o=this.gameController.platformVertices[n].x,s=this.gameController.platformVertices[n].z,r=this.gameController.platformVertices[n+1<this.gameController.platformVertices.length?n+1:0].x,a=this.gameController.platformVertices[n+1<this.gameController.platformVertices.length?n+1:0].z,h=this.calculateIntersection(o,s,r,a,this.node.getPosition().x,this.node.getPosition().z,e.x,e.z);if(h.isIntersected){i=!0;var l=this.commonFun.getIntValue(this.node.getPosition().x),c=this.commonFun.getIntValue(this.node.getPosition().z);if(o!=l&&r!=l&&s!=c&&a!=c){if(this.currentDistance=this.getDistance(this.node.getPosition().x,this.node.getPosition().z,h.x,h.y),this.currentDistance<this._maxWallDistance)return t=!0,this._vector=null,void this.checkRandomPoints();break}}}return i?t?void 0:(this._vector=e,void(this._currentAngle=0)):(t=!0,void this.checkRandomPoints())},s.bezier=function(e,t,i,n,o){var s=3*(i.x-t.x),r=3*(n.x-i.x)-s,a=o.x-t.x-s-r,h=3*(i.y-t.y),l=3*(n.y-i.y)-h,c=o.y-t.y-h-l;return{x:a*Math.pow(e,3)+r*Math.pow(e,2)+s*e+t.x,y:c*Math.pow(e,3)+l*Math.pow(e,2)+h*e+t.y}},s.isPlayerBumpedOnOtherBack=function(e){var t=new d(this.node.getPosition().x,this.node.getPosition().z),i=new d(e.getPosition().x,e.getPosition().z),n=Math.round(e.eulerAngles.y)+60;n>180&&(n-=360);var o=Math.round(e.eulerAngles.y)-60;o<-180&&(o+=360);var s=180*Math.atan2(t.y-i.y,t.x-i.x)/Math.PI;return s=this.commonFun.findGameAngle(s),!!this.commonFun.angleBetweenAngle(s,n,o)},s.checkDidBumpedOnBck=function(e){var t=new d(this.node.getPosition().x,this.node.getPosition().z),i=new d(e.getPosition().x,e.getPosition().z),n=Math.round(this.node.eulerAngles.y)+100;n>180&&(n-=360);var o=Math.round(this.node.eulerAngles.y)-100;o<-180&&(o+=360);var s=180*Math.atan2(i.y-t.y,i.x-t.x)/Math.PI;return s=this.commonFun.findGameAngle(s),!!this.commonFun.angleBetweenAngle(s,n,o)},s.calculateIntersection=function(e,t,i,n,o,s,r,a){var h,l,c;return 0===(h=(i-e)*(a-s)-(r-o)*(n-t))?{isIntersected:!1,x:0,y:0}:(l=((t-n)*(r-e)+(i-e)*(a-t))/h,{isIntersected:0<(c=((a-s)*(r-e)+(o-r)*(a-t))/h)&&c<1&&0<l&&l<1,x:e+c*(i-e),y:t+c*(n-t)})},o}(g))||v);o._RF.pop()}}}));

System.register("chunks:///_virtual/Helper.ts",["cc"],(function(e){"use strict";var t,r;return{setters:[function(e){t=e.cclegacy,r=e._decorator}],execute:function(){var n;t._RF.push({},"870b0Aa1mBDrY0a9De020ZU","Helper",void 0);var i=r.ccclass;r.property,e("Helper",i("Helper")(n=function(){function e(){}return e.setFixedInterval=function(e,t){var r,n=(new Date).getTime(),i=n+t;r=function(){var c=(new Date).getTime();e(c-n),n=c,i+=t,c=(new Date).getTime();var u=i-c;if(u<=0){var o=1+parseInt(String((c-i)/t));u=i+o*t-c}a=setTimeout(r,u)}.bind(this);var a=setTimeout(r,i-(new Date).getTime());return function(){clearTimeout(a)}},e}())||n),e("STATE",{IDLE:0,WALK:1,BUMP:2,EAT:3,WIN:4});t._RF.pop()}}}));

System.register("chunks:///_virtual/leaderBoardBanner.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./commonFun.ts","./mxManager.ts"],(function(e){"use strict";var n,t,r,i,a,o,s,l,c,m,p,u,h,d,g;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,i=e.assertThisInitialized,a=e.defineProperty},function(e){o=e.cclegacy,s=e._decorator,l=e.SpriteFrame,c=e.Node,m=e.Label,p=e.Sprite,u=e.tween,h=e.Component},function(e){d=e.CommonFun},function(e){g=e.MxManager}],execute:function(){var y,f,b,B,v,C,w,F,T;o._RF.push({},"882e8b6yNlDmpl3SZwb5Qhi","leaderBoardBanner",void 0);var N=s.ccclass,x=s.property;e("LeaderBoardBanner",(y=N("LeaderBoardBanner"),f=x({type:l}),b=x({type:l}),B=x({type:c}),y((w=n((C=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return n=e.call.apply(e,[this].concat(o))||this,r(i(n),"panel",w,i(n)),r(i(n),"trophy",F,i(n)),r(i(n),"bannr",T,i(n)),a(i(n),"commonFun",null),a(i(n),"tween",null),n}t(n,e);var o=n.prototype;return o.start=function(){},o.initialiseData=function(e,n,t,r){switch(this.commonFun=new d,this.bannr.getChildByName("rankText").getComponent(m).string=(e+1).toString(),this.bannr.getChildByName("nameText").getComponent(m).string=this.commonFun.removeUnwantedText(t.name,8),e){case 0:case 1:case 2:this.node.getComponent(p).spriteFrame=this.panel[e],this.bannr.getChildByName("medal").getComponent(p).spriteFrame=this.trophy[e]}if("-----"==t.name)this.bannr.getChildByName("timer").getComponent(m).string="-:--:---";else{var i=t.time-r.gameController.currentTime;g.instance.isMiloApp&&(i=t.time-t.startTime);var a=this.commonFun.millisecondsToTime(i);this.bannr.getChildByName("timer").getComponent(m).string=a}this.deactivateBanner(n)},o.deactivateBanner=function(e){var n=this;this.bannr.active=!1,this.tween=u(this.node).delay(e).call((function(){n.activateBanner()})).start()},o.activateBanner=function(){this.bannr.active=!0},n}(h)).prototype,"panel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=n(C.prototype,"trophy",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),T=n(C.prototype,"bannr",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=C))||v));o._RF.pop()}}}));

System.register("chunks:///_virtual/audioManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./constant.ts","./resourceUtil.ts"],(function(n){"use strict";var o,u,e,i,t,a,s,c,d,l,r;return{setters:[function(n){o=n.createClass,u=n.defineProperty},function(n){e=n.cclegacy,i=n.game,t=n.Game,a=n.assert,s=n.AudioClip,c=n.warn,d=n.clamp01},function(n){l=n.constant},function(n){r=n.resourceUtil}],execute:function(){e._RF.push({},"884daUfIQRNRq4ZxJzJ5kOx","audioManager",void 0);var S=n("audioManager",function(){function n(){u(this,"soundVolume",1)}var e=n.prototype;return e.init=function(o){var u=this;this.soundVolume=.8,n._audioSource=o,i.on(t.EVENT_HIDE,(function(){u.disableSound()})),i.on(t.EVENT_SHOW,(function(){l.CheckSoundEnabled()&&u.enableSound()}))},e.getConfiguration=function(n){return l.CheckSoundEnabled()},e.playMusic=function(o){var u=n._audioSource;a(u,"AudioManager not inited!"),u.loop=o,u.playing||u.play()},e.playSound=function(o){var u=this,e=n._audioSource;a(e,"AudioManager not inited!");r.loadRes("gamePackage/audio/sound/"+o,s,(function(n,o){n?c("load audioClip failed: ",n):e.playOneShot(o,e.volume?u.soundVolume/e.volume:0)}))},e.setMusicVolume=function(o){var u=n._audioSource;a(u,"AudioManager not inited!"),o=d(o),u.volume=o},e.setSoundVolume=function(n){this.soundVolume=n},e.openMusic=function(){this.setMusicVolume(.2)},e.closeMusic=function(){this.setMusicVolume(0)},e.openSound=function(){this.setSoundVolume(1)},e.closeSound=function(){this.setSoundVolume(0)},e.checkSound=function(){l.CheckSoundEnabled()?this.enableSound():this.disableSound()},e.toggleGameSound=function(){return l.ToggleSound()?this.enableSound():this.disableSound(),l.CheckSoundEnabled()},e.enableSound=function(){n._audioSource.volume=1,this.soundVolume=.8},e.disableSound=function(){n._audioSource.volume=0,this.soundVolume=0},o(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}());u(S,"_instance",void 0),u(S,"_audioSource",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/InitSceneManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MiloManager.ts","./mxManager.ts","./GameConfig.ts","./constant.ts","./GameStateTrigger.ts","./SocketConnection.ts"],(function(e){"use strict";var n,i,t,a,o,r,s,c,l,u,g,d,m,f,p,h,y,S,b,M;return{setters:[function(e){n=e.defineProperty,i=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,c=e.Node,l=e.Label,u=e.tween,g=e.Vec3,d=e.director,m=e.Component},function(e){f=e.MiloManager},function(e){p=e.MxManager},function(e){h=e.GameConfig},function(e){y=e.constant},function(e){S=e.GameStateTrigger},function(e){b=e.SocketConnection,M=e.SocketListener}],execute:function(){var v,C,T,I,_,G,L,O,N,A,k,E,R;r._RF.push({},"8973frGxu9LmbPkA4WnAOW7","InitSceneManager",void 0);var z=s.ccclass,w=s.property;e("InitSceneManager",(v=z("InitSceneManager"),C=w(c),T=w(c),I=w(c),_=w(l),v((R=E=function(e){function i(){var t;return t=e.call(this)||this,a(o(t),"message",O,o(t)),a(o(t),"bgContainer",N,o(t)),a(o(t),"connectingNode",A,o(t)),a(o(t),"redirectingLabel",k,o(t)),n(o(t),"miloManager",null),n(o(t),"initialiserTimeOut",0),i.instance=o(t),t.initialiserTimeOut=h.initialiserTimeOut,t}t(i,e);var r=i.prototype;return r.onLoad=function(){this.connectingNode.active=!0,this.redirectingLabel.node.active=!1},r.start=function(){var e=this;p.instance.onGameStart();var n={};if(n=b.localDev?JSON.parse(f().onGameInit()):p.instance.onGameInit().gameInit,b.instance.initInfo=n,p.instance.isMiloApp){var i=n.players.find((function(e){return e.userId==n.initInfo.userId}));S.userId=i.userId}else S.userId=n.userId;S.sendGameState(S.EventType.Game_App_Layer_Loaded.key,S.EventType.Game_App_Layer_Loaded.reason),u(this.node.getChildByName("infineSign")).by(.1,{eulerAngles:new g(this.node.getChildByName("infineSign").eulerAngles.x,this.node.getChildByName("infineSign").eulerAngles.y+10,this.node.getChildByName("infineSign").eulerAngles.z)}).repeatForever().start(),p.instance.isMiloApp?(console.log("Milo found making socket connection"),b.instance.on(M.GAME_STARTED,(function(n){e.unschedule(e.gameClose),n?(S.sendGameState(S.EventType.Game_Play_Launched.key,S.EventType.Game_Play_Launched.reason),d.loadScene("GameScene")):e.startMenu()}),this),b.instance.on(M.CONNECTION_ERROR,(function(){e.initialiserTimeOut=h.initialiserTimeOut,e.schedule(e.gameClose,1,h.initialiserTimeOut)}),this),b.instance.on(M.ON_CONNECT,this.onConnect,this),b.instance.start()):(console.log("Milo not found Starting Menu Scene "),this.startMenu())},r.gameClose=function(){this.connectingNode.active=!1,this.redirectingLabel.node.active=!0,this.initialiserTimeOut<1?(this.unschedule(this.gameClose),y.callGameOver(0,!1,!1)):this.redirectingLabel.string="Unable to connect\nRedirecting to App in "+this.initialiserTimeOut,--this.initialiserTimeOut},r.onConnect=function(e){console.log("Room is connected, Id: "+e.sessionId)},r.startMenu=function(){d.loadScene("MenuScene")},i}(m),n(E,"instance",void 0),O=i((L=R).prototype,"message",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(L.prototype,"bgContainer",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=i(L.prototype,"connectingNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=i(L.prototype,"redirectingLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=L))||G));r._RF.pop()}}}));

System.register("chunks:///_virtual/mxManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MiloManager.ts"],(function(e){"use strict";var t,n,r,a;return{setters:[function(e){t=e.createClass,n=e.defineProperty},function(e){r=e.cclegacy},function(e){a=e.MiloManager}],execute:function(){r._RF.push({},"8a9ca29cz5PnaCLIhult98e","mxManager",void 0);var o=e("MxManager",function(){function e(){n(this,"isMiloApp",!1),n(this,"currentManager",void 0),n(this,"playTime",void 0),n(this,"adGameStartOpportunity",void 0),n(this,"adGameStartShown",void 0),n(this,"adGameStartClaimed",void 0),n(this,"adGameEndOpportunity",void 0),n(this,"adGameEndShown",void 0),n(this,"adGameEndClaimed",void 0),n(this,"adGamePowerupClaimed",void 0)}var r=e.prototype;return r.init=function(){void 0!==window.gameManager?(this.isMiloApp=!1,this.currentManager=window.gameManager):void 0!==window.mxMiloManager?(this.isMiloApp=!0,this.currentManager=window.mxMiloManager):this.currentManager=a()},r.onGameStart=function(){if(null!=this.currentManager&&"function"==typeof this.currentManager.onGameStart)try{this.currentManager.onGameStart()}catch(e){this.currentManager.onError(e.stack.toString())}var e=new Date;this.playTime=e.getTime();var t={startType:this.getisFirstOpen()?"first":"new"};this.onTrack(t,"gameStart")},r.onGameInit=function(){if(null!=this.currentManager&&"function"==typeof this.currentManager.onGameInit)try{var e=JSON.parse(this.currentManager.onGameInit()),t=e;if(this.isMiloApp){var n=function e(t,n,r){"object"==typeof t&&null!==t&&Object.keys(t).forEach((function(a){t.hasOwnProperty(n)&&"object"!=typeof t[n]&&n==a&&(console.log("key "+a+" with previous value "+t[n]+" replaced with new value "+r),t[n]=r),"object"==typeof t[a]&&e(t[a],n,r)}))};t=t.initInfo,this.saveUserIdData(t);var r=t.gameConfig;return(r=JSON.parse(r)).purchases=t.purchases,window.localStorage.setItem("coinBalance",t.balance),function(e,t){null!=t&&Object.keys(t).forEach((function(r){var a=t[r];n(e,r,a)}))}(r,t.userSelectedGameConfiguration),{gameInit:e,config:r}}if(this.saveUserIdData(t),this.saveisFirstOpen(t),this.saveHighScore(t.highestScore),"function"!=typeof this.currentManager.getGameSettings)return null;try{var a=this.currentManager.getGameSettings();return{gameInit:t,config:r=JSON.parse(a)}}catch(e){return null}}catch(e){return null}return null},r.deductCoins=function(e,t,n){if(null!=this.currentManager&&"function"==typeof this.currentManager.deductCoins){var r=JSON.stringify(t);this.currentManager.deductCoins(e,r)}else n.coinDeductAccessories('{"success":1,"balance":100}')},r.onCheckRewardedVideoAds=function(e,t){null!=this.currentManager&&"function"==typeof this.currentManager.onCheckRewardedVideoAds?this.currentManager.onCheckRewardedVideoAds(e):t[e]({status:0})},r.onShowRewardedVideoAds=function(e,t){null!=this.currentManager&&"function"==typeof this.currentManager.onShowRewardedVideoAds?this.currentManager.onShowRewardedVideoAds(e,null):t[e]({status:0})},r.onEnableMic=function(e,t){null!=this.currentManager&&"function"==typeof this.currentManager.onEnableMic?this.currentManager.onEnableMic(e):t[e]({status:0})},r.onDisableMic=function(){null!=this.currentManager&&"function"==typeof this.currentManager.onDisableMic&&this.currentManager.onDisableMic()},r.onAvatarClick=function(e){null!=this.currentManager&&"function"===this.currentManager.onAvatarClick&&this.currentManager.onAvatarClick(e)},r.showXpEffect=function(e){if(null!=this.currentManager&&"function"==typeof this.currentManager.pushFromGameToAndroid){var t={eventType:"XPEvent",payload:{userId:e}},n=JSON.stringify(t);this.currentManager.pushFromGameToAndroid(n)}},r.pushFromGameToAndroid=function(e){null!=this.currentManager&&"function"==typeof this.currentManager.pushFromGameToAndroid&&this.currentManager.pushFromGameToAndroid(e)},r.onGameOver=function(e){e=this.appendCommomData(e);var t=JSON.stringify(e);if(console.log("event name - onGameOver\nparams - "+t),null!=this.currentManager&&"function"==typeof this.currentManager.onGameOver)try{this.currentManager.onGameOver(t)}catch(e){this.currentManager.onError(e.stack.toString())}},r.onTrack=function(e,t){e=this.appendCommomData(e);var n=JSON.stringify(e);if(console.log("event track name - "+t+"\nparams - "+n),null!=this.currentManager&&"function"==typeof this.currentManager.onTrack)try{this.currentManager.onTrack(t,n)}catch(e){this.currentManager.onError(e.stack.toString())}},r.saveUserIdData=function(e){window.localStorage.setItem("SumoroomId",e.roomId),window.localStorage.setItem("SumouserId",e.userId),window.localStorage.setItem("SumogameId",e.gameId)},r.saveisFirstOpen=function(e){window.localStorage.setItem("SumoisFirstOpen",e.isFirstOpen)},r.getisFirstOpen=function(){return null!=window.localStorage.getItem("SumoisFirstOpen")&&null!=window.localStorage.getItem("SumoisFirstOpen")||window.localStorage.setItem("SumoisFirstOpen","true"),"true"==window.localStorage.getItem("SumoisFirstOpen")},r.saveHighScore=function(e){window.localStorage.setItem("SumohighScore",e)},r.updateHighScore=function(e){var t=parseInt(window.localStorage.getItem("SumohighScore"));t<e&&this.saveHighScore(t)},r.getHighScore=function(){return null!=window.localStorage.getItem("SumohighScore")&&null!=window.localStorage.getItem("SumohighScore")||window.localStorage.setItem("SumohighScore","0"),parseInt(window.localStorage.getItem("SumohighScore"))},r.appendCommomData=function(e){var t={gameId:String(window.localStorage.getItem("SumogameId")),roomID:String(window.localStorage.getItem("SumoroomId")),userID:String(window.localStorage.getItem("SumouserId"))},n=Object.assign({},t);for(var r in e)n[r]=e[r];return n},t(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}());n(o,"_instance",void 0),r._RF.pop()}}}));

System.register("chunks:///_virtual/PowerUpController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./SocketConnection.ts"],(function(e){"use strict";var t,a,r,o,i,n,l,s,p,m,h;return{setters:[function(e){t=e.inheritsLoose,a=e.defineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,n=e.randomRange,l=e.Vec2,s=e.Vec3,p=e.instantiate,m=e.Component},function(e){h=e.SocketConnection}],execute:function(){var c;o._RF.push({},"8bf73q3+cdE0rnIIGpvubbX","PowerUpController",void 0);var u=i.ccclass;i.property,e("PowerUpController",u("PowerUpController")(c=function(e){function o(t){var o;return o=e.call(this)||this,a(r(o),"gameController",void 0),a(r(o),"eatablesMap",{}),a(r(o),"powerupArray",[]),a(r(o),"gummySpawnInterval",void 0),a(r(o),"totalGummyToPresent",void 0),a(r(o),"powerUpMap",{}),o.gameController=t,o}t(o,e);var i=o.prototype;return i.setEatables=function(e){var t=this;e.forEach((function(e){t.eatablesMap[e.data.name]=e})),this.loadPowerUps()},i.spawnPowerup=function(e){var t=this.gameController.gameData.actualPlayerCount+this.gameController.gameData.totalBotPresent;this.checkTotalPowerUpSpawn(t);for(var a=this.totalGummyToPresent,r=0;r<a;r++)this.respawnGummys()},i.startSpawningNewPowerups=function(){this.schedule(this.spawnAnyPowerup,this.gameController.gameData.levelDetail.powerUp.spawnDuration)},i.spawnAnyPowerup=function(){var e=this.gameController.gameData.levelDetail.powerUp.spawnProbability.PoisionSize?this.gameController.gameData.levelDetail.powerUp.spawnProbability.PoisionSize:0,t=this.gameController.gameData.levelDetail.powerUp.spawnProbability.PoisionSpeed?this.gameController.gameData.levelDetail.powerUp.spawnProbability.PoisionSpeed:0,a=this.gameController.gameData.levelDetail.powerUp.spawnProbability.GainSpeed?this.gameController.gameData.levelDetail.powerUp.spawnProbability.GainSpeed:0,r=this.gameController.gameData.levelDetail.powerUp.spawnProbability.Sheild?this.gameController.gameData.levelDetail.powerUp.spawnProbability.Sheild:0,o=e+t+a+r,i=Math.floor(n(1,o)),l=0!=e?[1,e]:[0,0],s=0!=t?[e+1,t+e]:[0,0],p=0!=a?[e+t+1,a+e+t]:[0,0],m=0!=r?[e+t+a+1,r+e+t+a]:[0,0],h=0;switch(i>=l[0]&&i<=l[1]&&(h=0),i>=s[0]&&i<=s[1]&&(h=1),i>=p[0]&&i<=p[1]&&(h=2),i>=m[0]&&i<=m[1]&&(h=3),h){case 0:this.spawnGummy(this.eatablesMap.PoisionSize);break;case 1:this.spawnGummy(this.eatablesMap.PoisionSpeed);break;case 2:this.spawnGummy(this.eatablesMap.GainSpeed);break;case 3:this.spawnGummy(this.eatablesMap.Sheild)}},i.getGummyNumber=function(){for(var e=0,t=0;t<this.powerupArray.length;t++)this.powerupArray[t].active&&"GummyBear"==this.powerupArray[t].name&&e++;return e},i.getSpawnLocation=function(){for(var e=this.gameController.platform.getScale().x+15,t=this.gameController.platform.getScale().z+15,a=n(-e,e),r=n(-t,t);!this.inside(new l(a,r),this.gameController.platformVertices);)a=n(-e,e),r=n(-t,t);return new s(a,2,r)},i.inside=function(e,t){for(var a=e.x,r=e.y,o=!1,i=0,n=t.length-1;i<t.length;n=i++){var l=t[i].x,s=t[i].z,p=t[n].x,m=t[n].z;s>r!=m>r&&a<(p-l)*(r-s)/(m-s)+l&&(o=!o)}return o},i.spawnGummy=function(e){for(var t=this.getSpawnLocation(),a=!0,r=0;r<this.powerupArray.length;r++)if(!this.powerupArray[r].active&&e.data.name==this.powerupArray[r].name){this.powerupArray[r].setPosition(t),this.powerupArray[r].active=!0,a=!1;break}if(a){var o=p(e);o.setPosition(t),this.powerupArray.push(o),this.gameController.addToWorld(o);var i=window.localStorage.getItem("playerData"),n=JSON.parse(i),l=-1==n.food?0:n.food,s=p(this.gameController.foodPrefabList[l]);o.getChildByName("foodNode").addChild(s)}},i.getPowerUpArrayList=function(){return this.powerupArray},i.removeGummy=function(e){e.node.active=!1;for(var t=0;t<this.gameController.botController._totalPlayerArrayList.length;t++){var a=this.gameController.botController._totalPlayerArrayList[t],r=null==a.getComponent("Bot")?a.getComponent("Player"):a.getComponent("Bot");r._isPlayer||e.node==r._currentFollowingNode&&(r._currentFollowingNode=null)}this.checkTotalPowerUpSpawn(this.gameController.botController._totalPlayerArrayList.length),this.getGummyNumber()<this.totalGummyToPresent&&this.respawnGummys()},i.removeObjectFromArray=function(e,t){var a=e.indexOf(t);return-1!==a&&e.splice(a,1),e},i.respawnGummys=function(){this.spawnGummy(this.eatablesMap.GummyBear)},i.getPercentage=function(e,t){return Math.ceil(e/100*t)},i.checkTotalPowerUpSpawn=function(e){this.totalGummyToPresent=this.getPercentage(100*this.gameController.gameData.levelDetail.powerUp.totalSpawn,e)},i.createServerPowerUp=function(e){var t=this.getPowerUpPrefab(e.name),a=p(t);a.setPosition(new s(e.x,e.y,e.z)),a.active=e.active,this.powerUpMap[e.id]=a,this.gameController.addToWorld(a);var r=window.localStorage.getItem("playerData"),o=JSON.parse(r),i=-1==o.food?0:o.food,n=p(this.gameController.foodPrefabList[i]);a.getChildByName("foodNode").addChild(n)},i.activateOrDeactivatePowerUps=function(e){var t=this.powerUpMap[e.id];t.active=e.active,t.setPosition(new s(e.x,e.y,e.z))},i.onChangeListener=function(e){this.powerUpMap[e.id]?this.activateOrDeactivatePowerUps(e):this.createServerPowerUp(e)},i.loadPowerUps=function(){for(var e=0;e<h.instance.powerUpsArr.length;e++){var t=h.instance.powerUpsArr[e];this.powerUpMap[t.id]||null==t.name||this.createServerPowerUp(t)}},i.getPowerUpPrefab=function(e){return console.log(" powerup requested",e),this.eatablesMap[e]},o}(m))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/CharacterHud.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,r,n,o,s,i,a,u,g,l,c,p,h,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized,s=e.defineProperty},function(e){i=e.cclegacy,a=e._decorator,u=e.Label,g=e.Node,l=e.Vec3,c=e.tween,p=e.Animation,h=e.ProgressBar,d=e.Component}],execute:function(){var w,y,m,f,P,C,v;i._RF.push({},"8d0a7RNVcpBfqZHaK6QYt4a","CharacterHud",void 0);var B=a.ccclass,b=a.property;e("CharacterHud",(w=B("CharacterHud"),y=b({type:u}),m=b({type:g}),w((C=t((P=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,n(o(t),"nameLabel",C,o(t)),n(o(t),"powerwProgress",v,o(t)),s(o(t),"_currentDuration",null),s(o(t),"_playerAngle",new l(0,0,0)),t}r(t,e);var i=t.prototype;return i.start=function(){},i.updateNameData=function(e){this.nameLabel.string=e},i.updateHudPos=function(e,t){this.node.setPosition(new l(e.x,this.node.position.y,e.z)),this.node.eulerAngles=new l(t.eulerAngles.x,t.eulerAngles.y,t.eulerAngles.z)},i.setHudPosFromServer=function(e){var t=this.getRangeVal(e.x,0,.5,.5,3.5);this.node.setPosition(new l(this.node.position.x,t,this.node.position.z))},i.tweenPosition=function(e){var t=this.getRangeVal(e,0,.5,.5,3.5);c(this.node.position).to(1,{y:t}).start()},i.showScore=function(e){this.node.getChildByName("score").getComponent(u).string=e>=0?"+"+e:e,this.node.getComponent(p).play("showScore")},i.getRangeVal=function(e,t,r,n,o){return(e-(t=t))/((r=r)-t)*((o=o)-(n=n))+n},i.startPowerupProgress=function(e){this.powerwProgress.active=!0,this._currentDuration=e;var t=this.getRangeVal(e,0,this._currentDuration,0,1);this.powerwProgress.getChildByName("progress").getComponent(h).progress=t;var r=this.getRangeVal(e-1,0,this._currentDuration,0,1);c(this.powerwProgress.getChildByName("progress").getComponent(h)).to(1,{progress:r}).start(),this.powerwProgress.getChildByName("counterBg").getChildByName("counter").getComponent(u).string=e},i.updatePowerProgress=function(e){var t=this.getRangeVal(e-1,0,this._currentDuration,0,1);c(this.powerwProgress.getChildByName("progress").getComponent(h)).to(1,{progress:t}).start(),this.powerwProgress.getChildByName("counterBg").getChildByName("counter").getComponent(u).string=e,0==e&&(this.powerwProgress.active=!1)},t}(d)).prototype,"nameLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=t(P.prototype,"powerwProgress",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=P))||f));i._RF.pop()}}}));

System.register("chunks:///_virtual/SocketConnection.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./colyseus.js","./colyseus.mjs_cjs=&original=.js","./EventManager.ts"],(function(t){"use strict";var n,e,i,o,s,r,a,c,d;return{setters:[function(t){n=t.defineProperty,e=t.createClass,i=t.asyncToGenerator},function(t){o=t.cclegacy,s=t._decorator,r=t.log},function(t){a=t.GameConfig},function(t){c=t.default},null,function(t){d=t.EventManager}],execute:function(){var u,_,h;t("SocketListener",void 0),o._RF.push({},"9113fbeb1RIL5g7gTGC3X/R","SocketConnection",void 0);var l,E=s.ccclass;!function(t){t.ON_ADD="ON_ADD",t.ON_CONNECT="ON_CONNECT",t.ON_PLAYER_CHANGE="ON_PLAYER_CHANGE",t.ON_POWERUP_ADD="ON_POWERUP_ADD",t.ON_POWERUP_CHANGE="ON_POWERUP_CHANGE",t.ON_WAIT_TIME="ON_WAIT_TIME",t.GAME_STARTED="GAME_STARTED",t.READY_GO_COUNT="READY_GO_COUNT",t.SERVER_GAME_TIME="SERVER_GAME_TIME",t.CURRENT_GAME_MAP="CURRENT_GAME_MAP",t.ON_BUMP="ON_BUMP",t.ON_POWERUP_BUMP="ON_POWERUP_BUMP",t.ON_PLAYER_DEAD="ON_PLAYER_DEAD",t.ON_GAME_OVER="ON_GAME_OVER",t.ON_CROWN="ON_CROWN",t.ON_SCORE_CHANGE="ON_SCORE_CHANGE",t.ON_QUIT="ON_QUIT",t.PLAYER_STATE="PLAYER_STATE",t.CONNECTION_ERROR="CONNECTION_ERROR"}(l||(l=t("SocketListener",{})));t("SocketConnection",E("SocketConnection")((h=_=function(){function t(){n(this,"playerName",void 0),n(this,"isConnected",!1),n(this,"isReconected",!1),n(this,"maxRetry",5),n(this,"retryCount",0),n(this,"lastPingTime",(new Date).getTime()),n(this,"initInfo",{}),n(this,"miloManager",null),n(this,"onlinePlayers",[]),n(this,"powerUpsArr",[]),n(this,"eventManager",void 0),n(this,"pingInterval",0),this.eventManager=new d}var o=t.prototype;return o.start=function(){var n=this.initInfo,e=n.players.find((function(t){return t.userId==n.initInfo.userId}));this.playerName=e.name,e=Object.assign(e,{micEnable:n.initInfo.micEnabled});var i=Object.assign(n.initInfo,{isHost:e.host,playerInfo:e,gameConfig:a,roomName:"SumoRoom"}),o=a.serverInfo.isProd,s="";t.localDev?s="ws://"+window.location.href.split("/")[2].split(":")[0]+":2567":s=o?a.serverInfo.serverUrlEndPoint.prod:a.serverInfo.serverUrlEndPoint.dev;this.client=new c.Client(s),this.connect(i),console.log("Connecting server to "+s)},o.connect=function(){var t=i(regeneratorRuntime.mark((function t(n){var e,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n.roomId,t.next=4,this.client.joinById(e,{roomType:"PRIVATE",roomId:e,playerInfo:n.playerInfo});case 4:this.room=t.sent,this.isConnected=!0,console.log("Room joined successfully!"),console.log("user's sessionId:",this.room.sessionId),this.addRoomListeners(),this.addBroadCastListener(),this.startPing(),this.dispatch(l.ON_CONNECT,this.room),t.next=20;break;case 14:if(t.prev=14,t.t0=t.catch(0),r(t.t0),!this.isConnected){t.next=19;break}return t.abrupt("return");case 19:setTimeout((function(){i.retryCount<i.maxRetry?i.connect(n):i.dispatch(l.CONNECTION_ERROR,t.t0),++i.retryCount}),1e3);case 20:case"end":return t.stop()}}),t,this,[[0,14]])})));return function(n){return t.apply(this,arguments)}}(),o.onReconnect=function(){this.isReconected=!0,this.addRoomListeners(),this.addBroadCastListener(),this.isReconected=!1},o.reconnect=function(){},o.startPing=function(){var t=this;this.pingInterval=setInterval((function(){t.isConnected&&(t.lastPingTime=(new Date).getTime(),t.room.send("action",{command:"PING",data:t.lastPingTime}))}),1e3)},o.countPingTime=function(){(new Date).getTime(),this.lastPingTime},o.addRoomListeners=function(){var t=this,n=this;this.room.onMessage("PONG",(function(n){t.countPingTime()})),this.room.onLeave((function(n){console.log("onLeave:",n),t.isConnected=!1})),this.room.state.listen("gameStartTime",(function(n){t.dispatch(l.ON_WAIT_TIME,n)})),this.room.state.listen("gameStarted",(function(n){t.dispatch(l.GAME_STARTED,n)})),this.room.state.listen("serverGameTime",(function(n){t.dispatch(l.SERVER_GAME_TIME,n)})),this.room.state.listen("currentMap",(function(n){t.dispatch(l.CURRENT_GAME_MAP,n)})),this.room.state.listen("readyGoCount",(function(n){t.dispatch(l.READY_GO_COUNT,n)})),this.room.onMessage("GAME_OVER",(function(n){t.dispatch(l.ON_GAME_OVER,n)})),this.room.state.powerUps.onAdd=function(e){console.log("Powerup added"),t.addPowerUps(e),e.onChange=function(t){n.dispatch(l.ON_POWERUP_CHANGE,this)}},this.room.state.playerMap.onAdd=function(e,i){console.log(e,"has been added at",i),t.addPlayerToArray(e),t.dispatch(l.ON_ADD),e.onChange=function(t){n.dispatch(l.ON_PLAYER_CHANGE,this)},e.listen("isDead",(function(t){n.dispatch(l.ON_PLAYER_DEAD,e)})),e.listen("hasQuit",(function(t){1==t&&n.dispatch(l.ON_QUIT,e)})),e.listen("score",(function(){n.dispatch(l.ON_SCORE_CHANGE,e)})),e.listen("crownActive",(function(t){n.dispatch(l.ON_CROWN,e)})),e.triggerAll()}},o.addBroadCastListener=function(){var t=this;this.room.onMessage(l.ON_BUMP,(function(n){t.dispatch(l.ON_BUMP,{ANIM_STATE:n.ANIM_STATE,vector:n.vector,bumpValue:n.bumpValue,bumpPos:n.bumpPos,collider:n.colliderId})})),this.room.onMessage(l.ON_POWERUP_BUMP,(function(n){t.dispatch(l.ON_POWERUP_BUMP,n)}))},o.addPlayerToArray=function(t){var n=this.onlinePlayers.findIndex((function(n){return n.userId==t.userId}));n>-1&&this.onlinePlayers.splice(n,1),this.onlinePlayers.push(t)},o.addPowerUps=function(t){this.powerUpsArr.push(t)},o.send=function(t){this.room.send("action",t)},o.on=function(t,n,e){this.eventManager.addListener(t,n.bind(e))},o.remove=function(t,n){this.eventManager.removeListener(t,n)},o.dispatch=function(t,n){this.eventManager.dispatch(t,n)},o.quitGame=function(){this.send({command:"ON_QUIT",data:{msg:"Client quitting game"}})},o.leaveRoom=function(){this.room.leave()},e(t,[{key:"sessionId",get:function(){return this.room.sessionId}}],[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(),n(_,"_instance",void 0),n(_,"dataRate",20),n(_,"localDev",!1),u=h))||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/eventListener.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,r,s,o;return{setters:[function(t){e=t.defineProperty},function(t){n=t.cclegacy,r=t._decorator,s=t.error,o=t.log}],execute:function(){var i,a;n._RF.push({},"9dccaCF91dApYnQ1vWQIfmq","eventListener",void 0);var u=r.ccclass,c=(r.property,u("oneToOneListener")(i=function(){function t(){e(this,"supportEvent",{}),e(this,"handle",{}),this.supportEvent=null}var n=t.prototype;return n.on=function(t,e,n){this.handle[t]={handler:e,target:n}},n.off=function(t,e){var n=this.handle[t];n&&n.handler&&n.handler===e&&delete this.handle[t]},n.dispatchEvent=function(t){if(null===this.supportEvent||this.supportEvent.hasOwnProperty(t)){for(var e=this.handle[t],n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);e.handler?e.handler.apply(e.target,n):o("not register "+t+"    callback func")}else s("please add the event into clientEvent.js")},n.setSupportEventList=function(t){if(!(t instanceof Array))return s("supportEvent was not array"),!1;for(var e in this.supportEvent={},t){var n=t[e];this.supportEvent[n]=e}return!0},t}())||i);t("eventListener",u("eventListener")(a=function(){function t(){}return t.getBaseClass=function(t){return c},t}())||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/commonFun.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(a){"use strict";var e,t,n,r,i,o,u;return{setters:[function(a){e=a.inheritsLoose,t=a.defineProperty,n=a.assertThisInitialized},function(a){r=a.cclegacy,i=a._decorator,o=a.Vec3,u=a.Component}],execute:function(){var h;r._RF.push({},"a12d4+l2AhNPJDGsDtZTX1+","commonFun",void 0);var l=i.ccclass,s=(i.property,0),c=1,m=2;a("CommonFun",l("CommonFun")(h=function(a){function r(){for(var e,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=a.call.apply(a,[this].concat(i))||this,t(n(e),"removeUnwantedText",(function(a,e){if((a=(a=a.split(" "))[0]).length<e)return a;var t=a.slice(0,e-3);return t+=".."})),t(n(e),"convertMiliToSecond",(function(a){return a/1e3})),e}e(r,a);var i=r.prototype;return i.start=function(){},i.getPercentage=function(a,e){return a/100*e},i.shuffleArr=function(a){for(var e=a.length-1;e>0;e--){var t=Math.floor(Math.random()*(e+1)),n=[a[t],a[e]];a[e]=n[0],a[t]=n[1]}return a},i.getNewModifiedSpeed=function(a,e){return(a-e.initialSize)/(e.maxSize-e.initialSize)*(e.endspeed-e.startSpeed)+e.startSpeed},i.findGameAngle=function(a){var e=0;return a<0&&a>=-90?e=-(a-90):a<-90&&a>=-180&&(e=-a-90-180),a>0&&a<=90?e=90-a:a>90&&a<=180&&(e=-(a-90)),e},i.findAngle=function(a,e,t){var n=Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2),r=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),i=Math.pow(t.x-a.x,2)+Math.pow(t.y-a.y,2),o=Math.acos((r+n-i)/Math.sqrt(4*r*n));return(o*=180/Math.PI)>90},i.angleTo360=function(a){return(a=a%360+(a-Math.trunc(a)))>0?a:a+360},i.angleBetweenAngle=function(a,e,t){return a=this.angleTo360(a),(e=this.angleTo360(e))<(t=this.angleTo360(t))?e<=a&&a<=t:e<=a||a<=t},i.shuffleArray=function(a){for(var e=a.length-1;e>0;e--){var t=Math.floor(Math.random()*(e+1)),n=a[e];a[e]=a[t],a[t]=n}return a},i.checkIsCollided=function(a,e,t,n,r,i){var o=(a-t)*(a-t)+(e-n)*(e-n),u=(r+i)*(r+i);return o==u?1:o>u?-1:0},i.DrawCirclePoints=function(a,e,t){for(var n=[],r=2*Math.PI/a,i=0;i<a;i++){var u=r*i,h=Number(t.x+e*Math.cos(u)),l=Number(t.y+e*Math.sin(u)),s=new o(h,.5,l);n.push(s)}return n},i.changeWalkAnimationSpeed=function(a,e){},i.setWalkStateAnimation=function(a){a._currentState=c,a._skeletal.play("walk")},i.setBumpStateAnimation=function(a){a._currentState=m,a._skeletal.play("push"),a._skeletal.getState("push").repeatCount=1},i.setIdleStateAnimation=function(a){a._currentState=s,a._skeletal.play("idle")},i.setPowerGainAnimation=function(a){null!=a.eatTimeout&&clearTimeout(a.eatTimeout),a._skeletal.play("powerGain");var e=a._skeletal.getState("powerGain").duration;a.eatTimeout=setTimeout((function(){a._skeletal.play("walk"),a.eatTimeout=null}),1e3*e)},i.setPowerLoseAnimation=function(a){null!=a.eatTimeout&&clearTimeout(a.eatTimeout),a._skeletal.play("powerLose");var e=a._skeletal.getState("powerLose").duration;a.eatTimeout=setTimeout((function(){a._skeletal.play("walk"),a.eatTimeout=null}),1e3*e)},i.setWinStateAnimation=function(a){a._skeletal.play("win")},i.getNames=function(){var a=["Sanjay","Vinay","Salman","Parvez","Rohan","Shahzad","Shantanu","shenaz","vivek","ramesh","suresh ","rahul","arun","sai","abhishek","vikas","lokesh","mahesh","ram","shyam","Abhijeet","Aditya","Akshat","Amitava","Angad","Aniruddh","Anubhav","Arjun","Armaan","Ashish","Anjali","Antara","Aparna","Aruna","Arunima","Arzoo","Ayesha","Bahaar","Bhavna","Bhoomi","Bipasha","Chaaya","Chandrika","Chhavi","Deepika","Devika","Diya","Ekta","Falguni","Farah","Fatima","Garima","Gauhar","Gayatri","Geetha","Gurleen","Harini","Harpreet","Indrani","Ira","Jasleen","Jayanti","Jyothsna","Kalyani","Kanika","Jeet","Junaid","Kabir","Kartik","Karun","Khalid","Kshitij","Lohith","Madhav","Mohammed","Mridul","Navjot","Nikhil","Nimit","Nishith","Ojas","Om","Onkar","Paramjit","Paritosh","Parth","Parvez","Pavan","Pranav","Purab","Rehaan","Rohan","Sahil","Salman","Samarth","Samir","Sanchit","Sanjay","Sarabjit","Shahzad","Shantanu","Shishir","Shray","Sparsh","Sumer","Surjan","Swapan","Tarun","Tejas","Tushar","Udit","Umang","Umar","Varun","Veer","Vidur","Vinay","Yash","Zeeshan","Zubin","Rajesh","Ramesh","Sanju","Manju","Alfaz","Bhavesh","Bipin","Daljeet","Fardeen","Girish"];return a[Math.floor(Math.random()*(a.length-1+1))]},i.removeObjectFromArray=function(a,e){var t=a.indexOf(e);return-1!==t&&a.splice(t,1),a},i.harmonicMean=function(a){for(var e=a.length,t=0,n=0;n<e;n++)t+=1/a[n];return e/t},i.millisecondsToTime=function(a){var e=a%1e3,t=Math.floor(a/1e3%60);return Math.floor(a/6e4%60)+":"+t+":"+e},i.fancyTimeFormat=function(a){var e=~~(a/86400),t=~~(a%86400/3600),n=~~(a%3600/60),r=~~a%60,i="";return e>0&&(i+=e+" : "+(t<10?"0":"")),t>0&&(i+=t+" : "+(n<10?"0":"")),i+=n<10?"0"+n+" : "+(r<10?"0":""):n+" : "+(r<10?"0":""),i+=""+r},i.fancyTimeHourFormat=function(a){var e=~~(a/86400),t=~~(a%86400/3600),n=~~(a%3600/60),r=~~a%60,i="";return e>0&&(i+=e+"d : "+(t<10?"0":"")),t>0&&(i+=t+"h : "+(n<10?"0":"")),n>0&&(i+=n+"m : "+(r<10?"0":"")),i+=r+"s"},i.getIntValue=function(a){return parseInt(a)},r}(u))||h);r._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./commonFun.ts","./mxManager.ts","./GameConfig.ts","./constant.ts","./audioManager.ts","./SocketConnection.ts","./Helper.ts","./PlayerMovement.ts"],(function(e){"use strict";var t,i,n,o,s,a,r,h,c,l,u,m,p,d,S,g,C,P,_,A,v;return{setters:[function(e){t=e.inheritsLoose,i=e.defineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,a=e.Vec3,r=e.SkeletalAnimationComponent,h=e.RigidBodyComponent,c=e.Vec2,l=e.instantiate,u=e.tween,m=e.macro},function(e){p=e.CommonFun},function(e){d=e.MxManager},function(e){S=e.GameConfig},function(e){g=e.constant},function(e){C=e.audioManager},function(e){P=e.SocketConnection,_=e.SocketListener},function(e){A=e.STATE},function(e){v=e.PlayerMovement}],execute:function(){var y;o._RF.push({},"a3addpkf1lOCoVufXlKk5xR","Player",void 0);var f=s.ccclass,w=(s.property,.016);e("Player",f("Player")(y=function(e){function o(){for(var t,o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,i(n(t),"playerCamera",null),i(n(t),"_isPlayer",!1),i(n(t),"playerName",void 0),i(n(t),"_currentFollowingNode",null),i(n(t),"_currentPlayerPosition",a.ZERO),i(n(t),"_vector",a.ZERO),i(n(t),"_vectorAngle",a.ZERO),i(n(t),"_now_time",0),i(n(t),"_skeletal",void 0),i(n(t),"_currentState",A.IDLE),i(n(t),"_charName","LOL"),i(n(t),"eatTimeout",null),i(n(t),"gameController",null),i(n(t),"initialSize",0),i(n(t),"maxSize",0),i(n(t),"startSpeed",0),i(n(t),"endspeed",0),i(n(t),"maxScale",0),i(n(t),"currentScale",0),i(n(t),"speed",0),i(n(t),"bumpTween",null),i(n(t),"bumptimeTween",null),i(n(t),"_isPoisionSpeedActive",!1),i(n(t),"_isGainSpeedActive",!1),i(n(t),"_isSheildActive",!1),i(n(t),"_poisionSpeedActiveCount",0),i(n(t),"_gainSpeedActiveCount",0),i(n(t),"_sheildActiveCount",0),i(n(t),"_sheildCountDown",0),i(n(t),"_poisionSpeedActivePercentage",0),i(n(t),"_gainSpeedActivePercentage",0),i(n(t),"_score",0),i(n(t),"_totalSumoPushed",0),i(n(t),"_newBumpPosition",a.ZERO),i(n(t),"_collidedOpponentPlayer",null),i(n(t),"commonFun",null),i(n(t),"playerData",null),i(n(t),"_playerExited",!1),i(n(t),"outsideCount",0),i(n(t),"isReady",!1),t}t(o,e);var s=o.prototype;return s.onLoad=function(){this.commonFun=new p,this._skeletal=this.node.getChildByName("Penguine_Anim").getComponent(r),this.commonFun.setIdleStateAnimation(this),this.setProperties(),this.schedule(this.powerUpUpdates,1),this.isReady=!0},s.setAnimState=function(e){"Idle"?this.commonFun.setIdleStateAnimation(this):this.commonFun.setWalkStateAnimation(this)},s.setProperties=function(){this._isPlayer=!0,this.initialSize=S.player.initialSize,this.maxSize=S.player.playerMaxSize,this.startSpeed=S.player.playerStartSpeed,this.endspeed=S.player.playerEndSpeed,this.setCurrentScale(this.initialSize),this.node.scale.set(this.currentScale,this.currentScale,this.currentScale),this.maxScale=this.maxSize,d.instance.isMiloApp?this.getComponent(h).linearFactor.y=0:this.getComponent(h).linearFactor.y=1,this.updateSpeed()},s.setCamera=function(e,t,i){this.playerCamera=e,this.gameController=t,S.debug.camera.angleChange&&(this.playerCamera.eulerAngles=new a(i.x,i.y+180,i.z));var n=new c(this.node.getPosition().x,this.node.getPosition().z);n.lerp(n,.1),this.playerCamera.setPosition(new a(n.x,this.node.getPosition().y,n.y))},s.setMiloCamera=function(e,t,i){this.playerCamera=e,this.gameController=t},s.addName=function(e,t){this.playerName=l(e),t.addChild(this.playerName),this._charName="you",this.characterHud=this.playerName.getComponent("CharacterHud"),this.characterHud.updateNameData(this._charName),this.updateNamePos()},s.updateName=function(e){this._charName=e.name,this.characterHud=this.playerName.getComponent("CharacterHud"),this.characterHud.updateNameData(this._charName),this.updateNamePos()},s.updateSpeed=function(){this.speed=this.commonFun.getNewModifiedSpeed(this.getCurrentScale(),this),this.commonFun.changeWalkAnimationSpeed(this.speed,this)},s.setSpeed=function(e){this.speed=e},s.getSpeed=function(){return this.speed},s.startSheild=function(e){this.commonFun.setPowerGainAnimation(this),this.characterHud.startPowerupProgress(e),this.gameController.startPowerupProgress(e,"sheild"),this._sheildActiveCount+=e,this._sheildCountDown=3,this._isSheildActive=!0},s.checkGainSpeedActive=function(){return this._isGainSpeedActive},s.checkPoisionSpeedActive=function(){return this._isPoisionSpeedActive},s.checkSheildActive=function(){return this._isSheildActive},s.reEvaluateSpeed=function(e,t,i){if(this.characterHud.startPowerupProgress(t),this.gameController.startPowerupProgress(t,i?"GainSpeed":"PoisionSpeed"),i){if(this._isGainSpeedActive)return this._isPoisionSpeedActive=!1,this._isGainSpeedActive=!1,this._poisionSpeedActiveCount=0,void(this._gainSpeedActiveCount=0);this._poisionSpeedActivePercentage=e,this._poisionSpeedActiveCount+=t,this._isPoisionSpeedActive=!0,this.commonFun.setPowerGainAnimation(this),this.commonFun.changeWalkAnimationSpeed(this.speed,this)}else{if(this._isPoisionSpeedActive)return this._isPoisionSpeedActive=!1,this._isGainSpeedActive=!1,this._poisionSpeedActiveCount=0,void(this._gainSpeedActiveCount=0);this._gainSpeedActivePercentage=e,this._gainSpeedActiveCount+=t,this._isGainSpeedActive=!0,this.commonFun.setPowerLoseAnimation(this),this.commonFun.changeWalkAnimationSpeed(this.speed,this)}},s.powerUpUpdates=function(){this._isPoisionSpeedActive&&this._poisionSpeedActiveCount>0&&(this._poisionSpeedActiveCount--,this.characterHud.updatePowerProgress(this._poisionSpeedActiveCount),this.gameController.updatePowerProgress(this._poisionSpeedActiveCount),this._poisionSpeedActiveCount<=0&&(this._poisionSpeedActiveCount=0,this._isPoisionSpeedActive=!1)),this._isGainSpeedActive&&this._gainSpeedActiveCount>0&&(this._gainSpeedActiveCount--,this.characterHud.updatePowerProgress(this._gainSpeedActiveCount),this.gameController.updatePowerProgress(this._gainSpeedActiveCount),this._gainSpeedActiveCount<=0&&(this._gainSpeedActiveCount=0,this._isGainSpeedActive=!1)),this._isSheildActive&&this._sheildActiveCount>0&&(this._sheildCountDown>=0&&C.instance.playSound(g.AUDIO_SOUND.sheildPowerUp),this._sheildCountDown--,this._sheildActiveCount--,this.characterHud.updatePowerProgress(this._sheildActiveCount),this.gameController.updatePowerProgress(this._sheildActiveCount),this._sheildActiveCount<=0&&(this._sheildActiveCount=0,this._isSheildActive=!1))},s.resize=function(e,t){var i=this;t?this.getCurrentScale()<=this.maxScale&&(this.setCurrentScale(this.getCurrentScale()+this.commonFun.getPercentage(100*e,this.currentScale)),this.getCurrentScale()>this.maxScale&&this.setCurrentScale(this.maxScale),u(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){i.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale()),this.commonFun.setPowerGainAnimation(this)):this.getCurrentScale()>this.initialSize&&(this.setCurrentScale(this.getCurrentScale()-this.commonFun.getPercentage(100*e,this.currentScale)),this.getCurrentScale()<this.initialSize&&this.setCurrentScale(this.initialSize),u(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){i.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale()),this.commonFun.setPowerLoseAnimation(this))},s.removeAllHud=function(){this.gameController.getWorld().removeChild(this.playerName)},s.hideSelf=function(){this.node.active=!1,this.playerName.active=!1},s._onDeathPlatform=function(){C.instance.playSound(g.AUDIO_SOUND.myDeath);if(null!=this._collidedOpponentPlayer){var e=null==this._collidedOpponentPlayer.getComponent("Bot")?this._collidedOpponentPlayer.getComponent("Player"):this._collidedOpponentPlayer.getComponent("Bot"),t=this.getCurrentScale(),i=e.getCurrentScale(),n=i;if(t<i)n=this.commonFun.harmonicMean([t,i])-t;else if(t>i)n=2*(this.commonFun.harmonicMean([t,i])-i);else{n=0;var o=S.powerup.GummyBear.gainPercentage;e.resize(o,!0)}n>0&&e.increasePlayerScaleOnOpponentDeath(n),e.updateScore(S.commonData.deathScore),e._totalSumoPushed++}this.removeAllHud(),this.commonFun.removeObjectFromArray(this.gameController.botController._totalPlayerArrayList,this.node),this.gameController.getWorld().removeChild(this.node);var s=new Date;this.gameController.currentTime;var a={name:this._charName,time:s.getTime(),isSelf:!0};if(this.gameController.playerBoardData.push(a),1==this.gameController.botController._totalPlayerArrayList.length){var r=this.gameController.botController._totalPlayerArrayList[0];a={name:(null==r.getComponent("Bot")?r.getComponent("Player"):r.getComponent("Bot"))._charName,time:s.getTime(),isSelf:!1};this.gameController.playerBoardData.push(a)}},s.OnUpdateCollision=function(e){var t=this;if(null==this._collidedOpponentPlayer||this._collidedOpponentPlayer.uuid!=e.uuid){var i=e;this._collidedOpponentPlayer=i,this.commonFun.setBumpStateAnimation(this),C.instance.playSound(g.AUDIO_SOUND.push),this.getComponent(h).clearVelocity();var n=new a(this.node.getPosition().x-i.getPosition().x,0,this.node.getPosition().z-i.getPosition().z).normalize(),o=this.getBumpValue(i),s=new a(this.node.getPosition().x+o*n.x,this.node.getPosition().z+o*n.z);this._newBumpPosition=new a(s.x,this.node.getPosition().y,s.y),null!=this.bumpTween&&(this.bumpTween.stop(),clearTimeout(this.bumptimeTween)),this.bumpTween=u(this.node).to(S.commonData.bumpTime,{position:this._newBumpPosition}).start(),this.bumptimeTween=setTimeout((function(){t.getComponent(h).clearVelocity(),t.bumptimeTween=null,t.commonFun.setWalkStateAnimation(t),t.bumptimeTween=setTimeout((function(){t._collidedOpponentPlayer=null}),1e3*S.commonData.bumpTime)}),1e3*S.commonData.bumpTime)}},s._onCollisionEnter=function(e){var t=this,i=e.otherCollider;this._collidedOpponentPlayer=i.node,this.commonFun.setBumpStateAnimation(this),C.instance.playSound(g.AUDIO_SOUND.push),this.getComponent(h).clearVelocity();var n=new a(this.node.getPosition().x-i.node.getPosition().x,0,this.node.getPosition().z-i.node.getPosition().z).normalize(),o=this.getBumpValue(i.node),s=new a(this.node.getPosition().x+o*n.x,this.node.getPosition().z+o*n.z);this._newBumpPosition=new a(s.x,this.node.getPosition().y,s.y),null!=this.bumpTween&&(this.bumpTween.stop(),clearTimeout(this.bumptimeTween)),this.bumpTween=u(this.node).to(S.commonData.bumpTime,{position:this._newBumpPosition}).start(),this.bumptimeTween=setTimeout((function(){t.getComponent(h).clearVelocity(),t.bumptimeTween=null,t.commonFun.setWalkStateAnimation(t),t.bumptimeTween=setTimeout((function(){t._collidedOpponentPlayer=null}),1e3*S.commonData.bumpTime)}),1e3*S.commonData.bumpTime)},s.updateScore=function(e){this._score=this._score+e,this._score<0&&(this._score=0),this.characterHud.showScore(e),this.gameController.gameScore.string="<color=#000000><size=56>Score : </size><color=#449b9a><size=56>"+this._score+"</size>"},s.updateScoreFromServer=function(e,t){this._score=e,this._score<0&&(this._score=0),t&&(this.characterHud.showScore(e),this.gameController.gameScore.string="<color=#000000><size=56>Score : </size><color=#449b9a><size=56>"+this._score+"</size>")},s.increasePlayerScaleOnOpponentDeath=function(e){var t=this;this.getCurrentScale()<=this.maxScale&&(this.setCurrentScale(this.getCurrentScale()+e),this.getCurrentScale()>this.maxScale&&this.setCurrentScale(this.maxScale),u(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){t.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale()))},s.getBumpValue=function(e){var t=this;if(this.checkSheildActive())return 0;var i=null==e.getComponent("Bot")?e.getComponent("Player"):e.getComponent("Bot"),n=(this.speed,this.getCurrentScale(),this.getCurrentScale());S.commonData.bumpTime;n=this.getBumpSize(),this.getCurrentScale()>this.initialSize&&(this.setCurrentScale(this.getCurrentScale()-n),this.getCurrentScale()<this.initialSize&&this.setCurrentScale(this.initialSize),u(this.node.scale).to(1,new a(this.currentScale,this.currentScale,this.currentScale)).call((function(){t.updateSpeed()})).start(),this.characterHud.tweenPosition(this.getCurrentScale())),this.updateSpeed();var o=(this.getCurrentScale()+this.getSpeed())*i.getCurrentScale()-this.getCurrentScale();return this.getCurrentScale()<i.getCurrentScale()&&(o*=1.5),this.checkDidBumpedOnBck(e)&&(o=(this.getCurrentScale()+this.getSpeed())*i.getCurrentScale(),o*=S.commonData.playerBumpMe),this.isPlayerBumpedOnOtherBack(e)&&(o=(this.getCurrentScale()+this.getSpeed())*i.getCurrentScale(),o*=S.commonData.meBumpPlayer),o},s.getBumpSize=function(){return this.commonFun.getPercentage(S.commonData.bumpSizeDecreasePercentage,this.getCurrentScale())},s.getCurrentScale=function(){return this.currentScale},s.setCurrentScale=function(e){this.currentScale=e},s.sliderCallBack=function(e,t){var i=this.playerCamera.getChildByName("playerCamera");"YSlider"==e?i.setPosition(new a(i.position.x,t,i.position.z)):"ZSlider"==e?i.setPosition(new a(i.position.x,i.position.y,t)):"XSlider"==e?i.setPosition(new a(t,i.position.y,i.position.z)):"RYSlider"==e?i.eulerAngles=new a(t,i.eulerAngles.y,i.eulerAngles.z):"RXSlider"==e?i.eulerAngles=new a(i.eulerAngles.x,t,i.eulerAngles.z):"RZSlider"==e&&(i.eulerAngles=new a(i.eulerAngles.x,i.eulerAngles.y,t))},s.touchCallBack=function(e,t){a.rotateZ(e,e,a.ZERO,this.playerCamera.eulerAngles.y*m.RAD),this._vector=e.normalize(),t&&(this.node.eulerAngles=new a(0,t+90+this.playerCamera.eulerAngles.y,0))},s.touchAngleCallBack=function(e,t){this._vectorAngle=e.normalize()},s.updateNamePos=function(){var e=this.node.getPosition();this.characterHud.updateHudPos(e,this.playerCamera)},s.inside=function(e,t){for(var i=e.x,n=e.y,o=!1,s=0,a=t.length-1;s<t.length;a=s++){var r=t[s].x,h=t[s].z,c=t[a].x,l=t[a].z;h>n!=l>n&&i<(c-r)*(n-h)/(l-h)+r&&(o=!o)}return o},s.fix_update=function(e){if(!this.gameController.gameOverCalled&&this._currentState!=A.BUMP){if(!d.instance.isMiloApp)if(this.inside(new c(this.node.position.x,this.node.position.z),this.gameController.platformVertices))this.outsideCount=0;else if(this.outsideCount++,this.outsideCount>=10)return this._onDeathPlatform(),void this.gameController.showGameOver();var t=this.getSpeed();this._isPoisionSpeedActive&&this._poisionSpeedActiveCount>0&&(t+=this.commonFun.getPercentage(100*this._poisionSpeedActivePercentage,this.speed)),this._isGainSpeedActive&&this._gainSpeedActiveCount>0&&(t+=this.commonFun.getPercentage(100*this._gainSpeedActivePercentage,this.speed)),this._vector.lengthSqr()>0?(this._currentState==A.IDLE&&this.commonFun.setWalkStateAnimation(this),this.node.setPosition(this.node.position.add3f(this._vector.x*t*e,0,-this._vector.y*t*e)),this._currentPlayerPosition=new a(this._vector.x,0,this._vector.y)):P.localDev||this.node.setPosition(this.node.position.add3f(this._currentPlayerPosition.x*this.speed*e,0,-this._currentPlayerPosition.z*this.speed*e))}},s.updateCamera=function(){var e=new c(this.node.getPosition().x,this.node.getPosition().z);e.lerp(e,.1),this.playerCamera.setPosition(new a(e.x,this.node.getPosition().y,e.y))},s.update=function(e){if(!parseInt(window.localStorage.getItem("isStopped"))&&this.isReady)for(this._now_time+=e;this._now_time>=w;)this.updateNamePos(),d.instance.isMiloApp?this.isSelfUpdateAllowed&&(this.fix_update(w),this.updateCamera()):(this.fix_update(w),this.updateCamera()),this._now_time-=w},s.isPlayerBumpedOnOtherBack=function(e){var t=new c(this.node.getPosition().x,this.node.getPosition().z),i=new c(e.getPosition().x,e.getPosition().z),n=Math.round(e.eulerAngles.y)+60;n>180&&(n-=360);var o=Math.round(e.eulerAngles.y)-60;o<-180&&(o+=360);var s=180*Math.atan2(t.y-i.y,t.x-i.x)/Math.PI;return s=this.commonFun.findGameAngle(s),!!this.commonFun.angleBetweenAngle(s,n,o)},s.checkDidBumpedOnBck=function(e){var t=new c(this.node.getPosition().x,this.node.getPosition().z),i=new c(e.getPosition().x,e.getPosition().z),n=Math.round(this.node.eulerAngles.y)+100;n>180&&(n-=360);var o=Math.round(this.node.eulerAngles.y)-100;o<-180&&(o+=360);var s=180*Math.atan2(i.y-t.y,i.x-t.x)/Math.PI;return s=this.commonFun.findGameAngle(s),!!this.commonFun.angleBetweenAngle(s,n,o)},s.collisionReceivedFromServer=function(e,t){var i=this;this._collidedOpponentPlayer=t.node,C.instance.playSound(g.AUDIO_SOUND.push),this.commonFun.setBumpStateAnimation(this),this.getComponent(h).clearVelocity();var n=e.bumpPos;null!=this.bumpTween&&(this.bumpTween.stop(),clearTimeout(this.bumptimeTween)),this.bumpTween=u(this.node).to(S.commonData.bumpTime,{position:new a(n.x,this.node.getPosition().y,n.y)}).start(),this.bumptimeTween=setTimeout((function(){i.getComponent(h).clearVelocity(),i.commonFun.setWalkStateAnimation(i),i.bumptimeTween=null,i.bumptimeTween=setTimeout((function(){i._collidedOpponentPlayer=null,i.afterCollison()}),1e3*S.commonData.bumpTime)}),1e3*S.commonData.bumpTime)},s.powerUpBumpListener=function(e){var t=this;if("Sheild"==e.name)this.startSheild(e.duration);else if("PoisionSpeed"==e.name||"GainSpeed"==e.name)this.reEvaluateSpeed(e.gainValue,e.duration,e.isGain);else if("PoisionSize"==e.name||"GummyBear"==e.name){var i=e.scale;this.currentScale=i,u(this.node.scale).to(1,new a(i,i,i)).call((function(){t.updateSpeed(),t.afterCollisonToPowerUp()})).start(),e.isGain?(this.characterHud.tweenPosition(this.getCurrentScale()),this.commonFun.setPowerGainAnimation(this)):(this.characterHud.tweenPosition(this.getCurrentScale()),this.commonFun.setPowerLoseAnimation(this))}},s.afterCollison=function(){P.instance.send({command:_.ON_BUMP,data:{msg:"After bump callback"}})},s.afterCollisonToPowerUp=function(){P.instance.send({command:_.ON_POWERUP_BUMP,data:{msg:"After powerup bump callback"}})},s.setAnimationState=function(e){switch(e){case A.BUMP:this.commonFun.setBumpStateAnimation(this);break;case A.EAT:this.commonFun.setPowerGainAnimation(this);break;case A.IDLE:this.commonFun.setIdleStateAnimation(this);break;case A.WALK:this.commonFun.setWalkStateAnimation(this);break;case A.WIN:this.commonFun.setWinStateAnimation(this)}},o}(v))||y);o._RF.pop()}}}));

System.register("chunks:///_virtual/localConfig.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./resourceUtil.ts","./csvManager.ts"],(function(n){"use strict";var r,t,e,a,s,i;return{setters:[function(n){r=n.defineProperty,t=n.createClass},function(n){e=n.cclegacy,a=n._decorator},function(n){s=n.resourceUtil},function(n){i=n.csvManager}],execute:function(){var c,o,u;e._RF.push({},"b04c1Prv6lKsZf481h5hCUF","localConfig",void 0);var l=a.ccclass;a.property,n("localConfig",l("localConfig")((u=o=function(){function n(){r(this,"csvManager",null),r(this,"arrCars",[]),r(this,"_callback",null),r(this,"_skills",{}),r(this,"currentLoad",0),r(this,"cntLoad",0),r(this,"servers",[])}var e=n.prototype;return e.loadConfig=function(n){this._callback=n,this.csvManager=new i,this.loadCSV()},e.loadCSV=function(){var n=this,r=["talk","car","signIn"];this.cntLoad=r.length+1,r.forEach((function(r,t,e){s.getData(r,(function(t,e){n.csvManager.addTable(r,e),n.tryToCallbackOnFinished()}))})),s.getJsonData("servers",(function(r,t){n.servers=t,n.tryToCallbackOnFinished()}))},e.queryOne=function(n,r,t){return this.csvManager.queryOne(n,r,t)},e.queryByID=function(n,r){return this.csvManager.queryByID(n,r)},e.getTable=function(n){return this.csvManager.getTable(n)},e.getTableArr=function(n){return this.csvManager.getTableArr(n)},e.getCars=function(){if(this.arrCars.length>0)return this.arrCars;var r=n.instance.getTableArr("car");return this.arrCars=r.sort((function(n,r){return n.sort-r.sort})),this.arrCars},e.queryAll=function(n,r,t){return this.csvManager.queryAll(n,r,t)},e.queryIn=function(n,r,t){return this.csvManager.queryIn(n,r,t)},e.queryByCondition=function(n,r){return this.csvManager.queryByCondition(n,r)},e.tryToCallbackOnFinished=function(){this._callback&&(this.currentLoad++,this.currentLoad>=this.cntLoad&&this._callback())},e.getCurrentServer=function(){return this.servers[0]},e.getVersion=function(){var n=this.getCurrentServer();return n?n.version:"unknown"},t(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}(),r(o,"_instance",void 0),c=u))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/MiloManager.ts",["cc"],(function(e){"use strict";var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"b14a73ELXhMArrIH12FDw58","MiloManager",void 0);e("MiloManager",(function(){var e=window.location.href.split("?"),r="1";e[1]&&(r=e[1].split("user")[1]);var a=[{userId:"mx-user-1",gameId:"86a01a92a84646e4ad33252f19b39385",roomId:"7d1b376b-0eee-4d53-bd91-3cda5de62b43-1625715627668",highestScore:90,lastLevel:0,gameMode:"score",isFirstOpen:!0,roomType:"public/private",balance:100,micEnabled:!0},{userId:"mx-user-2",gameId:"86a01a92a84646e4ad33252f19b39385",roomId:"7d1b376b-0eee-4d53-bd91-3cda5de62b43-1625715627668",highestScore:90,lastLevel:0,gameMode:"score",isFirstOpen:!0,roomType:"public/private",balance:100,micEnabled:!0}][parseInt(r)-1],t=Object.assign({},{players:[{bot:!1,host:!0,name:"Player1",profilePicUrl:"https://i.picsum.photos/id/177/200/200.jpg?hmac=785Vry8HsdS9dQ7mFYbwV8bR2tWVtzJWWl9YLp6L0n8",userId:"mx-user-1"},{bot:!1,host:!1,name:"Player2",profilePicUrl:"https://i.picsum.photos/id/445/200/300.jpg?hmac=7dfJBQTfK8boCS5_EXpFW8SC_8VKMgDw5yFInpEee4s",userId:"mx-user-2"}]},{initInfo:a});return{onGameInit:function(){return JSON.stringify(t)},onGameOver:function(){},onGameStart:function(){},onError:function(){}}}));r._RF.pop()}}}));

System.register("chunks:///_virtual/Menu.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,r,o,u;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,r=t._decorator,o=t.log,u=t.Component}],execute:function(){var c;n._RF.push({},"b33e1uYXghIYZH6cQOlyEBZ","Menu",void 0);var i=r.ccclass;r.property,t("Menu",i("Menu")(c=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var r=n.prototype;return r.start=function(){},r.onPlayClicked=function(){o("Start Game")},n}(u))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/colyseus.js",["./cjs-loader.mjs"],(function(e,t){"use strict";var n;return{setters:[function(e){n=e.default}],execute:function(){e("default",void 0),n.define(t.meta.url,(function(t,i,r,o,s){n.createRequireWithReqMap({},i);!function(){!function(e,n){"object"==typeof t&&void 0!==r?n(t):"function"==typeof define&&define.amd?define("colyseus.js",["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Colyseus={})}(this,(function(e){ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return null!==e&&"object"==typeof e&&e.buffer instanceof ArrayBuffer}),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window)
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation.
             Permission to use, copy, modify, and/or distribute this software for any
            purpose with or without fee is hereby granted.
             THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
            REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
            AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
            INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
            LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
            OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
            PERFORMANCE OF THIS SOFTWARE.
            ***************************************************************************** */;var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}function i(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{f(i.next(e))}catch(e){o(e)}}function a(e){try{f(i.throw(e))}catch(e){o(e)}}function f(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}f((i=i.apply(e,t||[])).next())}))}function r(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function o(e,t){t.headers=e.headers||{},t.statusMessage=e.statusText,t.statusCode=e.status,t.data=e.response}function s(e,t,n){return new Promise((function(i,r){n=n||{};var s,a,f,h=new XMLHttpRequest,c=n.body,u=n.headers||{};for(s in n.timeout&&(h.timeout=n.timeout),h.ontimeout=h.onerror=function(e){e.timeout="timeout"==e.type,r(e)},h.open(e,t.href||t),h.onload=function(){for(f=h.getAllResponseHeaders().trim().split(/[\r\n]+/),o(h,h);a=f.shift();)a=a.split(": "),h.headers[a.shift().toLowerCase()]=a.join(": ");if((a=h.headers["content-type"])&&~a.indexOf("application/json"))try{h.data=JSON.parse(h.data,n.reviver)}catch(e){return o(h,e),r(e)}(h.status>=400?r:i)(h)},typeof FormData<"u"&&c instanceof FormData||c&&"object"==typeof c&&(u["content-type"]="application/json",c=JSON.stringify(c)),h.withCredentials=!!n.withCredentials,u)h.setRequestHeader(s,u[s]);h.send(c)}))}var a=s.bind(s,"GET"),f=s.bind(s,"POST"),h=s.bind(s,"PATCH"),c=s.bind(s,"DELETE"),u=a,d=h,p=f,l=s.bind(s,"PUT"),v=s,y={del:c,get:u,patch:d,post:p,put:l,send:v},g=Object.freeze(Object.assign(Object.create(null),y,{default:y,del:c,get:u,patch:d,post:p,put:l,send:v})),m=function(e){function t(t,n){var i=e.call(this,n)||this;return i.name="ServerError",i.code=t,i}return n(t,e),t}(Error);function _(e,t){if(this._offset=t,e instanceof ArrayBuffer)this._buffer=e,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(e))throw new Error("Invalid argument");this._buffer=e.buffer,this._view=new DataView(this._buffer,e.byteOffset,e.byteLength)}}function w(e,t,n){for(var i=0,r=0,o=n.length;r<o;r++)(i=n.charCodeAt(r))<128?e.setUint8(t++,i):i<2048?(e.setUint8(t++,192|i>>6),e.setUint8(t++,128|63&i)):i<55296||i>=57344?(e.setUint8(t++,224|i>>12),e.setUint8(t++,128|i>>6&63),e.setUint8(t++,128|63&i)):(r++,i=65536+((1023&i)<<10|1023&n.charCodeAt(r)),e.setUint8(t++,240|i>>18),e.setUint8(t++,128|i>>12&63),e.setUint8(t++,128|i>>6&63),e.setUint8(t++,128|63&i))}function A(e,t,n){var i=typeof n,r=0,o=0,s=0,a=0,f=0,h=0;if("string"===i){if((f=function(e){for(var t=0,n=0,i=0,r=e.length;i<r;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}(n))<32)e.push(160|f),h=1;else if(f<256)e.push(217,f),h=2;else if(f<65536)e.push(218,f>>8,f),h=3;else{if(!(f<4294967296))throw new Error("String too long");e.push(219,f>>24,f>>16,f>>8,f),h=5}return t.push({_str:n,_length:f,_offset:e.length}),h+f}if("number"===i)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(e.push(n),1):n<256?(e.push(204,n),2):n<65536?(e.push(205,n>>8,n),3):n<4294967296?(e.push(206,n>>24,n>>16,n>>8,n),5):(s=n/Math.pow(2,32)>>0,a=n>>>0,e.push(207,s>>24,s>>16,s>>8,s,a>>24,a>>16,a>>8,a),9):n>=-32?(e.push(n),1):n>=-128?(e.push(208,n),2):n>=-32768?(e.push(209,n>>8,n),3):n>=-2147483648?(e.push(210,n>>24,n>>16,n>>8,n),5):(s=Math.floor(n/Math.pow(2,32)),a=n>>>0,e.push(211,s>>24,s>>16,s>>8,s,a>>24,a>>16,a>>8,a),9):(e.push(203),t.push({_float:n,_length:8,_offset:e.length}),9);if("object"===i){if(null===n)return e.push(192),1;if(Array.isArray(n)){if((f=n.length)<16)e.push(144|f),h=1;else if(f<65536)e.push(220,f>>8,f),h=3;else{if(!(f<4294967296))throw new Error("Array too large");e.push(221,f>>24,f>>16,f>>8,f),h=5}for(r=0;r<f;r++)h+=A(e,t,n[r]);return h}if(n instanceof Date){var c=n.getTime();return s=Math.floor(c/Math.pow(2,32)),a=c>>>0,e.push(215,0,s>>24,s>>16,s>>8,s,a>>24,a>>16,a>>8,a),10}if(n instanceof ArrayBuffer){if((f=n.byteLength)<256)e.push(196,f),h=2;else if(f<65536)e.push(197,f>>8,f),h=3;else{if(!(f<4294967296))throw new Error("Buffer too large");e.push(198,f>>24,f>>16,f>>8,f),h=5}return t.push({_bin:n,_length:f,_offset:e.length}),h+f}if("function"==typeof n.toJSON)return A(e,t,n.toJSON());var u=[],d="",p=Object.keys(n);for(r=0,o=p.length;r<o;r++)"function"!=typeof n[d=p[r]]&&u.push(d);if((f=u.length)<16)e.push(128|f),h=1;else if(f<65536)e.push(222,f>>8,f),h=3;else{if(!(f<4294967296))throw new Error("Object too large");e.push(223,f>>24,f>>16,f>>8,f),h=5}for(r=0;r<f;r++)h+=A(e,t,d=u[r]),h+=A(e,t,n[d]);return h}if("boolean"===i)return e.push(n?195:194),1;if("undefined"===i)return e.push(212,0,0),3;throw new Error("Could not encode")}function $(e){var t=[],n=[],i=A(t,n,e),r=new ArrayBuffer(i),o=new DataView(r),s=0,a=0,f=-1;n.length>0&&(f=n[0]._offset);for(var h,c=0,u=0,d=0,p=t.length;d<p;d++)if(o.setUint8(a+d,t[d]),d+1===f){if(c=(h=n[s])._length,u=a+f,h._bin)for(var l=new Uint8Array(h._bin),v=0;v<c;v++)o.setUint8(u+v,l[v]);else h._str?w(o,u,h._str):void 0!==h._float&&o.setFloat64(u,h._float);a+=c,n[++s]&&(f=n[s]._offset)}return r}_.prototype._array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this._parse();return t},_.prototype._map=function(e){for(var t={},n=0;n<e;n++)t[this._parse()]=this._parse();return t},_.prototype._str=function(e){var t=function(e,t,n){for(var i="",r=0,o=t,s=t+n;o<s;o++){var a=e.getUint8(o);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(r=(7&a)<<18|(63&e.getUint8(++o))<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0)>=65536?(r-=65536,i+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):i+=String.fromCharCode(r)}else i+=String.fromCharCode((15&a)<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0);else i+=String.fromCharCode((31&a)<<6|63&e.getUint8(++o));else i+=String.fromCharCode(a)}return i}(this._view,this._offset,e);return this._offset+=e,t},_.prototype._bin=function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t},_.prototype._parse=function(){var e,t=this._view.getUint8(this._offset++),n=0,i=0,r=0,o=0;if(t<192)return t<128?t:t<144?this._map(15&t):t<160?this._array(15&t):this._str(31&t);if(t>223)return-1*(255-t+1);switch(t){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:return n=this._view.getUint8(this._offset),i=this._view.getInt8(this._offset+1),this._offset+=2,[i,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),i=this._view.getInt8(this._offset+2),this._offset+=3,[i,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),i=this._view.getInt8(this._offset+4),this._offset+=5,[i,this._bin(n)];case 202:return e=this._view.getFloat32(this._offset),this._offset+=4,e;case 203:return e=this._view.getFloat64(this._offset),this._offset+=8,e;case 204:return e=this._view.getUint8(this._offset),this._offset+=1,e;case 205:return e=this._view.getUint16(this._offset),this._offset+=2,e;case 206:return e=this._view.getUint32(this._offset),this._offset+=4,e;case 207:return r=this._view.getUint32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,r+o;case 208:return e=this._view.getInt8(this._offset),this._offset+=1,e;case 209:return e=this._view.getInt16(this._offset),this._offset+=2,e;case 210:return e=this._view.getInt32(this._offset),this._offset+=4,e;case 211:return r=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,r+o;case 212:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?void(this._offset+=1):[i,this._bin(1)];case 213:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(2)];case 214:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(4)];case 215:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?(r=this._view.getInt32(this._offset)*Math.pow(2,32),o=this._view.getUint32(this._offset+4),this._offset+=8,new Date(r+o)):[i,this._bin(8)];case 216:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")};var E,O,I=globalThis.WebSocket||function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},b=function(){function e(e){this.events=e}return e.prototype.send=function(e){e instanceof ArrayBuffer?this.ws.send(e):Array.isArray(e)&&this.ws.send(new Uint8Array(e).buffer)},e.prototype.connect=function(e){this.ws=new I(e,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror},e.prototype.close=function(e,t){this.ws.close(e,t)},e}(),x=function(){function e(){this.events={},this.transport=new b(this.events)}return e.prototype.send=function(e){this.transport.send(e)},e.prototype.connect=function(e){this.transport.connect(e)},e.prototype.close=function(e,t){this.transport.close(e,t)},e}(),R={};function T(e,t){R[e]=t}function C(e){var t=R[e];if(!t)throw new Error("missing serializer: "+e);return t}e.Protocol=void 0,(E=e.Protocol||(e.Protocol={}))[E.HANDSHAKE=9]="HANDSHAKE",E[E.JOIN_ROOM=10]="JOIN_ROOM",E[E.ERROR=11]="ERROR",E[E.LEAVE_ROOM=12]="LEAVE_ROOM",E[E.ROOM_DATA=13]="ROOM_DATA",E[E.ROOM_STATE=14]="ROOM_STATE",E[E.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",E[E.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",e.ErrorCode=void 0,(O=e.ErrorCode||(e.ErrorCode={}))[O.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",O[O.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",O[O.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",O[O.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",O[O.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",O[O.AUTH_FAILED=4215]="AUTH_FAILED",O[O.APPLICATION_ERROR=4216]="APPLICATION_ERROR";var P=function(){function e(){this.handlers=[]}return e.prototype.register=function(e,t){return this.handlers.push(e),this},e.prototype.invoke=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.handlers.forEach((function(n){return n.apply(e,t)}))},e.prototype.invokeAsync=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.all(this.handlers.map((function(n){return n.apply(e,t)})))},e.prototype.remove=function(e){var t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()},e.prototype.clear=function(){this.handlers=[]},e}();function S(){var e=new P;function t(t){return e.register(t,null===this)}return t.once=function(t){e.register((function n(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];t.apply(this,i),e.remove(n)}))},t.remove=function(t){return e.remove(t)},t.invoke=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invoke.apply(e,t)},t.invokeAsync=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.invokeAsync.apply(e,t)},t.clear=function(){return e.clear()},t}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var N,D=function(e){var t={exports:{}};return e(t,t.exports),t.exports}((function(e,t){!function(e){
/*! *****************************************************************************
                Copyright (c) Microsoft Corporation.
                 Permission to use, copy, modify, and/or distribute this software for any
                purpose with or without fee is hereby granted.
                 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
                REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
                AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
                INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
                LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
                OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
                PERFORMANCE OF THIS SOFTWARE.
                ***************************************************************************** */
var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,n)};function n(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}function i(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function r(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}var o,s=255,a=213;e.OPERATION=void 0,(o=e.OPERATION||(e.OPERATION={}))[o.ADD=128]="ADD",o[o.REPLACE=0]="REPLACE",o[o.DELETE=64]="DELETE",o[o.DELETE_AND_ADD=192]="DELETE_AND_ADD",o[o.TOUCH=1]="TOUCH",o[o.CLEAR=10]="CLEAR";var f=function(){function e(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return e.prototype.getNextUniqueId=function(){return this.nextUniqueId++},e.prototype.addRef=function(e,t,n){void 0===n&&(n=!0),this.refs.set(e,t),n&&(this.refCounts[e]=(this.refCounts[e]||0)+1)},e.prototype.removeRef=function(e){this.refCounts[e]=this.refCounts[e]-1,this.deletedRefs.add(e)},e.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},e.prototype.garbageCollectDeletedRefs=function(){var e=this;this.deletedRefs.forEach((function(t){if(e.refCounts[t]<=0){var n=e.refs.get(t);if(n instanceof xe)for(var i in n._definition.schema)"string"!=typeof n._definition.schema[i]&&n[i]&&n[i].$changes&&e.removeRef(n[i].$changes.refId);else{var r=n.$changes.parent._definition,o=r.schema[r.fieldsByIndex[n.$changes.parentIndex]];"function"==typeof Object.values(o)[0]&&Array.from(n.values()).forEach((function(t){return e.removeRef(t.$changes.refId)}))}e.refs.delete(t),delete e.refCounts[t]}})),this.deletedRefs.clear()},e}(),h=function(){function t(e,t,n){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=e,this.setParent(t,n)}return t.prototype.setParent=function(e,t,n){var i=this;if(this.indexes||(this.indexes=this.ref instanceof xe?this.ref._definition.indexes:{}),this.parent=e,this.parentIndex=n,t)if(this.root=t,this.ref instanceof xe){var r=this.ref._definition;for(var o in r.schema){var s=this.ref[o];if(s&&s.$changes){var a=r.indexes[o];s.$changes.setParent(this.ref,t,a)}}}else"object"==typeof this.ref&&this.ref.forEach((function(e,t){if(e instanceof xe){var n=e.$changes,r=i.ref.$changes.indexes[t];n.setParent(i.ref,i.root,r)}}))},t.prototype.operation=function(e){this.changes.set(--this.currentCustomOperation,e)},t.prototype.change=function(t,n){void 0===n&&(n=e.OPERATION.ADD);var i="number"==typeof t?t:this.indexes[t];this.assertValidIndex(i,t);var r=this.changes.get(i);r&&r.op!==e.OPERATION.DELETE&&r.op!==e.OPERATION.TOUCH||this.changes.set(i,{op:r&&r.op===e.OPERATION.DELETE?e.OPERATION.DELETE_AND_ADD:n,index:i}),this.allChanges.add(i),this.changed=!0,this.touchParents()},t.prototype.touch=function(t){var n="number"==typeof t?t:this.indexes[t];this.assertValidIndex(n,t),this.changes.has(n)||this.changes.set(n,{op:e.OPERATION.TOUCH,index:n}),this.allChanges.add(n),this.touchParents()},t.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},t.prototype.getType=function(e){if(this.ref._definition)return(t=this.ref._definition).schema[t.fieldsByIndex[e]];var t,n=(t=this.parent._definition).schema[t.fieldsByIndex[this.parentIndex]];return Object.values(n)[0]},t.prototype.getChildrenFilter=function(){var e=this.parent._definition.childFilters;return e&&e[this.parentIndex]},t.prototype.getValue=function(e){return this.ref.getByIndex(e)},t.prototype.delete=function(t){var n="number"==typeof t?t:this.indexes[t];if(void 0!==n){var i=this.getValue(n);this.changes.set(n,{op:e.OPERATION.DELETE,index:n}),this.allChanges.delete(n),delete this.caches[n],i&&i.$changes&&(i.$changes.parent=void 0),this.changed=!0,this.touchParents()}else console.warn("@colyseus/schema "+this.ref.constructor.name+": trying to delete non-existing index: "+t+" ("+n+")")},t.prototype.discard=function(t,n){var i=this;void 0===t&&(t=!1),void 0===n&&(n=!1),this.ref instanceof xe||this.changes.forEach((function(t){if(t.op===e.OPERATION.DELETE){var n=i.ref.getIndex(t.index);delete i.indexes[n]}})),this.changes.clear(),this.changed=t,n&&this.allChanges.clear(),this.currentCustomOperation=0},t.prototype.discardAll=function(){var e=this;this.changes.forEach((function(t){var n=e.getValue(t.index);n&&n.$changes&&n.$changes.discardAll()})),this.discard()},t.prototype.cache=function(e,t){this.caches[e]=t},t.prototype.clone=function(){return new t(this.ref,this.parent,this.root)},t.prototype.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},t.prototype.assertValidIndex=function(e,t){if(void 0===e)throw new Error('ChangeTree: missing index for field "'+t+'"')},t}(),c=function(e,t){var n=e.toString(),i=t.toString();return n<i?-1:n>i?1:0};function u(e){return e.$proxy=!0,e=new Proxy(e,{get:function(e,t){return"symbol"==typeof t||isNaN(t)?e[t]:e.at(t)},set:function(e,t,n){if("symbol"==typeof t||isNaN(t))e[t]=n;else{var i=Array.from(e.$items.keys()),r=parseInt(i[t]||t);null==n?e.deleteAt(r):e.setAt(r,n)}return!0},deleteProperty:function(e,t){return"number"==typeof t?e.deleteAt(t):delete e[t],!0}})}var d=function(){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.$changes=new h(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,e)}return t.is=function(e){return Array.isArray(e)},Object.defineProperty(t.prototype,"length",{get:function(){return this.$items.size},set:function(e){0===e?this.clear():this.splice(e,this.length-e)},enumerable:!1,configurable:!0}),t.prototype.push=function(){for(var e,t=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach((function(n){e=t.$refId++,t.setAt(e,n)})),e},t.prototype.pop=function(){var e=Array.from(this.$indexes.values()).pop();if(void 0!==e){this.$changes.delete(e),this.$indexes.delete(e);var t=this.$items.get(e);return this.$items.delete(e),t}},t.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},t.prototype.setAt=function(t,n){var i,r;void 0!==n.$changes&&n.$changes.setParent(this,this.$changes.root,t);var o=null!==(r=null===(i=this.$changes.indexes[t])||void 0===i?void 0:i.op)&&void 0!==r?r:e.OPERATION.ADD;this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,n),this.$changes.change(t,o)},t.prototype.deleteAt=function(e){var t=Array.from(this.$items.keys())[e];return void 0!==t&&this.$deleteAt(t)},t.prototype.$deleteAt=function(e){return this.$changes.delete(e),this.$indexes.delete(e),this.$items.delete(e)},t.prototype.clear=function(t){var n=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){n.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.concat=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return new(t.bind.apply(t,r([void 0],(e=Array.from(this.$items.values())).concat.apply(e,n))))},t.prototype.join=function(e){return Array.from(this.$items.values()).join(e)},t.prototype.reverse=function(){var e=this,t=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach((function(n,i){e.setAt(t[i],n)})),this},t.prototype.shift=function(){var e=Array.from(this.$items.keys()).shift();if(void 0!==e){var t=this.$items.get(e);return this.$deleteAt(e),t}},t.prototype.slice=function(e,n){return new(t.bind.apply(t,r([void 0],Array.from(this.$items.values()).slice(e,n))))},t.prototype.sort=function(e){var t=this;void 0===e&&(e=c);var n=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(e).forEach((function(e,i){t.setAt(n[i],e)})),this},t.prototype.splice=function(e,t){void 0===t&&(t=this.length-e);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var r=Array.from(this.$items.keys()),o=[],s=e;s<e+t;s++)o.push(this.$items.get(r[s])),this.$deleteAt(r[s]);return o},t.prototype.unshift=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=this.length,r=t.length,o=Array.from(this.$items.values());return t.forEach((function(t,n){e.setAt(n,t)})),o.forEach((function(t,n){e.setAt(r+n,t)})),i+r},t.prototype.indexOf=function(e,t){return Array.from(this.$items.values()).indexOf(e,t)},t.prototype.lastIndexOf=function(e,t){return void 0===t&&(t=this.length-1),Array.from(this.$items.values()).lastIndexOf(e,t)},t.prototype.every=function(e,t){return Array.from(this.$items.values()).every(e,t)},t.prototype.some=function(e,t){return Array.from(this.$items.values()).some(e,t)},t.prototype.forEach=function(e,t){Array.from(this.$items.values()).forEach(e,t)},t.prototype.map=function(e,t){return Array.from(this.$items.values()).map(e,t)},t.prototype.filter=function(e,t){return Array.from(this.$items.values()).filter(e,t)},t.prototype.reduce=function(e,t){return Array.from(this.$items.values()).reduce(e,t)},t.prototype.reduceRight=function(e,t){return Array.from(this.$items.values()).reduceRight(e,t)},t.prototype.find=function(e,t){return Array.from(this.$items.values()).find(e,t)},t.prototype.findIndex=function(e,t){return Array.from(this.$items.values()).findIndex(e,t)},t.prototype.fill=function(e,t,n){throw new Error("ArraySchema#fill() not implemented")},t.prototype.copyWithin=function(e,t,n){throw new Error("ArraySchema#copyWithin() not implemented")},t.prototype.toString=function(){return this.$items.toString()},t.prototype.toLocaleString=function(){return this.$items.toLocaleString()},t.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},t.prototype[Symbol.unscopables]=function(){return this.$items[Symbol.unscopables]()},t.prototype.entries=function(){return this.$items.entries()},t.prototype.keys=function(){return this.$items.keys()},t.prototype.values=function(){return this.$items.values()},t.prototype.includes=function(e,t){return Array.from(this.$items.values()).includes(e,t)},t.prototype.flatMap=function(e,t){throw new Error("ArraySchema#flatMap() is not supported.")},t.prototype.flat=function(e){throw new Error("ArraySchema#flat() is not supported.")},t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toArray=function(){return Array.from(this.$items.values())},t.prototype.toJSON=function(){return this.toArray().map((function(e){return"function"==typeof e.toJSON?e.toJSON():e}))},t.prototype.clone=function(e){return e?new(t.bind.apply(t,r([void 0],Array.from(this.$items.values())))):new(t.bind.apply(t,r([void 0],this.map((function(e){return e.$changes?e.clone():e})))))},t.prototype.triggerAll=function(){xe.prototype.triggerAll.apply(this)},t}();function p(e){return e.$proxy=!0,e=new Proxy(e,{get:function(e,t){return"symbol"!=typeof t&&void 0===e[t]?e.get(t):e[t]},set:function(e,t,n){return"symbol"!=typeof t&&-1===t.indexOf("$")&&"onAdd"!==t&&"onRemove"!==t&&"onChange"!==t?e.set(t,n):e[t]=n,!0},deleteProperty:function(e,t){return e.delete(t),!0}})}var l=function(){function t(e){var t=this;if(this.$changes=new h(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e)if(e instanceof Map)e.forEach((function(e,n){return t.set(n,e)}));else for(var n in e)this.set(n,e[n])}return t.is=function(e){return void 0!==e.map},t.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=void 0!==this.$changes.indexes[t],r=i?this.$changes.indexes[t]:this.$refId++,o=i?e.OPERATION.REPLACE:e.OPERATION.ADD,s=void 0!==n.$changes;return s&&n.$changes.setParent(this,this.$changes.root,r),i?s&&this.$items.get(t)!==n&&(o=e.OPERATION.ADD):(this.$changes.indexes[t]=r,this.$indexes.set(r,t)),this.$items.set(t,n),this.$changes.change(t,o),this},t.prototype.get=function(e){return this.$items.get(e)},t.prototype.delete=function(e){return this.$changes.delete(e),this.$items.delete(e)},t.prototype.clear=function(t){var n=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){n.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.has=function(e){return this.$items.has(e)},t.prototype.forEach=function(e){this.$items.forEach(e)},t.prototype.entries=function(){return this.$items.entries()},t.prototype.keys=function(){return this.$items.keys()},t.prototype.values=function(){return this.$items.values()},Object.defineProperty(t.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toJSON=function(){var e={};return this.forEach((function(t,n){e[n]="function"==typeof t.toJSON?t.toJSON():t})),e},t.prototype.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e,t){e.$changes?n.set(t,e.clone()):n.set(t,e)}))),n},t.prototype.triggerAll=function(){xe.prototype.triggerAll.apply(this)},t}(),v={};function y(e,t){v[e]=t}function g(e){return v[e]}var m=function(){function e(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return e.create=function(t){var n=new e;return n.schema=Object.assign({},t&&t.schema||{}),n.indexes=Object.assign({},t&&t.indexes||{}),n.fieldsByIndex=Object.assign({},t&&t.fieldsByIndex||{}),n.descriptors=Object.assign({},t&&t.descriptors||{}),n.deprecated=Object.assign({},t&&t.deprecated||{}),n},e.prototype.addField=function(e,t){var n=this.getNextFieldIndex();this.fieldsByIndex[n]=e,this.indexes[e]=n,this.schema[e]=Array.isArray(t)?{array:t[0]}:t},e.prototype.addFilter=function(e,t){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[e]]=t,this.indexesWithFilters.push(this.indexes[e]),!0},e.prototype.addChildrenFilter=function(e,t){var n=this.indexes[e],i=this.schema[e];if(g(Object.keys(i)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[n]=t,!0;console.warn("@filterChildren: field '"+e+"' can't have children. Ignoring filter.")},e.prototype.getChildrenFilter=function(e){return this.childFilters&&this.childFilters[this.indexes[e]]},e.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},e}();function _(e){return e._context&&e._context.useFilters}var w=function(){function e(){this.types={},this.schemas=new Map,this.useFilters=!1}return e.prototype.has=function(e){return this.schemas.has(e)},e.prototype.get=function(e){return this.types[e]},e.prototype.add=function(e,t){void 0===t&&(t=this.schemas.size),e._definition=m.create(e._definition),e._typeid=t,this.types[t]=e,this.schemas.set(e,t)},e.create=function(t){return void 0===t&&(t=new e),function(e){return $(e,t)}},e}(),A=new w;function $(e,t){return void 0===t&&(t=A),function(n,i){var o=n.constructor;o._context=t,t.has(o)||t.add(o);var s=o._definition;if(s.addField(i,e),s.descriptors[i]){if(s.deprecated[i])return;try{throw new Error("@colyseus/schema: Duplicate '"+i+"' definition on '"+o.name+"'.\nCheck @type() annotation")}catch(e){var a=e.stack.split("\n")[4].trim();throw new Error(e.message+" "+a)}}var f=d.is(e),h=!f&&l.is(e);if("string"!=typeof e&&!xe.is(e)){var c=Object.values(e)[0];"string"==typeof c||t.has(c)||t.add(c)}var v="_"+i;s.descriptors[v]={enumerable:!1,configurable:!1,writable:!0},s.descriptors[i]={get:function(){return this[v]},set:function(e){e!==this[v]&&(null!=e?(!f||e instanceof d||(e=new(d.bind.apply(d,r([void 0],e)))),!h||e instanceof l||(e=new l(e)),void 0===e.$proxy&&(h?e=p(e):f&&(e=u(e))),this.$changes.change(i),e.$changes&&e.$changes.setParent(this,this.$changes.root,this._definition.indexes[i])):this.$changes.delete(i),this[v]=e)},enumerable:!0,configurable:!0}}}function E(e){return function(t,n){var i=t.constructor;i._definition.addFilter(n,e)&&(i._context.useFilters=!0)}}function O(e){return function(t,n){var i=t.constructor;i._definition.addChildrenFilter(n,e)&&(i._context.useFilters=!0)}}function I(e,t){return void 0===e&&(e=!0),function(t,n){var i=t.constructor._definition;i.deprecated[n]=!0,e&&(i.descriptors[n]={get:function(){throw new Error(n+" is deprecated.")},set:function(e){},enumerable:!1,configurable:!0})}}function b(e,t,n){for(var i in void 0===n&&(n=e._context||A),t)$(t[i],n)(e.prototype,i);return e}function x(e){for(var t=0,n=0,i=0,r=e.length;i<r;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}function R(e,t,n){for(var i=0,r=0,o=n.length;r<o;r++)(i=n.charCodeAt(r))<128?e[t++]=i:i<2048?(e[t++]=192|i>>6,e[t++]=128|63&i):i<55296||i>=57344?(e[t++]=224|i>>12,e[t++]=128|i>>6&63,e[t++]=128|63&i):(r++,i=65536+((1023&i)<<10|1023&n.charCodeAt(r)),e[t++]=240|i>>18,e[t++]=128|i>>12&63,e[t++]=128|i>>6&63,e[t++]=128|63&i)}function T(e,t){e.push(255&t)}function C(e,t){e.push(255&t)}function P(e,t){e.push(255&t),e.push(t>>8&255)}function S(e,t){e.push(255&t),e.push(t>>8&255)}function N(e,t){e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255)}function D(e,t){var n=t>>24,i=t>>16,r=t>>8,o=t;e.push(255&o),e.push(255&r),e.push(255&i),e.push(255&n)}function M(e,t){var n=Math.floor(t/Math.pow(2,32));D(e,t>>>0),D(e,n)}function k(e,t){var n=t/Math.pow(2,32)>>0;D(e,t>>>0),D(e,n)}function j(e,t){B(e,t)}function U(e,t){V(e,t)}var L=new Int32Array(2),F=new Float32Array(L.buffer),H=new Float64Array(L.buffer);function B(e,t){F[0]=t,N(e,L[0])}function V(e,t){H[0]=t,N(e,L[0]),N(e,L[1])}function z(e,t){return C(e,t?1:0)}function q(e,t){t||(t="");var n=x(t),i=0;if(n<32)e.push(160|n),i=1;else if(n<256)e.push(217),C(e,n),i=2;else if(n<65536)e.push(218),S(e,n),i=3;else{if(!(n<4294967296))throw new Error("String too long");e.push(219),D(e,n),i=5}return R(e,e.length,t),i+n}function J(e,t){return isNaN(t)?J(e,0):isFinite(t)?t!==(0|t)?(e.push(203),V(e,t),9):t>=0?t<128?(C(e,t),1):t<256?(e.push(204),C(e,t),2):t<65536?(e.push(205),S(e,t),3):t<4294967296?(e.push(206),D(e,t),5):(e.push(207),k(e,t),9):t>=-32?(e.push(224|t+32),1):t>=-128?(e.push(208),T(e,t),2):t>=-32768?(e.push(209),P(e,t),3):t>=-2147483648?(e.push(210),N(e,t),5):(e.push(211),M(e,t),9):J(e,t>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var K=Object.freeze({__proto__:null,utf8Write:R,int8:T,uint8:C,int16:P,uint16:S,int32:N,uint32:D,int64:M,uint64:k,float32:j,float64:U,writeFloat32:B,writeFloat64:V,boolean:z,string:q,number:J});function W(e,t,n){for(var i="",r=0,o=t,s=t+n;o<s;o++){var a=e[o];0!=(128&a)?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(r=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(r-=65536,i+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):i+=String.fromCharCode(r):i+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0):i+=String.fromCharCode((31&a)<<6|63&e[++o]):i+=String.fromCharCode(a)}return i}function X(e,t){return G(e,t)<<24>>24}function G(e,t){return e[t.offset++]}function Q(e,t){return Y(e,t)<<16>>16}function Y(e,t){return e[t.offset++]|e[t.offset++]<<8}function Z(e,t){return e[t.offset++]|e[t.offset++]<<8|e[t.offset++]<<16|e[t.offset++]<<24}function ee(e,t){return Z(e,t)>>>0}function te(e,t){return fe(e,t)}function ne(e,t){return he(e,t)}function ie(e,t){var n=ee(e,t);return Z(e,t)*Math.pow(2,32)+n}function re(e,t){var n=ee(e,t);return ee(e,t)*Math.pow(2,32)+n}var oe=new Int32Array(2),se=new Float32Array(oe.buffer),ae=new Float64Array(oe.buffer);function fe(e,t){return oe[0]=Z(e,t),se[0]}function he(e,t){return oe[0]=Z(e,t),oe[1]=Z(e,t),ae[0]}function ce(e,t){return G(e,t)>0}function ue(e,t){var n,i=e[t.offset++];i<192?n=31&i:217===i?n=G(e,t):218===i?n=Y(e,t):219===i&&(n=ee(e,t));var r=W(e,t.offset,n);return t.offset+=n,r}function de(e,t){var n=e[t.offset];return n<192&&n>160||217===n||218===n||219===n}function pe(e,t){var n=e[t.offset++];return n<128?n:202===n?fe(e,t):203===n?he(e,t):204===n?G(e,t):205===n?Y(e,t):206===n?ee(e,t):207===n?re(e,t):208===n?X(e,t):209===n?Q(e,t):210===n?Z(e,t):211===n?ie(e,t):n>223?-1*(255-n+1):void 0}function le(e,t){var n=e[t.offset];return n<128||n>=202&&n<=211}function ve(e,t){return e[t.offset]<160}function ye(e,t){return e[t.offset-1]===s&&(e[t.offset]<128||e[t.offset]>=202&&e[t.offset]<=211)}var ge=Object.freeze({__proto__:null,int8:X,uint8:G,int16:Q,uint16:Y,int32:Z,uint32:ee,float32:te,float64:ne,int64:ie,uint64:re,readFloat32:fe,readFloat64:he,boolean:ce,string:ue,stringCheck:de,number:pe,numberCheck:le,arrayCheck:ve,switchStructureCheck:ye}),me=function(){function t(e){var t=this;this.$changes=new h(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return t.is=function(e){return void 0!==e.collection},t.prototype.add=function(e){var t=this.$refId++;return void 0!==e.$changes&&e.$changes.setParent(this,this.$changes.root,t),this.$changes.indexes[t]=t,this.$indexes.set(t,t),this.$items.set(t,e),this.$changes.change(t),t},t.prototype.at=function(e){var t=Array.from(this.$items.keys())[e];return this.$items.get(t)},t.prototype.entries=function(){return this.$items.entries()},t.prototype.delete=function(e){for(var t,n,i=this.$items.entries();(n=i.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},t.prototype.clear=function(t){var n=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){n.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.has=function(e){return Array.from(this.$items.values()).some((function(t){return t===e}))},t.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,i,r){return e(n,i,t)}))},t.prototype.values=function(){return this.$items.values()},Object.defineProperty(t.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toArray=function(){return Array.from(this.$items.values())},t.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},t.prototype.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e){e.$changes?n.add(e.clone()):n.add(e)}))),n},t.prototype.triggerAll=function(){xe.prototype.triggerAll.apply(this)},t}(),_e=function(){function t(e){var t=this;this.$changes=new h(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,e&&e.forEach((function(e){return t.add(e)}))}return t.is=function(e){return void 0!==e.set},t.prototype.add=function(t){var n,i;if(this.has(t))return!1;var r=this.$refId++;void 0!==t.$changes&&t.$changes.setParent(this,this.$changes.root,r);var o=null!==(i=null===(n=this.$changes.indexes[r])||void 0===n?void 0:n.op)&&void 0!==i?i:e.OPERATION.ADD;return this.$changes.indexes[r]=r,this.$indexes.set(r,r),this.$items.set(r,t),this.$changes.change(r,o),r},t.prototype.entries=function(){return this.$items.entries()},t.prototype.delete=function(e){for(var t,n,i=this.$items.entries();(n=i.next())&&!n.done;)if(e===n.value[1]){t=n.value[0];break}return void 0!==t&&(this.$changes.delete(t),this.$indexes.delete(t),this.$items.delete(t))},t.prototype.clear=function(t){var n=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),t&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(e){n.$changes.root.removeRef(e.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:e.OPERATION.CLEAR}),this.$changes.touchParents()},t.prototype.has=function(e){for(var t,n=this.$items.values(),i=!1;(t=n.next())&&!t.done;)if(e===t.value){i=!0;break}return i},t.prototype.forEach=function(e){var t=this;this.$items.forEach((function(n,i,r){return e(n,i,t)}))},t.prototype.values=function(){return this.$items.values()},Object.defineProperty(t.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),t.prototype.setIndex=function(e,t){this.$indexes.set(e,t)},t.prototype.getIndex=function(e){return this.$indexes.get(e)},t.prototype.getByIndex=function(e){return this.$items.get(this.$indexes.get(e))},t.prototype.deleteByIndex=function(e){var t=this.$indexes.get(e);this.$items.delete(t),this.$indexes.delete(e)},t.prototype.toArray=function(){return Array.from(this.$items.values())},t.prototype.toJSON=function(){var e=[];return this.forEach((function(t,n){e.push("function"==typeof t.toJSON?t.toJSON():t)})),e},t.prototype.clone=function(e){var n;return e?n=Object.assign(new t,this):(n=new t,this.forEach((function(e){e.$changes?n.add(e.clone()):n.add(e)}))),n},t.prototype.triggerAll=function(){xe.prototype.triggerAll.apply(this)},t}(),we=function(){function e(){this.handlers=[]}return e.prototype.register=function(e,t){return this.handlers.push(e),this},e.prototype.invoke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.handlers.forEach((function(t){return t.apply(void 0,e)}))},e.prototype.invokeAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.handlers.map((function(t){return t.apply(void 0,e)})))},e.prototype.remove=function(e){var t=this.handlers.indexOf(e);this.handlers[t]=this.handlers[this.handlers.length-1],this.handlers.pop()},e.prototype.clear=function(){this.handlers=[]},e}(),Ae=function(){function e(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return e.prototype.addRefId=function(e){this.refIds.has(e)||(this.refIds.add(e),this.containerIndexes.set(e,new Set))},e.get=function(t){return void 0===t.$filterState&&(t.$filterState=new e),t.$filterState},e}(),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(Error);function Ee(e,t,n,i){var r,o=!1;switch(t){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":r="number",isNaN(e)&&console.log('trying to encode "NaN" in '+n.constructor.name+"#"+i);break;case"string":r="string",o=!0;break;case"boolean":return}if(typeof e!==r&&(!o||o&&null!==e)){var s="'"+JSON.stringify(e)+"'"+(e&&e.constructor&&" ("+e.constructor.name+")"||"");throw new $e("a '"+r+"' was expected, but "+s+" was provided in "+n.constructor.name+"#"+i)}}function Oe(e,t,n,i){if(!(e instanceof t))throw new $e("a '"+t.name+"' was expected, but '"+e.constructor.name+"' was provided in "+n.constructor.name+"#"+i)}function Ie(e,t,n,i,r){Ee(n,e,i,r);var o=K[e];if(!o)throw new $e("a '"+e+"' was expected, but "+n+" was provided in "+i.constructor.name+"#"+r);o(t,n)}function be(e,t,n){return ge[e](t,n)}var xe=function(){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Object.defineProperties(this,{$changes:{value:new h(this,void 0,new f),enumerable:!1,writable:!0},$listeners:{value:{},enumerable:!1,writable:!0}});var n=this._definition.descriptors;n&&Object.defineProperties(this,n),e[0]&&this.assign(e[0])}return t.onError=function(e){console.error(e)},t.is=function(e){return e._definition&&void 0!==e._definition.schema},t.prototype.assign=function(e){return Object.assign(this,e),this},Object.defineProperty(t.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),t.prototype.listen=function(e,t){var n=this;return this.$listeners[e]||(this.$listeners[e]=new we),this.$listeners[e].register(t),function(){return n.$listeners[e].remove(t)}},t.prototype.decode=function(n,i,r,o){void 0===i&&(i={offset:0}),void 0===r&&(r=this),void 0===o&&(o=new Map);var a=this.$changes.root,f=n.length,h=0,c=[];for(a.refs.set(h,this),o.set(h,c);i.offset<f;){var u=n[i.offset++];if(u!=s){var p=r.$changes,v=void 0!==r._definition,y=v?u>>6<<6:u;if(y!==e.OPERATION.CLEAR){var m=v?u%(y||255):pe(n,i),_=v?r._definition.fieldsByIndex[m]:"",w=p.getType(m),A=void 0,$=void 0,E=void 0;if(v?$=r["_"+_]:($=r.getByIndex(m),(y&e.OPERATION.ADD)===e.OPERATION.ADD?(E=r instanceof l?ue(n,i):m,r.setIndex(m,E)):E=r.getIndex(m)),(y&e.OPERATION.DELETE)===e.OPERATION.DELETE&&(y!==e.OPERATION.DELETE_AND_ADD&&r.deleteByIndex(m),$&&$.$changes&&a.removeRef($.$changes.refId),A=null),void 0!==_){if(y===e.OPERATION.DELETE);else if(t.is(w)){var O=pe(n,i);if(A=a.refs.get(O),y!==e.OPERATION.REPLACE){var I=this.getSchemaType(n,i,w);A||((A=this.createTypeInstance(I)).$changes.refId=O,$&&(A.onChange=$.onChange,A.onRemove=$.onRemove,A.$listeners=$.$listeners,$.$changes.refId&&O!==$.$changes.refId&&a.removeRef($.$changes.refId))),a.addRef(O,A,A!==$)}}else if("string"==typeof w)A=be(w,n,i);else{var b=g(Object.keys(w)[0]),x=pe(n,i),R=a.refs.has(x)?$||a.refs.get(x):new b.constructor;if((A=R.clone(!0)).$changes.refId=x,$&&(A.onAdd=$.onAdd,A.onRemove=$.onRemove,A.onChange=$.onChange,$.$changes.refId&&x!==$.$changes.refId)){a.removeRef($.$changes.refId);for(var T=[],C=$.entries(),P=void 0;(P=C.next())&&!P.done;){var S=P.value,N=S[0],D=S[1];T.push({op:e.OPERATION.DELETE,field:N,value:void 0,previousValue:D})}o.set($.$changes.refId,T)}a.addRef(x,A,R!==$),b.getProxy&&(A=b.getProxy(A))}var M=$!==A;if(null!=A)if(A.$changes&&A.$changes.setParent(p.ref,p.root,m),r instanceof t)r[_]=A;else if(r instanceof l)N=E,r.$items.set(N,A);else if(r instanceof d)r.setAt(m,A);else if(r instanceof me){var k=r.add(A);r.setIndex(m,k)}else r instanceof _e&&!1!==(k=r.add(A))&&r.setIndex(m,k);M&&c.push({op:y,field:_,dynamicIndex:E,value:A,previousValue:$})}else{console.warn("@colyseus/schema: definition mismatch");for(var j={offset:i.offset};i.offset<f&&(!ye(n,i)||(j.offset=i.offset+1,!a.refs.has(pe(n,j))));)i.offset++}}else r.clear(!0)}else{h=pe(n,i);var U=a.refs.get(h);if(!U)throw new Error('"refId" not found: '+h);r=U,c=[],o.set(h,c)}}return this._triggerChanges(o),a.garbageCollectDeletedRefs(),o},t.prototype.encode=function(n,i,r){void 0===n&&(n=!1),void 0===i&&(i=[]),void 0===r&&(r=!1);for(var o=this.$changes,a=new WeakSet,f=[o],h=1,c=0;c<h;c++){var u=f[c],d=u.ref,p=d instanceof t;u.ensureRefId(),a.add(u),u!==o&&(u.changed||n)&&(C(i,s),J(i,u.refId));for(var v=n?Array.from(u.allChanges):Array.from(u.changes.values()),y=0,m=v.length;y<m;y++){var _=n?{op:e.OPERATION.ADD,index:v[y]}:v[y],w=_.index,A=p?d._definition.fieldsByIndex&&d._definition.fieldsByIndex[w]:w,$=i.length;if(_.op!==e.OPERATION.TOUCH)if(p)C(i,w|_.op);else{if(C(i,_.op),_.op===e.OPERATION.CLEAR)continue;J(i,w)}if(p||(_.op&e.OPERATION.ADD)!=e.OPERATION.ADD||d instanceof l&&q(i,u.ref.$indexes.get(w)),_.op!==e.OPERATION.DELETE){var E=u.getType(w),O=u.getValue(w);if(O&&O.$changes&&!a.has(O.$changes)&&(f.push(O.$changes),O.$changes.ensureRefId(),h++),_.op!==e.OPERATION.TOUCH){if(t.is(E))Oe(O,E,d,A),J(i,O.$changes.refId),(_.op&e.OPERATION.ADD)===e.OPERATION.ADD&&this.tryEncodeTypeId(i,E,O.constructor);else if("string"==typeof E)Ie(E,i,O,d,A);else{var I=g(Object.keys(E)[0]);Oe(d["_"+A],I.constructor,d,A),J(i,O.$changes.refId)}r&&u.cache(w,i.slice($))}}}n||r||u.discard()}return i},t.prototype.encodeAll=function(e){return this.encode(!0,[],e)},t.prototype.applyFilters=function(n,i){void 0===i&&(i=!1);for(var r=this,o=new Set,a=Ae.get(n),f=[this.$changes],h=1,c=[],u=function(u){var d=f[u];if(o.has(d.refId))return"continue";var p=d.ref,v=p instanceof t;C(c,s),J(c,d.refId);var y=a.refIds.has(d),g=i||!y;a.addRefId(d);var m=a.containerIndexes.get(d),_=g?Array.from(d.allChanges):Array.from(d.changes.values());!i&&v&&p._definition.indexesWithFilters&&p._definition.indexesWithFilters.forEach((function(t){!m.has(t)&&d.allChanges.has(t)&&(g?_.push(t):_.push({op:e.OPERATION.ADD,index:t}))}));for(var w=0,A=_.length;w<A;w++){var $=g?{op:e.OPERATION.ADD,index:_[w]}:_[w];if($.op!==e.OPERATION.CLEAR){var E=$.index;if($.op!==e.OPERATION.DELETE){var O=d.getValue(E),I=d.getType(E);if(v){if((b=p._definition.filters&&p._definition.filters[E])&&!b.call(p,n,O,r)){O&&O.$changes&&o.add(O.$changes.refId);continue}}else{var b,x=d.parent;if((b=d.getChildrenFilter())&&!b.call(x,n,p.$indexes.get(E),O,r)){O&&O.$changes&&o.add(O.$changes.refId);continue}}if(O.$changes&&(f.push(O.$changes),h++),$.op!==e.OPERATION.TOUCH)if($.op===e.OPERATION.ADD||v)c=c.concat(d.caches[E]),m.add(E);else if(m.has(E))c=c.concat(d.caches[E]);else{if(m.add(E),C(c,e.OPERATION.ADD),J(c,E),p instanceof l){var R=d.ref.$indexes.get(E);q(c,R)}O.$changes?J(c,O.$changes.refId):K[I](c,O)}else O.$changes&&!v&&(C(c,e.OPERATION.ADD),J(c,E),p instanceof l&&(R=d.ref.$indexes.get(E),q(c,R)),J(c,O.$changes.refId))}else v?C(c,$.op|E):(C(c,$.op),J(c,E))}else C(c,$.op)}},d=0;d<h;d++)u(d);return c},t.prototype.clone=function(){var e=new this.constructor,t=this._definition.schema;for(var n in t)"object"==typeof this[n]&&"function"==typeof this[n].clone?e[n]=this[n].clone():e[n]=this[n];return e},t.prototype.triggerAll=function(){if(0!==this.$changes.root.refs.size){var e=new Map;t.prototype._triggerAllFillChanges.call(this,this,e);try{t.prototype._triggerChanges.call(this,e)}catch(e){t.onError(e)}}},t.prototype.toJSON=function(){var e=this._definition.schema,t=this._definition.deprecated,n={};for(var i in e)t[i]||null===this[i]||void 0===this[i]||(n[i]="function"==typeof this[i].toJSON?this[i].toJSON():this["_"+i]);return n},t.prototype.discardAllChanges=function(){this.$changes.discardAll()},t.prototype.getByIndex=function(e){return this[this._definition.fieldsByIndex[e]]},t.prototype.deleteByIndex=function(e){this[this._definition.fieldsByIndex[e]]=void 0},t.prototype.tryEncodeTypeId=function(e,t,n){t._typeid!==n._typeid&&(C(e,a),J(e,n._typeid))},t.prototype.getSchemaType=function(e,t,n){var i;return e[t.offset]===a&&(t.offset++,i=this.constructor._context.get(pe(e,t))),i||n},t.prototype.createTypeInstance=function(e){var t=new e;return t.$changes.root=this.$changes.root,t},t.prototype._triggerAllFillChanges=function(n,i){if(!i.has(n.$changes.refId)){var r=[];if(i.set(n.$changes.refId||0,r),n instanceof t){var o=n._definition.schema;for(var s in o)void 0!==(u=n["_"+s])&&(r.push({op:e.OPERATION.ADD,field:s,value:u,previousValue:void 0}),void 0!==u.$changes&&t.prototype._triggerAllFillChanges.call(this,u,i))}else for(var a=n.entries(),f=void 0;(f=a.next())&&!f.done;){var h=f.value,c=h[0],u=h[1];r.push({op:e.OPERATION.ADD,field:c,dynamicIndex:c,value:u,previousValue:void 0}),void 0!==u.$changes&&t.prototype._triggerAllFillChanges.call(this,u,i)}}},t.prototype._triggerChanges=function(n){var i=this;n.forEach((function(n,r){var o,s,a,f,h,c,u,d,p,l,v,y;if(n.length>0){for(var g=i.$changes.root.refs.get(r),m=g instanceof t,_=0;_<n.length;_++){var w=n[_],A=g.$listeners&&g.$listeners[w.field];if(m||(w.op===e.OPERATION.ADD&&void 0===w.previousValue?null===(s=(o=g).onAdd)||void 0===s||s.call(o,w.value,null!==(a=w.dynamicIndex)&&void 0!==a?a:w.field):w.op===e.OPERATION.DELETE?void 0!==w.previousValue&&(null===(h=(f=g).onRemove)||void 0===h||h.call(f,w.previousValue,null!==(c=w.dynamicIndex)&&void 0!==c?c:w.field)):w.op===e.OPERATION.DELETE_AND_ADD?(void 0!==w.previousValue&&(null===(d=(u=g).onRemove)||void 0===d||d.call(u,w.previousValue,w.dynamicIndex)),null===(l=(p=g).onAdd)||void 0===l||l.call(p,w.value,w.dynamicIndex)):w.op!==e.OPERATION.REPLACE&&w.value===w.previousValue||null===(y=(v=g).onChange)||void 0===y||y.call(v,w.value,w.dynamicIndex)),(w.op&e.OPERATION.DELETE)===e.OPERATION.DELETE&&w.previousValue instanceof t&&w.previousValue.onRemove&&w.previousValue.onRemove(),A)try{A.invoke(w.value,w.previousValue)}catch(e){t.onError(e)}}if(m&&g.onChange)try{g.onChange(n)}catch(e){t.onError(e)}}}))},t._definition=m.create(),t}();function Re(e){for(var t=[e.$changes],n=1,i={},r=i,o=function(e){var n=t[e];n.changes.forEach((function(e){var t=n.ref,i=e.index,o=t._definition?t._definition.fieldsByIndex[i]:t.$indexes.get(i);r[o]=n.getValue(i)}))},s=0;s<n;s++)o(s);return i}var Te=new w,Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),i([$("string",Te)],t.prototype,"name",void 0),i([$("string",Te)],t.prototype,"type",void 0),i([$("number",Te)],t.prototype,"referencedType",void 0),t}(xe),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fields=new d,t}return n(t,e),i([$("number",Te)],t.prototype,"id",void 0),i([$([Ce],Te)],t.prototype,"fields",void 0),t}(xe),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.types=new d,t}return n(t,e),t.encode=function(e){var n=e.constructor,i=new t;i.rootType=n._typeid;var r=function(e,t){for(var n in t){var r=new Ce;r.name=n;var o=void 0;if("string"==typeof t[n])o=t[n];else{var s=t[n],a=void 0;xe.is(s)?(o="ref",a=t[n]):"string"==typeof s[o=Object.keys(s)[0]]?o+=":"+s[o]:a=s[o],r.referencedType=a?a._typeid:-1}r.type=o,e.fields.push(r)}i.types.push(e)},o=n._context.types;for(var s in o){var a=new Pe;a.id=Number(s),r(a,o[s]._definition.schema)}return i.encodeAll()},t.decode=function(e,i){var r=new w,o=new t;o.decode(e,i);var s=o.types.reduce((function(e,t){var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(xe),o=t.id;return e[o]=i,r.add(i,o),e}),{});o.types.forEach((function(e){var t=s[e.id];e.fields.forEach((function(e){var n;if(void 0!==e.referencedType){var i=e.type,o=s[e.referencedType];if(!o){var a=e.type.split(":");i=a[0],o=a[1]}"ref"===i?$(o,r)(t.prototype,e.name):$(((n={})[i]=o,n),r)(t.prototype,e.name)}else $(e.type,r)(t.prototype,e.name)}))}));var a=s[o.rootType],f=new a;for(var h in a._definition.schema){var c=a._definition.schema[h];"string"!=typeof c&&(f[h]="function"==typeof c?new c:new(g(Object.keys(c)[0]).constructor))}return f},i([$([Pe],Te)],t.prototype,"types",void 0),i([$("number",Te)],t.prototype,"rootType",void 0),t}(xe);y("map",{constructor:l,getProxy:p}),y("array",{constructor:d,getProxy:u}),y("set",{constructor:_e}),y("collection",{constructor:me}),e.ArraySchema=d,e.CollectionSchema=me,e.Context=w,e.MapSchema=l,e.Reflection=Se,e.ReflectionField=Ce,e.ReflectionType=Pe,e.Schema=xe,e.SchemaDefinition=m,e.SetSchema=_e,e.decode=ge,e.defineTypes=b,e.deprecated=I,e.dumpChanges=Re,e.encode=K,e.filter=E,e.filterChildren=O,e.hasFilter=_,e.registerType=y,e.type=$,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),M=function(){function t(e,t){var n=this;this.onStateChange=S(),this.onError=S(),this.onLeave=S(),this.onJoin=S(),this.hasJoined=!1,this.onMessageHandlers={events:{},emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];(this.events[e]||[]).forEach((function(e){return e.apply(void 0,n)}))},on:function(e,t){var n=this;return(this.events[e]=this.events[e]||[]).push(t),function(){return n.events[e]=(n.events[e]||[]).filter((function(e){return e!==t}))}}},this.id=null,this.name=e,t&&(this.serializer=new(C("schema")),this.rootSchema=t,this.serializer.state=new t),this.onError((function(e,t){return console.warn("colyseus.js - onError => ("+e+") "+t)})),this.onLeave((function(){return n.removeAllListeners()}))}return t.prototype.connect=function(e){var t=this;this.connection=new x,this.connection.events.onmessage=this.onMessageCallback.bind(this),this.connection.events.onclose=function(e){if(!t.hasJoined)return console.warn("Room connection was closed unexpectedly ("+e.code+"): "+e.reason),void t.onError.invoke(e.code,e.reason);t.onLeave.invoke(e.code),t.destroy()},this.connection.events.onerror=function(e){console.warn("Room, onError ("+e.code+"): "+e.reason),t.onError.invoke(e.code,e.reason)},this.connection.connect(e)},t.prototype.leave=function(t){void 0===t&&(t=!0),this.connection?t?this.connection.send([e.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(4e3)},t.prototype.onMessage=function(e,t){return this.onMessageHandlers.on(this.getMessageHandlerKey(e),t)},t.prototype.send=function(t,n){var i,r=[e.Protocol.ROOM_DATA];if("string"==typeof t?D.encode.string(r,t):D.encode.number(r,t),void 0!==n){var o=$(n);(i=new Uint8Array(r.length+o.byteLength)).set(new Uint8Array(r),0),i.set(new Uint8Array(o),r.length)}else i=new Uint8Array(r);this.connection.send(i.buffer)},Object.defineProperty(t.prototype,"state",{get:function(){return this.serializer.getState()},enumerable:!1,configurable:!0}),t.prototype.removeAllListeners=function(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}},t.prototype.onMessageCallback=function(t){var n=Array.from(new Uint8Array(t.data)),i=n[0];if(i===e.Protocol.JOIN_ROOM){var r=1;if(this.serializerId=function(e,t){for(var n=e[t++],i="",r=0,o=t,s=t+n;o<s;o++){var a=e[o];if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(r=(7&a)<<18|(63&e[++o])<<12|(63&e[++o])<<6|(63&e[++o])<<0)>=65536?(r-=65536,i+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):i+=String.fromCharCode(r)}else i+=String.fromCharCode((15&a)<<12|(63&e[++o])<<6|(63&e[++o])<<0);else i+=String.fromCharCode((31&a)<<6|63&e[++o]);else i+=String.fromCharCode(a)}return i}(n,r),r+=function(e){void 0===e&&(e="");for(var t=0,n=0,i=0,r=e.length;i<r;i++)(t=e.charCodeAt(i))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n+1}(this.serializerId),!this.serializer){var o=C(this.serializerId);this.serializer=new o}n.length>r&&this.serializer.handshake&&this.serializer.handshake(n,{offset:r}),this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([e.Protocol.JOIN_ROOM])}else if(i===e.Protocol.ERROR){var s={offset:1},a=D.decode.number(n,s),f=D.decode.string(n,s);this.onError.invoke(a,f)}else if(i===e.Protocol.LEAVE_ROOM)this.leave();else if(i===e.Protocol.ROOM_DATA_SCHEMA){var h={offset:1};(f=new(u=this.serializer.getState().constructor._context.get(D.decode.number(n,h)))).decode(n,h),this.dispatchMessage(u,f)}else if(i===e.Protocol.ROOM_STATE)n.shift(),this.setState(n);else if(i===e.Protocol.ROOM_STATE_PATCH)n.shift(),this.patch(n);else if(i===e.Protocol.ROOM_DATA){var c={offset:1},u=D.decode.stringCheck(n,c)?D.decode.string(n,c):D.decode.number(n,c);f=n.length>c.offset?function(e,t){void 0===t&&(t=0);var n=new _(e,t),i=n._parse();if(n._offset!==e.byteLength)throw new Error(e.byteLength-n._offset+" trailing bytes");return i}(t.data,c.offset):void 0;this.dispatchMessage(u,f)}},t.prototype.setState=function(e){this.serializer.setState(e),this.onStateChange.invoke(this.serializer.getState())},t.prototype.patch=function(e){this.serializer.patch(e),this.onStateChange.invoke(this.serializer.getState())},t.prototype.dispatchMessage=function(e,t){var n=this.getMessageHandlerKey(e);this.onMessageHandlers.events[n]?this.onMessageHandlers.emit(n,t):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",e,t):console.warn("onMessage not registered for type '"+e+"'.")},t.prototype.destroy=function(){this.serializer&&this.serializer.teardown()},t.prototype.getMessageHandlerKey=function(e){switch(typeof e){case"function":return"$"+e._typeid;case"string":return e;case"number":return"i"+e;default:throw new Error("invalid message type.")}},t}();function k(){return N||(N="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:{cache:{},setItem:function(e,t){this.cache[e]=t},getItem:function(e){this.cache[e]},removeItem:function(e){delete this.cache[e]}}),N}var j,U="colyseus-auth-token";e.Platform=void 0,(j=e.Platform||(e.Platform={})).ios="ios",j.android="android";var L,F=function(){function e(e){var t,n,i,r=this;this._id=void 0,this.username=void 0,this.displayName=void 0,this.avatarUrl=void 0,this.isAnonymous=void 0,this.email=void 0,this.lang=void 0,this.location=void 0,this.timezone=void 0,this.metadata=void 0,this.devices=void 0,this.facebookId=void 0,this.twitterId=void 0,this.googleId=void 0,this.gameCenterId=void 0,this.steamId=void 0,this.friendIds=void 0,this.blockedUserIds=void 0,this.createdAt=void 0,this.updatedAt=void 0,this.token=void 0,this.endpoint=e.replace("ws","http"),t=U,n=function(e){return r.token=e},i=k().getItem(t),"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return n(e)})):n(i)}return Object.defineProperty(e.prototype,"hasToken",{get:function(){return!!this.token},enumerable:!1,configurable:!0}),e.prototype.login=function(e){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,n,i;return r(this,(function(r){switch(r.label){case 0:return t=Object.assign({},e),this.hasToken&&(t.token=this.token),[4,this.request("post","/auth",t)];case 1:for(i in n=r.sent(),this.token=n.token,o=U,s=this.token,k().setItem(o,s),n)this.hasOwnProperty(i)&&(this[i]=n[i]);return this.registerPingService(),[2,this]}var o,s}))}))},e.prototype.save=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.request("put","/auth",{},{username:this.username,displayName:this.displayName,avatarUrl:this.avatarUrl,lang:this.lang,location:this.location,timezone:this.timezone})];case 1:return e.sent(),[2,this]}}))}))},e.prototype.getFriends=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/all")];case 1:return[2,e.sent()]}}))}))},e.prototype.getOnlineFriends=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/online")];case 1:return[2,e.sent()]}}))}))},e.prototype.getFriendRequests=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,this.request("get","/friends/requests")];case 1:return[2,e.sent()]}}))}))},e.prototype.sendFriendRequest=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.request("post","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.acceptFriendRequest=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.request("put","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.declineFriendRequest=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.request("del","/friends/requests",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.blockUser=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.request("post","/friends/block",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.unblockUser=function(e){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.request("put","/friends/block",{userId:e})];case 1:return[2,t.sent()]}}))}))},e.prototype.request=function(e,t,n,o,s){return void 0===n&&(n={}),void 0===s&&(s={}),i(this,void 0,void 0,(function(){var i,a,f,h;return r(this,(function(r){switch(r.label){case 0:for(a in s.Accept="application/json",this.hasToken&&(s.Authorization="Bearer "+this.token),i=[],n)i.push(a+"="+n[a]);return f=i.length>0?"?"+i.join("&"):"",h={headers:s},o&&(h.body=o),[4,g[e](""+this.endpoint+t+f,h)];case 1:return[2,r.sent().data]}}))}))},e.prototype.logout=function(){var e;this.token=void 0,e=U,k().removeItem(e),this.unregisterPingService()},e.prototype.registerPingService=function(e){var t=this;void 0===e&&(e=15e3),this.unregisterPingService(),this.keepOnlineInterval=setInterval((function(){return t.request("get","/auth")}),e)},e.prototype.unregisterPingService=function(){clearInterval(this.keepOnlineInterval)},e}(),H=function(e){function t(n,i){var r=e.call(this,n)||this;return r.code=i,Object.setPrototypeOf(r,t.prototype),r}return n(t,e),t}(Error),B="undefined"!=typeof window&&void 0!==(null===(L=null===window||void 0===window?void 0:window.location)||void 0===L?void 0:L.hostname)?window.location.protocol.replace("http","ws")+"//"+window.location.hostname+(window.location.port&&":"+window.location.port):"ws://127.0.0.1:2567",V=function(){function e(e){void 0===e&&(e=B),this.endpoint=e}return Object.defineProperty(e.prototype,"auth",{get:function(){return this._auth||(this._auth=new F(this.endpoint)),this._auth},enumerable:!1,configurable:!0}),e.prototype.joinOrCreate=function(e,t,n){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.createMatchMakeRequest("joinOrCreate",e,t,n)];case 1:return[2,i.sent()]}}))}))},e.prototype.create=function(e,t,n){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.createMatchMakeRequest("create",e,t,n)];case 1:return[2,i.sent()]}}))}))},e.prototype.join=function(e,t,n){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.createMatchMakeRequest("join",e,t,n)];case 1:return[2,i.sent()]}}))}))},e.prototype.joinById=function(e,t,n){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.createMatchMakeRequest("joinById",e,t,n)];case 1:return[2,i.sent()]}}))}))},e.prototype.reconnect=function(e,t,n){return i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,this.createMatchMakeRequest("joinById",e,{sessionId:t},n)];case 1:return[2,i.sent()]}}))}))},e.prototype.getAvailableRooms=function(e){return void 0===e&&(e=""),i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return t=this.endpoint.replace("ws","http")+"/matchmake/"+e,[4,u(t,{headers:{Accept:"application/json"}})];case 1:return[2,n.sent().data]}}))}))},e.prototype.consumeSeatReservation=function(e,t){return i(this,void 0,void 0,(function(){var n;return r(this,(function(i){return(n=this.createRoom(e.room.name,t)).id=e.room.roomId,n.sessionId=e.sessionId,n.connect(this.buildEndpoint(e.room,{sessionId:n.sessionId})),[2,new Promise((function(e,t){var i=function(e,n){return t(new m(e,n))};n.onError.once(i),n.onJoin.once((function(){n.onError.remove(i),e(n)}))}))]}))}))},e.prototype.createMatchMakeRequest=function(e,t,n,o){return void 0===n&&(n={}),i(this,void 0,void 0,(function(){var i,s;return r(this,(function(r){switch(r.label){case 0:return i=this.endpoint.replace("ws","http")+"/matchmake/"+e+"/"+t,this._auth&&this._auth.hasToken&&(n.token=this._auth.token),[4,p(i,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})];case 1:if((s=r.sent().data).error)throw new H(s.error,s.code);return[2,this.consumeSeatReservation(s,o)]}}))}))},e.prototype.createRoom=function(e,t){return new M(e,t)},e.prototype.buildEndpoint=function(e,t){void 0===t&&(t={});var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i+"="+t[i]);return this.endpoint+"/"+e.processId+"/"+e.roomId+"?"+n.join("&")},e}(),z=function(){function e(){}return e.prototype.setState=function(e){this.state.decode(e)},e.prototype.getState=function(){return this.state},e.prototype.patch=function(e){this.state.decode(e)},e.prototype.teardown=function(){var e,t;null===(t=null===(e=this.state)||void 0===e?void 0:e.$changes)||void 0===t||t.root.clearRefs()},e.prototype.handshake=function(e,t){this.state?(new D.Reflection).decode(e,t):this.state=D.Reflection.decode(e,t)},e}(),q=function(){function e(){}return e.prototype.setState=function(e){},e.prototype.getState=function(){return null},e.prototype.patch=function(e){},e.prototype.teardown=function(){},e.prototype.handshake=function(e){},e}();T("schema",z),T("none",q),e.Auth=F,e.Client=V,e.Room=M,e.SchemaSerializer=z,e.registerSerializer=T,Object.defineProperty(e,"__esModule",{value:!0})}))}(),e("default",r.exports)}));e("__cjsMetaURL",t.meta.url)}}}));

System.register("chunks:///_virtual/shopMenu.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./mxManager.ts","./GameConfig.ts","./constant.ts","./audioManager.ts"],(function(e){"use strict";var t,n,i,o,r,a,s,l,c,u,h,d,m,p,g,C,f,y,b,S,N,A,w,k,B,D,T,v,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty,i=e.inheritsLoose,o=e.assertThisInitialized,r=e.defineProperty},function(e){a=e.cclegacy,s=e._decorator,l=e.Prefab,c=e.SpriteFrame,u=e.Material,h=e.Mesh,d=e.Node,m=e.Vec3,p=e.ScrollViewComponent,g=e.game,C=e.MeshRenderer,f=e.Animation,y=e.SkeletalAnimationComponent,b=e.Label,S=e.Sprite,N=e.instantiate,A=e.UITransform,w=e.RichText,k=e.tween,B=e.Component},function(e){D=e.MxManager},function(e){T=e.GameConfig},function(e){v=e.constant},function(e){M=e.audioManager}],execute:function(){var U,E,z,F,V,O,P,I,x,R,G,_,L,H,J,X,Y,j,q,W,Z,K,Q,$,ee,te,ne,ie,oe,re,ae,se,le,ce,ue,he,de,me,pe,ge,Ce,fe,ye,be;a._RF.push({},"bc1f9xPktZJfb90qNMLVw00","shopMenu",void 0);var Se=s.ccclass,Ne=s.property,Ae=e("Item",(U=Se("Item"),E=Ne(l),z=Ne(c),F=Ne(u),V=Ne(h),U((I=t((P=function(){n(this,"model",I,this),n(this,"frame",x,this),n(this,"material",R,this),n(this,"mesh",G,this)}).prototype,"model",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(P.prototype,"frame",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(P.prototype,"material",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(P.prototype,"mesh",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=P))||O));e("ShopMenu",(_=Se("ShopMenu"),L=Ne({type:l}),H=Ne({type:d}),J=Ne({type:d}),X=Ne({type:l}),Y=Ne({type:l}),j=Ne({type:Ae}),q=Ne({type:Ae}),W=Ne({type:Ae}),Z=Ne({type:Ae}),K=Ne({type:c}),Q=Ne({type:c}),$=Ne({type:c}),ee=Ne({type:c}),te=Ne({type:c}),ne=Ne({type:c}),_((re=t((oe=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,n(o(t),"skinNode",re,o(t)),n(o(t),"buyNode",ae,o(t)),n(o(t),"coinNode",se,o(t)),n(o(t),"characterSkinNode",le,o(t)),n(o(t),"foodSkinNode",ce,o(t)),r(o(t),"menuController",null),n(o(t),"bagAcceesories",ue,o(t)),n(o(t),"headPhoneAcceesories",he,o(t)),n(o(t),"gogglesAcceesories",de,o(t)),n(o(t),"targetAcceesories",me,o(t)),r(o(t),"accessoriesType",{none:0,bag:1,headPhone:2,goggles:3,target:4}),r(o(t),"accessoriesArray",[]),r(o(t),"characterSkinArray",[]),r(o(t),"characterFoodArray",[]),r(o(t),"scrollView",null),r(o(t),"scrollViewContent",null),r(o(t),"currentAccessoriesClicked",null),r(o(t),"selectedScaleValue",new m(1.1,1.1,1.1)),r(o(t),"unSelectedScaleValue",new m(.8,.8,.8)),n(o(t),"characterSelectedframe",pe,o(t)),n(o(t),"characterUnSelectedframe",ge,o(t)),n(o(t),"foodSelectedframe",Ce,o(t)),n(o(t),"foodUnSelectedframe",fe,o(t)),n(o(t),"accesSelectedframe",ye,o(t)),n(o(t),"accesUnSelectedframe",be,o(t)),r(o(t),"buttonBlocked",!1),r(o(t),"buyClicked",!1),t}i(t,e);var a=t.prototype;return a.start=function(){this.scrollView=this.node.getChildByName("shopScroll").getComponent(p),this.scrollViewContent=this.scrollView.content},a.initialise=function(e){var t=this;this.menuController=e,v.isMiloEnabled()?g.on("coinDeductAccessories",(function(e){t.coinDeductAccessories(e)}),this):(g.on("rewardinGameAccessories",(function(e){t.rewardinGameAccessories(e)}),this),g.on("rewardAdsExist",(function(e){t.rewardAdsExist(e)}),this)),this.coinNode.active=!1,v.isMiloEnabled()&&(this.coinNode.active=!0),this.updateCoinData()},a.onSopBackButtonClick=function(){var e=this;v.CURRENTSTATE=v.GAMESTATE.MAINMENU,this.resetData(),clearTimeout(this.menuController.animationTimeOut),this.menuController.sumo.setRotationFromEuler(this.menuController.sumo.eulerAngles.x,0,this.menuController.sumo.eulerAngles.z),this.menuController.threedNode.getChildByName("bg").getComponent(C).setMaterial(this.menuController.menuMaterial,0),this.menuController.node.getComponent(f).play("shopClose"),this.menuController.showLogoAnimationTimeOut=setTimeout((function(){e.menuController.node.getComponent(f).play("animateLogo")}),1e4),this.menuController.sumo.getChildByName("Penguine_Anim").getComponent(y).play("walk"),setTimeout((function(){e.menuController.startAnimation()}),500)},a.updateCoinData=function(){var e=v.getCoinBalance();this.coinNode.getChildByName("coinLabel").getComponent(b).string=e},a.addAccessoriesScrollContent=function(){if(!this.buttonBlocked){this.resetData(),this.node.getChildByName("buttons").getChildByName("characterButton").getComponent(S).spriteFrame=this.characterUnSelectedframe,this.node.getChildByName("buttons").getChildByName("accessoriesButton").getComponent(S).spriteFrame=this.accesSelectedframe,this.node.getChildByName("buttons").getChildByName("FoodButton").getComponent(S).spriteFrame=this.foodUnSelectedframe;for(var e=v.getAccessories(),t=0;t<=e.length;t++){var n=N(this.skinNode);this.scrollViewContent.addChild(n),n.getComponent("Skin").initialiseData(e[t],t,this),t<e.length&&this.accessoriesArray.push(n)}var i=N(this.skinNode).getComponent(A).height*Math.ceil(e.length/3)+10*Math.ceil(e.length/3);this.scrollViewContent.getComponent(A).height=i}},a.addCharacterScrollContent=function(){if(!this.buttonBlocked){this.resetData(),this.node.getChildByName("buttons").getChildByName("characterButton").getComponent(S).spriteFrame=this.characterSelectedframe,this.node.getChildByName("buttons").getChildByName("accessoriesButton").getComponent(S).spriteFrame=this.accesUnSelectedframe,this.node.getChildByName("buttons").getChildByName("FoodButton").getComponent(S).spriteFrame=this.foodUnSelectedframe;for(var e=v.getSkin(),t=0;t<=e.length;t++){var n=N(this.characterSkinNode);this.scrollViewContent.addChild(n),n.getComponent("CharacterSkins").initialiseData(e[t],t,this),t<e.length&&this.characterSkinArray.push(n)}var i=N(this.characterSkinNode).getComponent(A).height*Math.ceil(e.length/3)+10*Math.ceil(e.length/3);this.scrollViewContent.getComponent(A).height=i}},a.addFoodScrollContent=function(){if(!this.buttonBlocked){this.resetData(),this.menuController.sumo.active=!1,this.node.getChildByName("buttons").getChildByName("characterButton").getComponent(S).spriteFrame=this.characterUnSelectedframe,this.node.getChildByName("buttons").getChildByName("accessoriesButton").getComponent(S).spriteFrame=this.accesUnSelectedframe,this.node.getChildByName("buttons").getChildByName("FoodButton").getComponent(S).spriteFrame=this.foodSelectedframe;for(var e=v.getFood(),t=0;t<=e.length;t++){var n=N(this.foodSkinNode);this.scrollViewContent.addChild(n),n.getComponent("FoodSkins").initialiseData(e[t],t,this),t<e.length&&this.characterFoodArray.push(n)}var i=N(this.foodSkinNode).getComponent(A).height*Math.ceil(e.length/3)+10*Math.ceil(e.length/3);this.scrollViewContent.getComponent(A).height=i}},a.resetData=function(){M.instance.playSound(v.AUDIO_SOUND.buttonClick),this.menuController.sumo.active=!0,this.menuController.playerNode.getChildByName("foodNode").removeAllChildren(),this.scrollViewContent.removeAllChildren()},a.updatePlayerAccessoriesData=function(e,t){switch(e){case 0:this.menuController.playerData.character=t;break;case 1:this.menuController.playerData.bag=t;break;case 2:this.menuController.playerData.headPhone=t;break;case 3:this.menuController.playerData.goggles=t;break;case 4:this.menuController.playerData.target=t;break;case 5:this.menuController.playerData.food=t}var n=JSON.stringify(this.menuController.playerData);window.localStorage.setItem("playerData",n)},a.onShowBuyPopup=function(e){v.CURRENTSTATE=v.GAMESTATE.MAINMENUSHOPBUY,M.instance.playSound(v.AUDIO_SOUND.buttonClick),this.currentAccessoriesClicked=e;var t=v.TEXT.BUYCOIN;if(!v.isMiloEnabled())return t=(t=v.TEXT.WATCHAD).replace("@",e.skinName),this.buyNode.getChildByName("popup").getChildByName("textPopup").getComponent(w).string="<color=#000000><size=60>"+t+"</size>",void D.instance.onCheckRewardedVideoAds("rewardAdsExist",this);var n=T.purchases.accessories;t=(t=(t=v.TEXT.BUYCOIN).replace("@",e.skinName)).replace("#",n.toString()),this.buyNode.getChildByName("popup").getChildByName("textPopup").getComponent(w).string="<color=#000000><size=60>"+t+"</size>",v.getCoinBalance()<n||(this.buyNode.active=!0)},a.rewardAdsExist=function(e){if(0==(e&&e.status)){this.buyNode.active=!0,D.instance.adGameStartOpportunity++;(new Date).getTime();D.instance.onTrack({position:"start"},"gameAdShown")}},a.rewardinGameAccessories=function(e){0===(e&&e.status)&&this.activateAccessories(),this.onBuyClosed(),D.instance.adGameStartClaimed++;(new Date).getTime();D.instance.onTrack({position:"start",autoPlayed:0},"gameAdClaimed")},a.coinDeductAccessories=function(e){null!=e&&null!=e?((e=JSON.parse(e)).success&&(v.setCoinBalance(e.balance),this.updateCoinData(),this.activateAccessories()),this.onBuyClosed()):this.onBuyClosed()},a.onBuyclicked=function(){if(M.instance.playSound(v.AUDIO_SOUND.buttonClick),!this.buyClicked&&null!=this.currentAccessoriesClicked)if(this.buyClicked=!0,v.isMiloEnabled()){D.instance.deductCoins("coinDeductAccessories",{type:"accessories"},this)}else{M.instance.disableSound(),D.instance.onShowRewardedVideoAds("rewardinGameAccessories",this),D.instance.adGameStartShown++;(new Date).getTime();D.instance.onTrack({position:"start"},"gameAdClicked")}},a.activateAccessories=function(){this.currentAccessoriesClicked.isActive=!0,v.updateAccessories(this.currentAccessoriesClicked.type,this.currentAccessoriesClicked.currentIndex),k(this.currentAccessoriesClicked.node.getChildByName("lockIcon")).to(.1,{position:new m(100,-100,0)}).to(.5,{scale:new m(2,2,2)}).to(.1,{scale:new m(0,0,0)}).start(),this.onBuyClosed()},a.onBuyClosed=function(){this.buyClicked=!1,v.CURRENTSTATE=v.GAMESTATE.MAINMENUSHOP,M.instance.checkSound(),M.instance.playSound(v.AUDIO_SOUND.buttonClick),this.currentAccessoriesClicked=null,this.buyNode.active=!1},a.onLayerClicked=function(){},t}(B)).prototype,"skinNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t(oe.prototype,"buyNode",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(oe.prototype,"coinNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(oe.prototype,"characterSkinNode",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(oe.prototype,"foodSkinNode",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(oe.prototype,"bagAcceesories",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),he=t(oe.prototype,"headPhoneAcceesories",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),de=t(oe.prototype,"gogglesAcceesories",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),me=t(oe.prototype,"targetAcceesories",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pe=t(oe.prototype,"characterSelectedframe",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=t(oe.prototype,"characterUnSelectedframe",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(oe.prototype,"foodSelectedframe",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=t(oe.prototype,"foodUnSelectedframe",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(oe.prototype,"accesSelectedframe",[te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=t(oe.prototype,"accesUnSelectedframe",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=oe))||ie));a._RF.pop()}}}));

System.register("chunks:///_virtual/lodash.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(r){"use strict";var n,t,e;return{setters:[function(r){n=r.defineProperty},function(r){t=r.cclegacy,e=r._decorator}],execute:function(){var i,u,o;t._RF.push({},"bf88fX3aSFOYLiDYhjB7I97","lodash",void 0);var f=e.ccclass;r("lodash",f("lodash")((o=u=function(){function r(){}return r.find=function(r,n){var t;if(Array.isArray(r)||(r=this.toArray(r)),(t=r.filter(n)).length)return t[0]},r.forEach=function(r,n){Array.isArray(r)?r.forEach(n):this.toArrayKey(r).forEach((function(t,e,i){var u=t.key,o=t.value;n(o,u,r)}))},r.cloneDeep=function(r){if(null===r||"object"!=typeof r)return r;var n={};for(var t in r.constructor===Array&&(n=[]),r)r.hasOwnProperty(t)&&(n[t]=this.cloneDeep(r[t]));return n},r.map=function(r,n){Array.isArray(r)||(r=this.toArray(r));var t=[];return r.forEach((function(r,e,i){t.push(n(r,e,i))})),t},r.random=function(r,n){var t=Math.random()*(n-r+1)+r;return Math.floor(t)},r.toArrayKey=function(r){var n=[];for(var t in r)r.hasOwnProperty(t)&&n.push({key:t,value:r[t]});return n},r.toArray=function(r){var n=[];for(var t in r)r.hasOwnProperty(t)&&n.push(r[t]);return n},r.filter=function(r,n){return Array.isArray(r)||(r=this.toArray(r)),r.filter(n)},r.isEqual=function(r,n){if(!(r instanceof Object)||!(n instanceof Object))return r===n;if(Object.keys(r).length!==Object.keys(n).length)return!1;for(var t in r){var e=r[t]instanceof Object,i=n[t]instanceof Object;if(e&&i)return this.isEqual(r[t],n[t]);if(r[t]!==n[t])return!1}return!0},r.pullAllWith=function(r,n,t){return n.forEach((function(n){r.filter((function(r){return t(r,n)})).forEach((function(n){var t=r.indexOf(n);-1!==r.indexOf(n)&&r.splice(t,1)}))})),r},r.now=function(){return Date.now()},r.pullAll=function(r,n){return n.forEach((function(n){var t=r.indexOf(n);-1!==r.indexOf(n)&&r.splice(t,1)})),r},r.forEachRight=function(r,n){Array.isArray(r)||(r=this.toArray(r));for(var t=r.length-1;t>=0;t--){if(!n(r[t]))break}},r.startsWith=function(r,n,t){return(r=r.substr(t)).startsWith(n)},r.endsWith=function(r,n,t){return(r=r.substr(t)).endsWith(n)},r.remove=function(r,n){var t=[],e=[];return r.forEach((function(r,i){n(r)&&(t.push(r),e.push(i))})),this.basePullAt(r,e),t},r.basePullAt=function(r,n){for(var t,e=r?n.length:0,i=e-1;e--;){var u=n[e];e!==i&&u===t||(t=u,Array.prototype.splice.call(r,u,1))}return r},r.findIndex=function(r,n,t){var e;if(r=r.slice(t),"function"==typeof n){for(e=0;e<r.length;e++)if(n(r[e]))return e}else if(Array.isArray(n))for(e=0;e<r.length;e++){var i=n[0],u=!0;if(n.length>1&&(u=n[1]),r[e][i]===u)return e}else for(e=0;e<r.length;e++)if(r[e]===n)return e;return-1},r.concat=function(){var r=arguments.length;if(!r)return[];for(var n=arguments[0],t=1;t<r;)n=n.concat(arguments[t]),t++;return n},r.isNumber=function(r){return"number"==typeof r},r.indexOf=function(r,n,t){return(r=r.slice(t)).indexOf(n)},r.join=function(r,n){if(null===r)return"";var t="";return r.forEach((function(r){t+=r+n})),t.substr(0,t.length-1)},r.split=function(r,n,t){return r.split(n,t)},r.max=function(r){if(r&&r.length){for(var n,t=0;t<r.length;t++)0===t?n=r[0]:n<r[t]&&(n=r[t]);return n}},r.drop=function(r,n){return(null===r?0:r.length)?r.slice(n):[]},r.flattenDeep=function(r){return r.reduce((function(r,n){return r.concat(n)}))},r.uniq=function(r){var n=[];return r.forEach((function(r){-1===n.indexOf(r)&&n.push(r)})),n},r.isNaN=function(r){return this.isNumber(r)&&r!==+r},r.chunk=function(r,n){if(!(null===r?0:r.length)||n<1)return[];for(var t=[];r.length>n;)t.push(r.slice(0,n)),r=r.slice(n);return t.push(r),t},r.toFinite=function(r){var n=1/0;return r?(r=Number(r))===n||r===-1/0?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0},r.baseRange=function(r,n,t,e){for(var i=-1,u=(0,Math.max)((0,Math.ceil)((n-r)/(t||1)),0),o=Array(u);u--;)o[e?u:++i]=r,r+=t;return o},r.isObject=function(r){var n=typeof r;return null!==r&&("object"===n||"function"===n)},r.isLength=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=r.MAX_SAFE_INTEGER},r.isArrayLike=function(r){return null!==r&&this.isLength(r.length)},r.eq=function(r,n){return r===n||r!=r&&n!=n},r.isIndex=function(n,t){var e=typeof n;return!!(t=null===t?r.MAX_SAFE_INTEGER:t)&&("number"===e||"symbol"!==e&&/^(?:0|[1-9]\d*)$/.test(n))&&n>-1&&n%1==0&&n<t},r.isIterateeCall=function(r,n,t){if(!this.isObject(t))return!1;var e=typeof n;return!!("number"===e?this.isArrayLike(t)&&this.isIndex(n,t.length):"string"===e&&n in t)&&this.eq(t[n],r)},r.createRange=function(r){var n=this;return function(t,e,i){return i&&"number"!=typeof i&&n.isIterateeCall(t,e,i)&&(e=i=void 0),t=n.toFinite(t),void 0===e?(e=t,t=0):e=n.toFinite(e),i=void 0===i?t<e?1:-1:n.toFinite(i),n.baseRange(t,e,i,r)}.bind(this)},r.maxBy=function(r,n){if(r&&r.length){for(var t=-1,e=-1,i=0;i<r.length;i++)0===i?(t=n(r[0]),e=r[0]):t<r[i]&&(t=r[i],e=r[i]);return e}},r.minBy=function(r,n){if(r&&r.length){for(var t=-1,e=-1,i=0;i<r.length;i++)0===i?(t=n(r[0]),e=r[0]):t>r[i]&&(t=n(r[i]),e=r[i]);return e}},r.sumBy=function(r,n){var t=0;for(var e in r)t+=n(r[e]);return t},r.countBy=function(r){var n={};for(var t in r){var e=r[t];n.hasOwnProperty(e)?n[e]+=1:n[e]=1}return n},r}(),n(u,"MAX_SAFE_INTEGER",9007199254740991),i=o))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var r,a,n;return{setters:[function(e){r=e.defineProperty},function(e){a=e.cclegacy,n=e._decorator}],execute:function(){var t;a._RF.push({},"c73dePapjJAnLg+9aXUBSrj","GameManager",void 0);var o=n.ccclass;e("GameManager",o("GameManager")(t=function(){function e(){r(this,"initInfo",{players:[{bot:!1,host:!0,name:"Player1",profilePicUrl:"https://i.picsum.photos/id/177/200/200.jpg?hmac=785Vry8HsdS9dQ7mFYbwV8bR2tWVtzJWWl9YLp6L0n8",userId:"mx-user-1"}]}),r(this,"userInfo",{userId:"mx-user-2",gameId:"86a01a92a84646e4ad33252f19b39385",roomId:"7d1b376b-0eee-4d53-bd91-3cda5de62b43-1625715627668",highestScore:90,lastLevel:0,gameMode:"score",isFirstOpen:!0,roomType:"public/private",balance:100,micEnabled:!0})}var a=e.prototype;return a.setData=function(e){},a.onGameInit=function(){},a.onGameOver=function(){},a.onGameStart=function(){},a.onError=function(){},e}())||t);a._RF.pop()}}}));

System.register("chunks:///_virtual/clientEvent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./oneToMultiListener.ts"],(function(e){"use strict";var t,n,i,r,c;return{setters:[function(e){t=e.defineProperty,n=e.inheritsLoose},function(e){i=e.cclegacy,r=e._decorator},function(e){c=e.oneToMultiListener}],execute:function(){var o,s,u;i._RF.push({},"e0d8biI9TpEO6Z8pVTWWXiY","clientEvent",void 0);var l=r.ccclass;r.property,e("clientEvent",l("clientEvent")((u=s=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t}(c),t(s,"handlers",{}),o=u))||o);i._RF.pop()}}}));

System.register("chunks:///_virtual/GameConfig.ts",["cc","./mxManager.ts"],(function(e){"use strict";var i,a;return{setters:[function(e){i=e.cclegacy},function(e){a=e.MxManager}],execute:function(){i._RF.push({},"e823dOXK0JI6raju8IgRB5T","GameConfig",void 0);var t=e("GameConfig",{scoringMultiplayer:{winningPoint:200,quittingPoint:-50,losingPoint:-20},network:{dataPerSec:10},serverInfo:{resultEndPoint:{dev:"https://mxgamesapi.dev.mxplay.com/v1/game/result",prod:"https://mxgamesapi.mxplay.com/v1/game/result"},serverUrlEndPoint:{dev:"wss://zatsvu.colyseus.in",prod:"wss://iy5aen.colyseus.in"},isProd:!1},initialiserTimeOut:15,redirectingTimeout:10,gameStartTime:30,gameplay:{levels:[{noOfBotsInGame:7,botsProbabilty:{easy:.8,medium:.1,hard:.1},time:60,map:{currentMap:"isRandom"},powerUp:{totalSpawn:.4,initialiseDuration:1,spawnDuration:8,spawnProbability:{PoisionSize:10,PoisionSpeed:10,GainSpeed:30,Sheild:10}}}],default:{noOfBotsInGame:1,botsProbabilty:{easy:.8,medium:.1,hard:.1},time:100,map:{currentMap:"triangle"},powerUp:{totalSpawn:.5,initialiseDuration:5,spawnDuration:5,spawnProbability:{PoisionSize:20,PoisionSpeed:10,GainSpeed:20,Sheild:10}}}},purchases:{accessories:1},player:{initialSize:.5,playerMaxSize:1.3,playerStartSpeed:8,playerEndSpeed:6},debug:{camera:{angleChange:!1,isdebugEnabled:!1,Yangle:-24,Xangle:0,Zangle:0,YAxis:15,ZAxis:35,XAxis:0},playerPos:0,mapList:["triangle","circular","infinite","star","square"],mapDefault:"isRandom"},bot:{initialSize:.5,botMaxSize:1,botConfig:{easy:{criticalMass:.7,botStartSpeed:4,botEndSpeed:3},medium:{criticalMass:.7,botStartSpeed:5,botEndSpeed:3},hard:{criticalMass:.7,botStartSpeed:6,botEndSpeed:4}}},commonData:{collisionSizeValue:1,deathPercent:50,deathScore:10,bumpTime:.3,playerBumpMe:2,meBumpPlayer:.3,bumpSizeDecreasePercentage:.2},obstacles:{nonMovable:{sizeDecreasePercent:.2}},powerup:{GummyBear:{gainPercentage:.15,score:10,size:1},PoisionSize:{lossPercentage:.07,score:-10,size:1},PoisionSpeed:{lossSpeedPercentage:.5,score:-10,size:1,duration:10},GainSpeed:{increaseSpeedPercentage:.7,score:10,size:1,duration:10},Sheild:{score:10,duration:10}}});a.instance.init();var n=a.instance.onGameInit();null==n||0===Object.keys(n).length&&n.constructor===Object||(t=e("GameConfig",n.config)),console.log("CurrentGameConfig ----   "+JSON.stringify(t)),i._RF.pop()}}}));

System.register("chunks:///_virtual/util.ts",["cc"],(function(t){"use strict";var r,e;return{setters:[function(t){r=t.cclegacy,e=t._decorator}],execute:function(){var n;r._RF.push({},"f38ecZtzoND0r955vpu2xww","util",void 0);var o=e.ccclass;e.property,t("util",o("util")(n=function(){function t(){}return t.clone=function(t){if(null===t||"object"!=typeof t)return t;var r={};for(var e in t.constructor===Array&&(r=[]),t)t.hasOwnProperty(e)&&(r[e]=this.clone(t[e]));return r},t.objectToArray=function(t){var r=[];for(var e in t)t.hasOwnProperty(e)&&r.push(t[e]);return r},t.arrayToObject=function(t,r){var e={};for(var n in t)t.hasOwnProperty(n)&&t[n][r]&&(e[t[n][r]]=t[n]);return e},t.getWeightRandIndex=function(t,r){for(var e=Math.floor(Math.random()*r),n=0,o=0;o<t.length&&!(e<(n+=t[o]));o++);return o},t.getRandomNFromM=function(t,r){for(var e=[],n=0,o=0;o<r&&!(o>=t+1);){n=this.getRandomInt(0,t);for(var a=0,u=0;u<o;u++)if(e[u]===n){a=1;break}0===a&&(e[o]=n,o++)}return e},t.getRandomInt=function(t,r){var e=Math.random()*(r-t+1)+t;return Math.floor(e)},t.getStringLength=function(t){for(var r=t,e=0,n=0,o=r.length;n<o;n++){e+=r.charCodeAt(n)<=255?1:2}return Math.ceil(e/2)},t.isEmptyObject=function(t){var r=!0;if(t&&t.constructor===Object){for(var e in t)if(t.hasOwnProperty(e)){r=!1;break}}else r=!1;return r},t.formatNum=function(t){if(t<=0)return"0";var r=Math.round(Math.log(t)/Math.log(1e3));return parseInt((t/Math.pow(1e3,r-1<0?0:r-1)).toString(),10)+["","","K","M","B"][r]},t.isNewDay=function(t){var r=new Date(t),e=new Date,n=r.getFullYear(),o=r.getMonth(),a=r.getDate(),u=e.getFullYear(),i=e.getMonth(),f=e.getDate();return u>n||(i>o||f>a)},t.getPropertyCount=function(t){var r,e=0;for(r in t)t.hasOwnProperty(r)&&e++;return e},t.difference=function(t,r){var e=[];if(t.constructor!==Array||r.constructor!==Array)return e;for(var n=t.length,o=0;o<n;o++)-1===r.indexOf(t[o])&&e.push(t[o]);return e},t.simulationUUID=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},t.trim=function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},t.isNowValid=function(t,r){var e=new Date(t),n=new Date(r),o=!1;if(e.getDate()+""!="NaN"&&n.getDate()+""!="NaN"){var a=new Date;o=a<n&&a>e}return o},t.getDeltaDays=function(t,r){var e=new Date(t),n=new Date(r),o=e.getFullYear(),a=e.getMonth()+1,u=e.getDate(),i=n.getFullYear(),f=n.getMonth()+1,c=n.getDate();t=new Date(o+"/"+a+"/"+u+" GMT+0800").getTime();var g=(r=new Date(i+"/"+f+"/"+c+" GMT+0800").getTime())-t;return Math.floor(g/864e5)},t.getMin=function(t){var r=0;if(t.constructor===Array)for(var e=t.length,n=0;n<e;n++)r=0===n?Number(t[0]):r>Number(t[n])?Number(t[n]):r;return r},t.formatTwoDigits=function(t){return(Array(2).join("0")+t).slice(-2)},t.formatDate=function(t,r){var e={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var n in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+n+")").test(r)&&(r=r.replace(RegExp.$1,1===RegExp.$1.length?""+e[n]:("00"+e[n]).substr((""+e[n]).length)));return r},t.getDay=function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},t.formatMoney=function(t){for(var r=["","K","M","G","T","P","E","Z","Y","B","N","D"],e="",n=0;n<r.length;n++){if(!(t>=1e4)){e=Math.floor(t)+r[n];break}t/=1e3}return""===e&&(e=Math.floor(t)+"U"),e},t.formatTimeForSecond=function(t){var r="",e=t%60,n=Math.floor(t/60);n=n<0?0:n;var o=Math.floor(n/60),a=n%60;return o>0&&(r+=o>9?o.toString():"0"+o,r+=":"),r+=a>9?a.toString():"0"+a,r+=":",r+=e>9?e.toString():"0"+e},t.formatTimeForMillisecond=function(t){var r=Math.floor(t/1e3%60),e=Math.floor(t/1e3/60%60),n=Math.floor(t/1e3/60/60);return(r<10?"0"+r:r)+":"+(e<10?"0"+e:e)+":"+(n<10?"0"+n:n)},t.zip=function(t){var r=pako.gzip(encodeURIComponent(t),{to:"string"});return this.base64encode(r)},t.rand=function(t){for(var r=this.clone(t),e=r.length-1;e>=0;e--){var n=Math.floor(Math.random()*(e+1)),o=r[n];r[n]=r[e],r[e]=o}return r},t}())||n);r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./commonFun.ts","./encryption.ts","./MiloManager.ts","./mxManager.ts","./GameConfig.ts","./constant.ts","./resourceUtil.ts","./audioManager.ts","./GameRoot.ts","./poolManager.ts","./Sumo.ts","./ConfigManager.ts","./GameStateTrigger.ts","./colyseus.mjs_cjs=&original=.js","./EventManager.ts","./SocketConnection.ts","./MenuController.ts","./Gummy.ts","./foodSkins.ts","./csvManager.ts","./configuration.ts","./BotController.ts","./Helper.ts","./PlayerMovement.ts","./PowerUpController.ts","./GameController.ts","./characterSkins.ts","./gameOver.ts","./GameUIController.ts","./skin.ts","./oneToMultiListener.ts","./Bot.ts","./leaderBoardBanner.ts","./InitSceneManager.ts","./CharacterHud.ts","./eventListener.ts","./Player.ts","./localConfig.ts","./Menu.ts","./shopMenu.ts","./lodash.ts","./GameManager.ts","./clientEvent.ts","./util.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});